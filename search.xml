<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>è„šæœ¬å‡½æ•°ç§¯ç´¯</title>
    <url>/2022/10/12/shell/</url>
    <content><![CDATA[<ul>
<li>å¸¸ç”¨è§£é¢˜è„šæœ¬æ±‡æ€»<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ¥ä¸æƒ³å†™çš„ï¼Œåæ¥å‘ç°è‡ªå·±è„‘å­ä¸å¤ªè¡Œæ ¹æœ¬è®°ä¸ä½ï¼ŒæŸ¥åˆä¸æƒ³æŸ¥ï¼Œæ‰€ä»¥æ…¢æ…¢ç§¯ç´¯å§ï¼Œæ€»æœ‰ä¸€å¤©ä¼šç”¨åˆ°çš„<br>æˆ‘çš„è®¾æƒ³æ˜¯ç­‰æœªæ¥è¾¾åˆ°ä¸€å®šæ•°é‡ä»¥åå†æŒ‰pythonåº“æ•´ç†ï¼Œç°åœ¨çš„è¯å°±è¿™æ ·æ•£ç€</p>
<h2 id="IDCçˆ¬æ•°æ®"><a href="#IDCçˆ¬æ•°æ®" class="headerlink" title="IDCçˆ¬æ•°æ®"></a>IDCçˆ¬æ•°æ®</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x0000000100008000</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; <span class="number">10</span>; i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%x&quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="sha1åŠ å¯†"><a href="#sha1åŠ å¯†" class="headerlink" title="sha1åŠ å¯†"></a>sha1åŠ å¯†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">origin = <span class="built_in">input</span>()</span><br><span class="line">temp = hashlib.sha1(origin.encode())</span><br><span class="line"><span class="built_in">print</span>(temp.hexdigest())</span><br></pre></td></tr></table></figure>

<h2 id="æ±‚æ¨¡ä¹˜é€†å…ƒ"><a href="#æ±‚æ¨¡ä¹˜é€†å…ƒ" class="headerlink" title="æ±‚æ¨¡ä¹˜é€†å…ƒ"></a>æ±‚æ¨¡ä¹˜é€†å…ƒ</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># e*d mod Ï†(n) = 1</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="string">&#x27;e&#x27;</span></span><br><span class="line">phi = <span class="string">&#x27;Ï†(n)&#x27;</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure>

<h2 id="RSAå…±æ¨¡æ”»å‡»"><a href="#RSAå…±æ¨¡æ”»å‡»" class="headerlink" title="RSAå…±æ¨¡æ”»å‡»"></a>RSAå…±æ¨¡æ”»å‡»</h2><ul>
<li><p>ä½¿ç”¨åŒä¸€ä¸ªæ¨¡æ•°n</p>
</li>
<li><p>ç”¨ä¸¤ä¸ªä¸åŒçš„å…¬é’¥e1ã€e2å¯¹åŒä¸€æ®µæ˜æ–‡mè¿›è¡ŒåŠ å¯†å¾—åˆ°ä¸¤ä»½å¯†æ–‡c1ã€c2</p>
</li>
<li><p>è§£å¯†å…¬å¼ï¼š</p>
<blockquote>
<p>m &#x3D; (c1<sup>s1</sup> % n * c2<sup>s2</sup> % n) % n</p>
</blockquote>
</li>
<li><p>å…¬å¼æ¨å¯¼ï¼š</p>
<ul>
<li><p>ç”±å…±æ¨¡å¯æ¨å‡º  </p>
<ul>
<li>m<sup>e1</sup> % n &#x3D; c1   </li>
<li>m<sup>e2</sup> % n &#x3D; c2</li>
</ul>
</li>
<li><p>æ¬§å‡ é‡Œå¾—æ‰©å±•ç®—æ³•å–s1ã€s2ä½¿å¾—</p>
<ul>
<li>e1 * s1 + e2 * s2 &#x3D; 1</li>
</ul>
</li>
<li><p>m &#x3D; m<sup>(e1<em>s1+e2</em>s2)</sup> % n</p>
</li>
<li><p>m &#x3D; (c1<sup>s1</sup> % n * c2<sup>s2</sup> % n) % n</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span>  binascii</span><br><span class="line">c1 =</span><br><span class="line">n =</span><br><span class="line">e1 =</span><br><span class="line">c2 =</span><br><span class="line">e2 =</span><br><span class="line">r,s1,s2 = gmpy2.gcdext(e1, e2)    <span class="comment"># æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span></span><br><span class="line"><span class="comment"># å…¬å¼</span></span><br><span class="line">m = (gmpy2.powmod(c1,s1,n)*gmpy2.powmod(c2,s2,n)) % n   <span class="comment"># è®¡ç®—æ˜æ–‡m</span></span><br><span class="line">m = <span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(m))</span><br></pre></td></tr></table></figure>



<h2 id="RSAå·²çŸ¥pé«˜ä½æ”»å‡»"><a href="#RSAå·²çŸ¥pé«˜ä½æ”»å‡»" class="headerlink" title="RSAå·²çŸ¥pé«˜ä½æ”»å‡»"></a>RSAå·²çŸ¥pé«˜ä½æ”»å‡»</h2><ul>
<li><p>ç”Ÿæˆæ¨¡å¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">e=</span><br><span class="line">c=</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getprime(<span class="number">512</span>)</span><br><span class="line">q=getprime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line">tmp=random.randint(<span class="number">100</span>,<span class="number">300</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p&gt;&gt;tmp=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(p&gt;&gt;tmp))</span><br><span class="line"><span class="comment">#c=6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#n=102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p&gt;&gt;200=8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>sageè„šæœ¬æ±‚p</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = </span><br><span class="line">p = </span><br><span class="line">p = p &lt;&lt; bits				//bitsä¸ºæ±‚è§£ä½æ•°ï¼Œæ¯”å¦‚å·²çŸ¥<span class="number">312</span>ä½p2ï¼Œpä¸º<span class="number">512</span>ä½ï¼Œbits = <span class="number">200</span></span><br><span class="line">PR. = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span> ^ bits,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»"><a href="#RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»" class="headerlink" title="RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»"></a>RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»</h2><ul>
<li><p>ç”Ÿæˆæ¨¡å¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">flag=<span class="string">&quot;UNCTF&#123;*************************&#125;&quot;</span> </span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q=libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">6</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">M=((m&gt;&gt;<span class="number">60</span>)&lt;&lt;<span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,M) </span><br></pre></td></tr></table></figure>


</li>
<li><p>sageæ±‚è§£m</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">high_m = </span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">m = high_m + x</span><br><span class="line">M = m((m^<span class="number">6</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
</li>
<li><p>pythonè¿˜åŸm</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">M =</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(M))</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Base64å˜è¡¨è§£å¯†"><a href="#Base64å˜è¡¨è§£å¯†" class="headerlink" title="Base64å˜è¡¨è§£å¯†"></a>Base64å˜è¡¨è§£å¯†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># åŸè¡¨</span></span><br><span class="line">origin = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="comment"># å˜è¡¨</span></span><br><span class="line">base = <span class="string">&#x27;yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx&#x27;</span></span><br><span class="line"><span class="comment"># å¯†æ–‡</span></span><br><span class="line">c = <span class="string">&#x27;1ovhXETgZUDgXFS=&#x27;</span></span><br><span class="line"><span class="comment"># æ˜ å°„è¡¨</span></span><br><span class="line">table = <span class="built_in">str</span>.maketrans(base,origin)</span><br><span class="line"><span class="comment"># æ˜æ–‡</span></span><br><span class="line">m = <span class="built_in">str</span>(base64.b64decode(c.translate(table)),encoding=(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

<h2 id="SM4è§£å¯†"><a href="#SM4è§£å¯†" class="headerlink" title="SM4è§£å¯†"></a>SM4è§£å¯†</h2><ul>
<li>é¢˜ç›®éƒ¨åˆ†è§£å¯†æºç </li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n, n2s</span><br><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> decrypt</span><br><span class="line">cipher = <span class="number">119384314703134531538573762305905297230</span></span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line">sm4_key = s2n(<span class="string">b&quot;where_are_u_now?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(n2s(decrypt(cipher, sm4_key)).decode())</span><br></pre></td></tr></table></figure>



<h2 id="MD5åŠ å¯†"><a href="#MD5åŠ å¯†" class="headerlink" title="MD5åŠ å¯†"></a>MD5åŠ å¯†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾…åŠ å¯†ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;this is a md5 test.&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºmd5å¯¹è±¡</span></span><br><span class="line">hl = hashlib.md5()</span><br><span class="line">hl.update(<span class="built_in">str</span>.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;MD5åŠ å¯†å‰ä¸º ï¼š&#x27;</span> + <span class="built_in">str</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;MD5åŠ å¯†åä¸º ï¼š&#x27;</span> + hl.hexdigest())</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°æ³¨å…¥"><a href="#å‚æ•°æ³¨å…¥" class="headerlink" title="å‚æ•°æ³¨å…¥"></a>å‚æ•°æ³¨å…¥</h2><ul>
<li>hackgame2022 flagè‡ªåŠ¨æœº</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    HWND target = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–çª—å£å¥æŸ„</span></span><br><span class="line">    target = <span class="built_in">FindWindowW</span>(<span class="string">L&quot;flag è‡ªåŠ¨æœº&quot;</span>, <span class="string">L&quot;flag è‡ªåŠ¨æœº&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (target == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0x%x&quot;</span>, target);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="built_in">PostMessageW</span>(target, <span class="number">0x111</span>, <span class="number">3</span>, <span class="number">114514</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="CRC32è§£å¯†"><a href="#CRC32è§£å¯†" class="headerlink" title="CRC32è§£å¯†"></a>CRC32è§£å¯†</h2><ul>
<li>RoarCTF2019 polyre</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">secret = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>,</span><br><span class="line">          <span class="number">0x342B90AFD853F450</span>, <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>]</span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># äº§ç”ŸCRC32æŸ¥è¡¨æ³•æ‰€ç”¨çš„è¡¨</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> secret:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        sign = s &amp; <span class="number">1</span>                   <span class="comment">#åˆ¤æ–­é¦–ä½æ­£è´Ÿ</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s ^= key</span><br><span class="line">        s //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s |= <span class="number">0x8000000000000000</span>    <span class="comment"># é˜²æ­¢è´Ÿå€¼é™¤2ï¼Œæº¢å‡ºä¸ºæ­£å€¼</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(s))                      <span class="comment"># è¾“å‡ºè¡¨</span></span><br><span class="line">    <span class="comment"># è®¡ç®—CRC64</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(s&amp;<span class="number">0xFF</span>)</span><br><span class="line">        s &gt;&gt;= <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>CTFé€†å‘å…¥é—¨</title>
    <url>/2022/09/27/Introduction/</url>
    <content><![CDATA[<ul>
<li>æµ…è°ˆä¸€ä¸‹é€†å‘çš„å…¥é—¨<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h2><ul>
<li>å¦‚æœä½ æ˜¯å¤§ä¸€ï¼Œé‚£ä½ å¯èƒ½ä¼šé‡åˆ°ä¸€äº›éº»çƒ¦ï¼Œä¸€ä¸‹å­æ¥è§¦è¿™ä¹ˆå¤šè¯­è¨€ï¼Œæ¥è§¦è¿™ä¹ˆå¤šé…ç½®æ–¹å¼ã€‚</li>
<li>æˆ‘åªèƒ½è¯´ï¼Œä¸è¦æ€¥ï¼Œæ…¢æ…¢æ¥</li>
<li>ä½ å¯ä»¥ä¸ä¼šæ±‡ç¼–ï¼Œä½†æ˜¯ä½ ä¸å¯ä»¥ä¸ä¼šcè¯­è¨€</li>
</ul>
<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>ä½ åº”è¯¥å¹²ä»€ä¹ˆï¼Ÿ</p>
<ol>
<li>åœ¨å±•å¼€æ­£å¼å­¦ä¹ ä¹‹å‰ï¼Œå…ˆè¯•ç€å»å®‰è£…ä¸€ä¸ªkali å’Œwin10è™šæ‹Ÿæœºï¼Œè¿™æ˜¯å¿…è¦çš„</li>
<li>å…³äºctf-wikiï¼Œæˆ‘ä»¬éœ€è¦çœ‹ï¼Œçœ‹ä¸€çœ‹é€†å‘ç®€ä»‹å³å¯ï¼Œå‰©ä½™çš„å¦‚æœä½ æƒ³çœ‹çš„è¯ï¼Œå¯ä»¥çœ‹çœ‹ç›®å½•</li>
<li>å®‰è£…å·¥å…·</li>
<li>å¼€å§‹å­¦ä¹ <ol>
<li>å­¦ä¼šä½¿ç”¨å·¥å…·(ç›®çš„åœ¨äºå­¦ä¼šå·¥å…·ä½¿ç”¨ï¼Œè€Œä¸æ˜¯çœ‹æ‡‚ä»£ç )</li>
</ol>
<ul>
<li>exeæ–‡ä»¶æ‰§è¡Œä¸åç¼–</li>
<li>elfæ–‡ä»¶æ‰§è¡Œä¸åç¼–</li>
<li>jaræ–‡ä»¶æ‰§è¡Œä¸åç¼–</li>
<li>pycæ–‡ä»¶åç¼–ä¸ç¼–è¯‘è¿è¡Œ</li>
<li>apkæ–‡ä»¶åç¼–<blockquote>
<p>æˆ–è®¸ä½ ä¸èƒ½å®Œå…¨çš„å®Œæˆä¸Šé¢çš„äº‹æƒ…ï¼Œä½†è¿™å¹¶ä¸å½±å“ä½ ç»§ç»­åé¢çš„æ­¥éª¤</p>
</blockquote>
</li>
</ul>
<ol>
<li>äº†è§£ä¸€äº›å¸¸è§çš„åŠ å¯†æ–¹å¼ï¼Œteaï¼Œxteaï¼Œbase64ç­‰ç­‰</li>
<li>pythonï¼Œjavaè¯­è¨€å­¦ä¹ ï¼Œå…ˆäº†è§£åŸºæœ¬è¯­æ³•ï¼Œæ­¤å¤–ï¼Œç”¨pythonå†™ä¸€äº›ç®€å•çš„è„šæœ¬ï¼ˆè®°ä½å¾ªåºæ¸è¿›ï¼‰</li>
<li>æ±‡ç¼–è¯­è¨€ï¼ˆåŠŸåº•è¶Šæ·±è¶Šå¥½ï¼‰</li>
<li>çœ‹CTF-wikiï¼Œåˆ°è¿™é‡Œä½ å·²ç»æœ‰äº†ä¸€äº›åŠŸåº•ï¼Œæ˜¯æ—¶å€™åŠ æ·±äº†è§£é€†å‘äº†ã€‚æµ…æµ…æ¥è§¦ä¸€ä¸‹èŠ±æŒ‡ä»¤ã€åŠ è„±å£³ã€åè°ƒè¯•æŠ€æœ¯ç­‰ç­‰ï¼Œä½ æˆ–è®¸ä¼šå‘ç°è‡ªå·±çœ‹ä¸æ‡‚ï¼Œåˆ«æ€¥ï¼Œçœ‹ä¸æ‡‚çš„å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦å­¦ä¹ çš„</li>
<li>çœ‹è¿‡wikiä¹‹åï¼Œæˆ‘æƒ³ä½ æ˜ç™½äº†é€†å‘æœ‰windowsé€†å‘ï¼Œlinuxé€†å‘ï¼ŒAndroidé€†å‘ï¼ŒIosé€†å‘<blockquote>
<p>åˆ°è¿™é‡Œï¼Œå¦‚æœä½ åœ¨å­¦ä¹ æ—¶åŒæ—¶åˆ·äº†è¶³å¤Ÿå¤šçš„é¢˜ï¼Œé‚£æˆ‘æƒ³ä½ åº”è¯¥çŸ¥é“ä½ æ¥ä¸‹æ¥è¦åšä»€ä¹ˆäº†</p>
</blockquote>
</li>
<li>å°è¯•ç ´è§£ä¸€äº›ç®€å•çš„è½¯ä»¶ä¹‹ç±»(ä¸è¦å»è¿æ³•)</li>
<li>åˆ·é¢˜ &amp; åº•å±‚å­¦ä¹ </li>
</ol>
</li>
</ol>
<h2 id="ä¸€äº›å»ºè®®"><a href="#ä¸€äº›å»ºè®®" class="headerlink" title="ä¸€äº›å»ºè®®"></a>ä¸€äº›å»ºè®®</h2><ul>
<li>é€†å‘æ˜¯ä¸€ä¸ªéœ€è¦ä»£ç èƒ½åŠ›è¾ƒå¼ºçš„æ–¹å‘ï¼Œæœ€åä½ ä¸€å®šèƒ½å¤Ÿä¾é çš„ï¼Œæ˜¯æ±‡ç¼–ï¼Œæ‰€ä»¥ï¼Œå­¦å¥½æ±‡ç¼–</li>
<li>å¤šåˆ·é¢˜ï¼Œé€†å‘è¦åšçš„äº‹å°±å†³å®šäº†ä»–éœ€è¦ç§¯æ”’è¶³å¤Ÿçš„ç»éªŒï¼Œå› ä¸ºä½ ä¹Ÿä¸çŸ¥é“ä½ ä¸‹ä¸€ç§’é‡åˆ°çš„è½¯ä»¶æ˜¯å“ªä¸ªå¥‡è‘©å¼€å‘çš„</li>
<li>å¤šå»è®ºå›è½¬æ‚ è½¬æ‚ ï¼Œä¼šæœ‰å¸®åŠ©</li>
<li>ä¸è¦æ‰§ç€äºä¸€ä¸ªç‚¹ï¼Œè¦å­¦ä¼šå–èˆ</li>
</ul>
<h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>è®°ä½ï¼Œèƒ½è½»æ˜“å®Œæˆçš„å·¥ä½œï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“è¢«æ›¿ä»£çš„å·¥ä½œï¼Œæˆ‘ä»¬è¦æˆä¸ºçš„ï¼Œä¸æ˜¯è¢«æ›¿ä»£çš„äººã€‚â€˜</p>]]></content>
      <categories>
        <category>Welcome</category>
      </categories>
  </entry>
  <entry>
    <title>å·¥å…·æ±‡æ€»</title>
    <url>/2022/09/18/Tools/</url>
    <content><![CDATA[<ul>
<li>CTFå·¥å…·æ±‡æ€»</li>
<li>å¦‚æœå¼•ç”¨å†…å®¹ä¾µæƒï¼Œè¯·è”ç³»åˆ é™¤</li>
<li>å®‰è£…è¿‡ç¨‹ä¸€èˆ¬ä¸åšè¯´æ˜ï¼Œgoogleå³å¯<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h3><ul>
<li><p>è™šæ‹Ÿæœºä¸‹è½½<br><a href="https://mirrors.tuna.tsinghua.edu.cn/">æ¸…åæº</a><br><a href="https://developer.aliyun.com/mirror">é˜¿é‡Œæº</a></p>
</li>
<li><p>exeinfope(æŸ¥å£³å·¥å…·)</p>
<blockquote>
<p>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/1oXarqcAuWdXWTB-8830q0Q?pwd=1234">https://pan.baidu.com/s/1oXarqcAuWdXWTB-8830q0Q?pwd=1234</a>)<br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>PEiD(æŸ¥å£³å·¥å…·)</p>
<blockquote>
<p>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/15vWG_e4qcNi_McHmdiTPkg?pwd=1234">https://pan.baidu.com/s/15vWG_e4qcNi_McHmdiTPkg?pwd=1234</a>)<br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>IDA7.2(é™æ€è°ƒè¯•å·¥å…·)</p>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1fADIonw9sSyZ1pFIDkeBXg?pwd=1234">https://pan.baidu.com/s/1fADIonw9sSyZ1pFIDkeBXg?pwd=1234</a><br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>Ollydbg(åŠ¨æ€è°ƒè¯•å·¥å…·)<br><a href="https://www.52pojie.cn/thread-350397-1-1.html">å¾çˆ±ç ´è§£</a></p>
</li>
<li><p>x64dbg(åŠ¨æ€è°ƒè¯•å·¥å…·)[å·¥å…·æ¥æºäºå¾çˆ±ç ´è§£]</p>
<blockquote>
<p>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/1aG_nczhG8mOqDBvOZMzyYg?pwd=1234">https://pan.baidu.com/s/1aG_nczhG8mOqDBvOZMzyYg?pwd=1234</a>)<br>æå–ç ï¼š1234 </p>
</blockquote>
</li>
<li><p>Ghidra(é™æ€è°ƒè¯•å·¥å…·)</p>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1fr1TeZUrdzD-VZHnWbl57w?pwd=1234">https://pan.baidu.com/s/1fr1TeZUrdzD-VZHnWbl57w?pwd=1234</a><br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>cheat engine(å†…å­˜ä¿®æ”¹å·¥å…·)<br>å®˜æ–¹ç½‘ç«™-(<a href="https://cheatengine.org/">https://cheatengine.org/</a>)</p>
</li>
<li><p>upxåŠ è„±å£³</p>
<blockquote>
<p>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/1LqzAz1arZqpbEBEHZrRsBg?pwd=1234">https://pan.baidu.com/s/1LqzAz1arZqpbEBEHZrRsBg?pwd=1234</a>)<br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>upx shell</p>
<blockquote>
<p>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/195lxQRjBB39H_RA46SWxpg?pwd=1234">https://pan.baidu.com/s/195lxQRjBB39H_RA46SWxpg?pwd=1234</a>)<br>æå–ç ï¼š1234 </p>
</blockquote>
</li>
<li><p>upx<br>å®˜æ–¹ç½‘ç«™-(<a href="https://upx.github.io/">https://upx.github.io</a>)</p>
</li>
<li><p>PEview(æŸ¥çœ‹PEæ–‡ä»¶ç»“æ„)</p>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1JGCcCVmR5nUOJbkM5OzQ5w?pwd=1234">https://pan.baidu.com/s/1JGCcCVmR5nUOJbkM5OzQ5w?pwd=1234</a><br>æå–ç ï¼š1234 </p>
</blockquote>
</li>
<li><p>Winhex(åå…­è¿›åˆ¶æŸ¥çœ‹å™¨)</p>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1NLyr9YsQ1DNAOTPyY02hBA?pwd=1234">https://pan.baidu.com/s/1NLyr9YsQ1DNAOTPyY02hBA?pwd=1234</a><br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>010 Editor(åå…­è¿›åˆ¶æŸ¥çœ‹å™¨)</p>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1o1X7FKxfOUZsOkGxi22Ttg?pwd=1234">https://pan.baidu.com/s/1o1X7FKxfOUZsOkGxi22Ttg?pwd=1234</a><br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>APKTOOLS(åç¼–è¯‘android apk)<br>å®˜æ–¹ç½‘ç«™-(<a href="https://ibotpeaches.github.io/Apktool/install/">https://ibotpeaches.github.io/Apktool/install/</a>)</p>
</li>
<li><p>Dex2jar(æ‰“åŒ…dexæ–‡ä»¶ä¸ºjar)<br> SOURCEFORGE-(<a href="https://sourceforge.net/projects/dex2jar">https://sourceforge.net/projects/dex2jar</a>)</p>
</li>
<li><p>JD-GUIjar(åç¼–è¯‘jaræ–‡ä»¶)</p>
</li>
<li><p>jeb(apkåç¼–)<br>çœ‹é›ªç¤¾åŒºæœç´¢ç ´è§£</p>
</li>
</ul>
<h3 id="å¯†ç å­¦"><a href="#å¯†ç å­¦" class="headerlink" title="å¯†ç å­¦"></a>å¯†ç å­¦</h3><ul>
<li><p>z3(è§£æ–¹ç¨‹å·¥å…·)</p>
<blockquote>
<p>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234">https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234</a>)<br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>Ziperello(zipåŠ å¯†æš´åŠ›ç ´è§£)</p>
<blockquote>
<p>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/1of_e5mleYDPjZGZxiYi63Q?pwd=1234">https://pan.baidu.com/s/1of_e5mleYDPjZGZxiYi63Q?pwd=1234</a>)<br>æå–ç ï¼š1234</p>
</blockquote>
</li>
<li><p>Converter(ç¼–ç è½¬æ¢å·¥å…·)</p>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1hzK04wmtm4rWsNyofqXPxw?pwd=1234">https://pan.baidu.com/s/1hzK04wmtm4rWsNyofqXPxw?pwd=1234</a><br>æå–ç ï¼š1234</p>
</blockquote>
</li>
</ul>]]></content>
      <categories>
        <category>CTFâ€”â€”å·¥å…·</category>
      </categories>
  </entry>
  <entry>
    <title>å®‰å“é€†å‘åŸºç¡€</title>
    <url>/2022/12/01/Android1/</url>
    <content><![CDATA[<ul>
<li><p>å®‰å“ç»“æ„ç›®å½•ä½“ç³»</p>
<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">



<h2 id="å®‰å“ç³»ç»Ÿæ¶æ„"><a href="#å®‰å“ç³»ç»Ÿæ¶æ„" class="headerlink" title="å®‰å“ç³»ç»Ÿæ¶æ„"></a>å®‰å“ç³»ç»Ÿæ¶æ„</h2><ul>
<li>åº”ç”¨å±‚</li>
<li>åº”ç”¨æ¡†æ¶<ul>
<li>åº”ç”¨å¼€å‘ç»„ä»¶ã€å¼€å‘åŒ…</li>
</ul>
</li>
<li>dalvikè™šæ‹Ÿæœº<ul>
<li>Googleè‡ªå·±è®¾è®¡ç”¨äºAndroidå¹³å°çš„è™šæ‹Ÿæœºï¼Œå¯æ”¯æŒ.dexæ ¼å¼çš„javaåº”ç”¨ç¨‹åºè¿è¡Œ</li>
</ul>
</li>
<li>linuxå†…æ ¸<ul>
<li>åŒ…æ‹¬ä¸€äº›ç³»ç»Ÿé©±åŠ¨ç­‰</li>
</ul>
</li>
</ul>
<h2 id="apkç›®å½•ç»“æ„"><a href="#apkç›®å½•ç»“æ„" class="headerlink" title="apkç›®å½•ç»“æ„"></a>apkç›®å½•ç»“æ„</h2><ol>
<li>assets<ul>
<li>é™æ€æ–‡ä»¶ï¼Œapkæ‰€ä½¿ç”¨çš„å„ç§èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰ï¼Œé€šè¿‡APIè·å–</li>
</ul>
</li>
<li>res<ul>
<li>ç¼–è¯‘åçš„èµ„æºæ–‡ä»¶</li>
</ul>
</li>
<li>lib<ul>
<li>soåŠ¨æ€é“¾æ¥åº“ï¼Œç”¨äºåº•å±‚çš„ä¸€äº›è°ƒç”¨</li>
</ul>
</li>
<li>dex<ul>
<li>è™šæ‹Ÿæœºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸»è¦é€†å‘ç›®æ ‡</li>
</ul>
</li>
<li>META-INF<ul>
<li>æ•°å­—ç­¾åï¼Œç”¨äºæ ¡éªŒapkæ˜¯å¦è¢«ç¯¡æ”¹</li>
</ul>
</li>
<li>AndroidManifest.xml<ul>
<li>ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„é…ç½®æ¸…å•ï¼Œå£°æ˜æƒé™ã€ç»„ä»¶ç­‰çš„åŸºæœ¬ä¿¡æ¯</li>
</ul>
</li>
<li>resources.arsc<ul>
<li>ç¼–è¯‘åèµ„æºçš„ä½ç½®ä¸idä¹‹é—´çš„æ˜ å°„å…³ç³»</li>
</ul>
</li>
</ol>
<h2 id="Androidå››å¤§ç»„ä»¶"><a href="#Androidå››å¤§ç»„ä»¶" class="headerlink" title="Androidå››å¤§ç»„ä»¶"></a>Androidå››å¤§ç»„ä»¶</h2><ol>
<li><p>activity</p>
<ul>
<li>ç”¨æˆ·å¯è§†åŒ–ç•Œé¢</li>
<li>safeï¼š1.ç‚¹å‡»åŠ«æŒ 2.æ‹’ç»æœåŠ¡ 3.ç»„ä»¶å¯¼å‡º</li>
</ul>
</li>
<li><p>service</p>
<ul>
<li>ç”¨äºåå°å®ç°æ“ä½œï¼Œå¦‚åå°æ¥å—å¾®ä¿¡æ¶ˆæ¯</li>
<li>safeï¼š1.ä¸²è°‹æ”»å‡» 2.æ‹’ç»æœåŠ¡</li>
</ul>
</li>
<li><p>content provider</p>
<ul>
<li>ä¸ºåº”ç”¨æä¾›æ•°æ®ï¼Œç»Ÿä¸€æ¥å£</li>
<li>safeï¼š1.æ•°æ®åº“æ³¨å…¥</li>
</ul>
</li>
<li><p>broadcast receiver</p>
<ul>
<li>ä¿¡æ¯ä¼ è¾“æœºåˆ¶</li>
<li>safeï¼šæ¶æ„å¹¿æ’­</li>
</ul>
</li>
</ol>
<p><font color="red">æ³¨ï¼šæ‰€æœ‰ç»„ä»¶å‡éœ€åœ¨AndroidManifestä¸­æ³¨å†Œå£°æ˜</font></p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/ican87/article/details/21874321">(1æ¡æ¶ˆæ¯) androidå››å¤§ç»„ä»¶(è¯¦ç»†æ€»ç»“)_87nowçš„åšå®¢-CSDNåšå®¢_androidçš„å››å¤§ç»„ä»¶</a></p>
<h2 id="adbåŸºæœ¬ä½¿ç”¨"><a href="#adbåŸºæœ¬ä½¿ç”¨" class="headerlink" title="adbåŸºæœ¬ä½¿ç”¨"></a>adbåŸºæœ¬ä½¿ç”¨</h2><ul>
<li>adb devices        åˆ—å‡ºå½“å‰å®‰å“è®¾å¤‡</li>
<li>adb shell             è¿›å…¥å®‰å“linuxå‘½ä»¤è¡Œ</li>
<li>adb push            ä¸Šä¼ </li>
<li>adb pull              ä¸‹è½½</li>
<li>adb connect       ipè¿æ¥è®¾å¤‡</li>
<li>adb kill-server    æ–­å¼€è¿æ¥</li>
</ul>
<h2 id="apktoolåç¼–è¯‘å‘½ä»¤"><a href="#apktoolåç¼–è¯‘å‘½ä»¤" class="headerlink" title="apktoolåç¼–è¯‘å‘½ä»¤"></a>apktoolåç¼–è¯‘å‘½ä»¤</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">apktoolç›®å½•è¿›å…¥å‘½ä»¤è¡Œ</span><br><span class="line">apktool.bat d åç¼–è¯‘æ–‡ä»¶</span><br></pre></td></tr></table></figure>



<h2 id="dex2-jdguiåç¼–è¯‘"><a href="#dex2-jdguiåç¼–è¯‘" class="headerlink" title="dex2+jdguiåç¼–è¯‘"></a>dex2+jdguiåç¼–è¯‘</h2><ol>
<li><p>ä¿®æ”¹apkæ–‡ä»¶åç¼€ä¸ºzipï¼Œè§£å‹</p>
</li>
<li><p>å°†åç¼–çš„dexæ–‡ä»¶å¤åˆ¶åˆ°dex2jarå·¥å…·ç›®å½•ä¸‹</p>
</li>
<li><p>ä½¿ç”¨å‘½ä»¤ç”Ÿæˆjaræ–‡ä»¶</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d2j-dex2jar.bat document_name.dex</span><br></pre></td></tr></table></figure>
<p>   å¦‚æœå‡ºç°ä¸‹åˆ—æŠ¥é”™(ç‰ˆæœ¬å·ä¸åŒ¹é…):<br>   <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">com.googlecode.d2j.DexException: not support version.</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:<span class="number">151</span>)</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:<span class="number">211</span>)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.doCommandLine(Dex2jarCmd.java:<span class="number">104</span>)</span><br><span class="line">     at com.googlecode.dex2jar.tools.BaseCmd.doMain(BaseCmd.java:<span class="number">288</span>)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.main(Dex2jarCmd.java:<span class="number">32</span>)</span><br></pre></td></tr></table></figure><br>   ç”¨æ–‡æœ¬ç¼–è¾‘è½¯ä»¶æ‰“å¼€dexæ–‡ä»¶ï¼Œå°†æ–‡ä»¶å¤´æ”¹ä¸º035æˆ–è€…036<br>   <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dex</span><br><span class="line">037 9!Q&lt;â‚¬é¢§â‚¬?æ»£^î–¼æ°¶wl?  p   x</span><br></pre></td></tr></table></figure><br>   æ­£å¸¸æƒ…å†µåº”è¯¥æ˜¯è¿™æ ·çš„(æ²¡æœ‰ä»»ä½•å¤šä½™)ï¼š<br>   <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">E:\SoftWarePackage\Jd-GUI+dex2\dex2jar-2.0&gt;d2j-dex2jar.bat classes3.dex</span><br><span class="line">    dex2jar classes3.dex -&gt; .\classes3-dex2jar.jar</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>ç”¨jd-guijaråç¼–è¯‘jaræ–‡ä»¶ï¼Œå‘½ä»¤æ˜¯è¿™ä¸ªï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar jd-gui-1.5.0.jar</span><br></pre></td></tr></table></figure>
<ul>
<li>å…¶å®å°±æ˜¯æ‰§è¡Œjaræ–‡ä»¶è€Œå·²ï¼Œå¯ä»¥ç›´æ¥å†™batæ¡Œé¢ä¸€é”®æ‰“å¼€</li>
</ul>
</li>
</ol>]]></content>
      <categories>
        <category>Android</category>
      </categories>
  </entry>
  <entry>
    <title>æ•°æ®ç»“æ„ä»£ç ï¼ˆçº¯Cï¼‰</title>
    <url>/2022/11/27/Algorithm/</url>
    <content><![CDATA[<ul>
<li>ä¸»è¦æ˜¯å‡†å¤‡è®°å½•ä¸€ä¸‹å¤ä¹ æ•°æ®ç»“æ„çš„ä»£ç éšç¬”å§ï¼Œæ ¸å¿ƒåœ¨äºé€šè¿‡ä»£ç ç†è§£æ€è·¯<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">



<h2 id="KMPç®—æ³•-å­—ç¬¦ä¸²åŒ¹é…ï¼Œtå‘såŒ¹é…"><a href="#KMPç®—æ³•-å­—ç¬¦ä¸²åŒ¹é…ï¼Œtå‘såŒ¹é…" class="headerlink" title="KMPç®—æ³•(å­—ç¬¦ä¸²åŒ¹é…ï¼Œtå‘såŒ¹é…)"></a>KMPç®—æ³•(å­—ç¬¦ä¸²åŒ¹é…ï¼Œtå‘såŒ¹é…)</h2><ul>
<li>ä¹¦ä¸Šçš„ä»£ç ä¾¿äºç†è§£ï¼Œä½†æ˜¯ä¸èƒ½è·‘ï¼Œä¸‹æ ‡æœ‰é—®é¢˜</li>
<li>è¿™ä¸ªéš¾ç‚¹å°±åœ¨ä¸€ä¸ªæ±‚nextæ•°ç»„å§ã€‚æ‰€è°“nextï¼Œå°±æ˜¯æ¯ä¸ªå­—ç¬¦çš„æœ€é•¿ç›¸åŒå‰åç¼€ã€‚è‡³äºä»£ç ä¸Šæ³¨æ„æŠŠæ¡æ˜¯åœ¨é€’å½’æ±‚è§£å³å¯</li>
</ul>
<h4 id="ç»“æ„ä½“å£°æ˜"><a href="#ç»“æ„ä½“å£°æ˜" class="headerlink" title="ç»“æ„ä½“å£°æ˜"></a>ç»“æ„ä½“å£°æ˜</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXSIZE 1024</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span>&#123;</span><br><span class="line">    <span class="type">char</span> ch[MAXSIZE+<span class="number">1</span>];		<span class="comment">//å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="type">int</span> length;				<span class="comment">//é•¿åº¦</span></span><br><span class="line">&#125;String;</span><br></pre></td></tr></table></figure>

<h4 id="æ±‚è§£nextæ•°ç»„"><a href="#æ±‚è§£nextæ•°ç»„" class="headerlink" title="æ±‚è§£nextæ•°ç»„"></a>æ±‚è§£nextæ•°ç»„</h4><ul>
<li>ä¼˜åŒ–å‰</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Get_Next</span><span class="params">(String t, <span class="type">int</span> ne[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ne[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; t.length)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j == <span class="number">-1</span> || t.ch[i] == t.ch[j])&#123;</span><br><span class="line">            i++, j++;</span><br><span class="line">            ne[i] = j;		<span class="comment">//ç›¸ç­‰ï¼Œç›´æ¥åœ¨ä¹‹å‰çš„åŸºç¡€ä¸ŠåŠ ä¸€</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">            j = ne[j];      <span class="comment">//ä¸ç›¸ç­‰ï¼Œå‘å‰é€’å½’</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¼˜åŒ–åï¼ˆä¼˜åŒ–æ˜¯ä¼˜åŒ–æ‰äº† t ä¸² ne[j] ä½ç½®çš„å…ƒç´ ä¸ t[j] ç›¸åŒçš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µçš„åŒ¹é…ä¸€å¦å…¨å¦ã€‚æ‰€ä»¥ä¼šè®©ne[j]é€’å½’åˆ° t[ne[j]] !&#x3D; t[j]ï¼‰</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Get_Next</span><span class="params">(String t, <span class="type">int</span> nextval[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    nextval[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; t.length)&#123;</span><br><span class="line">        <span class="comment">//ç›¸åŒå‰åç¼€ï¼Œè¿›å…¥åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">if</span>(j == <span class="number">-1</span> || t.ch[i] == t.ch[j])&#123;</span><br><span class="line">            i++, j++;						<span class="comment">//ä¿®æ”¹ä½ç½®</span></span><br><span class="line">            <span class="keyword">if</span>(t.ch[i] != t.ch[j])</span><br><span class="line">                nextval[i] = j;				<span class="comment">//ä¸ç›¸ç­‰ï¼Œç›´æ¥å–å€¼             </span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                nextval[i] = nextval[j];    <span class="comment">//ç›¸ç­‰ï¼Œæ— æ„ä¹‰ï¼Œå†æ¬¡å‘å‰æ±‚è§£</span></span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            j = nextval[j];      <span class="comment">//éç›¸åŒå‰åç¼€ï¼Œå‘å‰é€’å½’</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">KMP</span><span class="params">(String s, String t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> nextval[MAXSIZE+<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">Get_Next</span>(t, nextval);		             <span class="comment">//æ±‚è§£nextval</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; s.length &amp;&amp; j &lt; t.length)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j == - <span class="number">1</span> || s.ch[i] == t.ch[j])&#123;  <span class="comment">//ç›¸åŒï¼Œå¯åŒ¹é…</span></span><br><span class="line">            i++, j++;</span><br><span class="line">        &#125;<span class="keyword">else</span>							     <span class="comment">//ä¸å¯åŒ¹é…ï¼Œå‘å‰è¿½æº¯</span></span><br><span class="line">            j = nextval[j];        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¾“å‡ºåŒ¹é…ä½ç½®</span></span><br><span class="line">    <span class="keyword">if</span>(j &gt;= t.length)</span><br><span class="line">        <span class="keyword">return</span> i - t.length + <span class="number">1</span>;	<span class="comment">//è¾“å‡ºå®é™…ä½ç½®é•¿åº¦ï¼Œéæ•°ç»„ä¸‹æ ‡</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ICPC</category>
      </categories>
  </entry>
  <entry>
    <title>astæ ‘</title>
    <url>/2022/11/21/Js_Ast/</url>
    <content><![CDATA[<ul>
<li>astæ ‘ç®€è¿°ä»¥åŠé€†å‘<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 align = "center">ç®€è¿°</h2>


<h3 id="astæ ‘-æŠ½è±¡è¯­æ³•æ ‘"><a href="#astæ ‘-æŠ½è±¡è¯­æ³•æ ‘" class="headerlink" title="astæ ‘(æŠ½è±¡è¯­æ³•æ ‘)"></a>astæ ‘(æŠ½è±¡è¯­æ³•æ ‘)</h3><h3 id="å®˜æ–¹è§£é‡Š"><a href="#å®˜æ–¹è§£é‡Š" class="headerlink" title="å®˜æ–¹è§£é‡Š"></a>å®˜æ–¹è§£é‡Š</h3><ul>
<li>æ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºã€‚å®ƒä»¥æ ‘çŠ¶çš„å½¢å¼è¡¨ç°ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ç»“æ„ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚</li>
</ul>
<h3 id="ç®€å•æè¿°"><a href="#ç®€å•æè¿°" class="headerlink" title="ç®€å•æè¿°"></a>ç®€å•æè¿°</h3><ul>
<li>å…¶å®å¾ˆç®€å•ï¼Œastæ ‘å°±è·Ÿä¸€æœ¬ä¹¦çš„ç›®å½•ä¸€æ ·ï¼Œåªä¸è¿‡è¿™ä¸ªç›®å½•æ›´åŠ è¯¦ç»†ã€‚ä»¥ä¸€ç§æå–å…³é”®è¯å’ŒåŠŸèƒ½çš„æ–¹å¼å®Œç¾å±•ç°ä¸€æ®µä»£ç çš„å±‚æ¬¡å…³ç³»</li>
</ul>
<h3 id="ç®€å•ä»‹ç»"><a href="#ç®€å•ä»‹ç»" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h3><p>ä¾‹å¦‚jsä»£ç <code>x = a + b</code>ç”Ÿæˆ<code>ast</code>æ ‘ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;type&quot;</span>: <span class="string">&quot;AssignmentExpression&quot;</span>,</span><br><span class="line"><span class="string">&quot;start&quot;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">&quot;end&quot;</span>: <span class="number">7</span>,</span><br><span class="line"><span class="string">&quot;operator&quot;</span>: <span class="string">&quot;=&quot;</span>,</span><br><span class="line"><span class="string">&quot;left&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;end&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;x&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;right&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;BinaryExpression&quot;</span>,</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">&quot;end&quot;</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="string">&quot;left&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">&quot;end&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;a&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;operator&quot;</span>: <span class="string">&quot;+&quot;</span>,</span><br><span class="line">    <span class="string">&quot;right&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="string">&quot;end&quot;</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;b&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å…¶å†…å®¹æ˜¯ååˆ†è¯¦ç»†çš„ï¼š</p>
<ul>
<li>nameï¼šç›®æ ‡å…ƒç´ ï¼Œä½œç”¨å¯¹è±¡</li>
<li>startï¼Œendï¼šnameå¯¹è±¡åœ¨ç¨‹åºä»£ç ä¸­çš„èµ·æ­¢ä½ç½®</li>
<li>operatorï¼šæ‰§è¡Œæ“ä½œ</li>
<li>typeï¼šæ“ä½œç§ç±»ï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªå‡½æ•°ã€ä¸€ä¸ªè¿”å›å€¼ã€ä¸€ä¸ªè¿ç®—ã€ä¸€ä¸ªå˜é‡ç­‰ç­‰</li>
</ul>
<h3 id="åœ¨çº¿ç”Ÿæˆastæ ‘ç»“æ„ç½‘ç«™ï¼š"><a href="#åœ¨çº¿ç”Ÿæˆastæ ‘ç»“æ„ç½‘ç«™ï¼š" class="headerlink" title="åœ¨çº¿ç”Ÿæˆastæ ‘ç»“æ„ç½‘ç«™ï¼š"></a>åœ¨çº¿ç”Ÿæˆastæ ‘ç»“æ„ç½‘ç«™ï¼š</h3><ul>
<li><a href="https://astexplorer.net/">https://astexplorer.net/</a></li>
</ul>
<h2 align = "center">asté€†å‘</h2>


<ul>
<li>ç›®å‰æˆ‘æ¥è§¦çš„è¿™æ–¹é¢ä¸œè¥¿ä¹Ÿå¾ˆå°‘ï¼ŒåŸºæœ¬ä¸Šè¦åšçš„äº‹æƒ…åªæœ‰ä¸¤ç§ï¼š<ol>
<li>ç»™ä¸€ä¸ªastæ ‘ï¼Œç„¶åè®©ä½ å»é™¤å…¶ä¸­çš„æ··æ·†æ“ä½œ</li>
<li>ç»™å®šastè¿˜åŸä»£ç ï¼Œè¿™ä¸ªä»£ç å¯ä»¥æ˜¯jsï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ä»»ä½•è¯­è¨€</li>
</ol>
</li>
<li>å¯¹äºä»£ç è¿˜åŸï¼Œè¿™ç§å¾ˆéš¾æœ‰ç°æˆå·¥å…·ä½¿ç”¨ï¼Œå°ä»£ç æ‰‹æ¨ï¼Œå¤§ä»£ç è‡ªå·±å†™é’ˆå¯¹è„šæœ¬</li>
<li>æ‰‹æ¨çš„è¯ï¼š<ul>
<li>å®šä½operatorå…ˆè¿˜åŸè¿ç®—è¡¨è¾¾å¼</li>
<li>ç”±å†…å±‚å‘å¤–ï¼Œè¿˜åŸä¸€éƒ¨åˆ†åˆ ä¸€éƒ¨åˆ†æ ‘ç»“æ„</li>
<li>ç‹¬ç«‹åº¦å¤§çš„ä¼˜å…ˆï¼ŒæŒ‰å‡½æ•°æ¨¡å—è¿˜åŸ</li>
<li>è‡ªå·±å†™å¯¹åº”ä»£ç ç”Ÿæˆastæ ‘æ¯”å¯¹</li>
</ul>
</li>
<li>å¤§æ¦‚å°±è¿™æ ·</li>
</ul>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>Teaç±»ç®—æ³•</title>
    <url>/2022/11/21/Shell_Tea/</url>
    <content><![CDATA[<ul>
<li>ä¸»è¦ä¸ºåŠ è§£å¯†è„šæœ¬</li>
<li>Teaã€xxTea<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<ul>
<li>ä¸€å†™é¢˜å°±æ˜¯å˜ç§xxteaï¼Œæˆ‘å·²ç»æ— è¯­äº†</li>
<li>èŒ¶ç±»ç®—æ³•ä¸€èˆ¬æ¥è®²é¡ºåºé€†å†™åŠ å¯†ä»£ç å³å¯</li>
<li>ä»£ç åŸºäºç½‘ç»œå¼€æºä»£ç ä¿®æ”¹ï¼Œä¾µåˆ </li>
</ul>
<h2 align = "center">Tea</h2>

<h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><ul>
<li><p>deltaå¸¸æ•°ï¼š0x9e3779b9</p>
</li>
<li><p>keyï¼š4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</p>
</li>
<li><p>vï¼š2ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</p>
</li>
</ul>
<h4 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h4><ul>
<li>åˆ©ç”¨keyå’Œdeltaå¯¹æ•°æ®è¿›è¡Œ32è½®ç®€å•å’ŒåŠ å¯†</li>
<li>ç‰¹å¾ï¼š<ul>
<li>ä¸‰å¼‚æˆ–</li>
<li>4ã€5ç§»ä½</li>
</ul>
</li>
</ul>
<h4 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;  </span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>;               </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                      </span><br><span class="line">        sum += delta;  </span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">    &#125;                                                </span><br><span class="line">    v[<span class="number">0</span>] = v0; </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;  </span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>; </span><br><span class="line">	<span class="type">uint32_t</span> sum = <span class="number">0xc6ef3720</span>     <span class="comment">//sum = delta*32 = 0x13c6ef3720ï¼Œå–32ä½ï¼Œé«˜ä½æ•°æ®æº¢å‡º </span></span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>]; </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                         </span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">        sum -= delta;  </span><br><span class="line">    &#125;                                            </span><br><span class="line">    v[<span class="number">0</span>] = v0; </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>



<h2 align = "center">xxTea</h2>

<ul>
<li>keyå’Œdeltaå¦‚ä¸Šï¼ŒåŠ å¯†è½®æ•°ç”±æ•°æ®é•¿åº¦nå†³å®š</li>
<li>æ”¹é­”æ•°çš„å°±å¦å½“åˆ«è®ºï¼Œä¸€èˆ¬è§£teaéƒ½æ˜¯ç”¨c++å†™</li>
</ul>
<h4 id="c"><a href="#c" class="headerlink" title="c++"></a>c++</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//å¸¸è§å˜åŒ–ç‚¹</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))  </span></span><br><span class="line"><span class="comment">//keyå®šä¹‰ï¼Œ4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;&#125;;</span><br><span class="line"><span class="comment">//delta</span></span><br><span class="line"><span class="type">uint32_t</span> delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">uint32_t</span>* flag, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> y, z, sum;  </span><br><span class="line">  rounds = <span class="number">52</span> / n + <span class="number">6</span>;</span><br><span class="line">  sum = <span class="number">0</span>;</span><br><span class="line">  z = flag[n - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    sum += delta;</span><br><span class="line">    e = (sum&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      y = flag[i+<span class="number">1</span>];</span><br><span class="line">      z = flag[i] += MX;</span><br><span class="line">    &#125;</span><br><span class="line">    y = flag[<span class="number">0</span>];</span><br><span class="line">    z = flag[n<span class="number">-1</span>] += MX;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* flag, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> y, z, sum;  </span><br><span class="line">  rounds = <span class="number">52</span> / n + <span class="number">6</span>;</span><br><span class="line">  sum = rounds*delta;</span><br><span class="line">  y = flag[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    e = (sum&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = n<span class="number">-1</span>; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">      z = flag[i<span class="number">-1</span>];</span><br><span class="line">      y = flag[i] -= MX;</span><br><span class="line">    &#125;</span><br><span class="line">    z = flag[n<span class="number">-1</span>];</span><br><span class="line">    y = flag[<span class="number">0</span>] -= MX;</span><br><span class="line">    sum -= delta;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å‚æ•°æè¿°:</span></span><br><span class="line"><span class="string">  DELTA: ç¥ç§˜å¸¸æ•°Î´ï¼Œå®ƒæ¥æºäºé»„é‡‘æ¯”ç‡ï¼Œä»¥ä¿è¯æ¯ä¸€è½®åŠ å¯†éƒ½ä¸ç›¸åŒã€‚ä½†Î´çš„ç²¾ç¡®å€¼ä¼¼ä¹å¹¶ä¸é‡è¦ï¼Œè¿™é‡Œ TEA æŠŠå®ƒå®šä¹‰ä¸º Î´=ã€Œ(âˆš5 - 1)231ã€</span></span><br><span class="line"><span class="string">      v: éœ€è¦åŠ è§£å¯†çš„æ•°æ®ï¼Œæ ¼å¼ä¸º32ä½çš„æ— ç¬¦å·æ•´æ•°ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="string">      n: nè¡¨ç¤ºéœ€è¦åŠ å¯†çš„32ä½æ— ç¬¦å·æ•´æ•°çš„ä¸ªæ•°ï¼ˆä¾‹ï¼šnä¸º1æ—¶ï¼Œåªæœ‰væ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«åŠ å¯†äº†ï¼‰ï¼Œnä¸èƒ½å¤§äºvçš„é•¿åº¦</span></span><br><span class="line"><span class="string">      k: å¯†é’¥ï¼Œæ ¼å¼ä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ç»„æˆçš„æ•°ç»„ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> c_uint32</span><br><span class="line"> </span><br><span class="line">DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, n, k</span>):</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="built_in">int</span>(<span class="number">52</span> / n)</span><br><span class="line">    <span class="built_in">sum</span> = c_uint32(<span class="number">0</span>)</span><br><span class="line">    z = v[n - <span class="number">1</span>].value</span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">sum</span>.value += DELTA</span><br><span class="line">        e = (<span class="built_in">sum</span>.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        p = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> p &lt; n - <span class="number">1</span>:</span><br><span class="line">            y = v[p + <span class="number">1</span>].value</span><br><span class="line">            v[p].value += (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">            z = v[p].value</span><br><span class="line">            p += <span class="number">1</span></span><br><span class="line">        y = v[<span class="number">0</span>].value</span><br><span class="line">        v[n - <span class="number">1</span>].value += (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">        z = v[n - <span class="number">1</span>].value</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, n, k</span>):</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="built_in">int</span>(<span class="number">52</span> / n)</span><br><span class="line">    <span class="built_in">sum</span> = c_uint32(rounds * DELTA)</span><br><span class="line">    y = v[<span class="number">0</span>].value</span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        e = (<span class="built_in">sum</span>.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        p = n - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> p &gt; <span class="number">0</span>:</span><br><span class="line">            z = v[p - <span class="number">1</span>].value</span><br><span class="line">            v[p].value -= (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">            y = v[p].value</span><br><span class="line">            p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>].value</span><br><span class="line">        v[<span class="number">0</span>].value -= (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">        y = v[<span class="number">0</span>].value</span><br><span class="line">        <span class="built_in">sum</span>.value -= DELTA</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>():</span><br><span class="line">    k = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    v = [c_uint32(<span class="number">1</span>), c_uint32(<span class="number">2</span>)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;plain: 1 2&#x27;</span>)</span><br><span class="line">    encrypt(v, <span class="built_in">len</span>(v), k)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;encrypted: %X %X&#x27;</span> % (v[<span class="number">0</span>].value, v[<span class="number">1</span>].value))</span><br><span class="line">    decrypt(v, <span class="built_in">len</span>(v), k)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;decrypted: %X %X&#x27;</span> % (v[<span class="number">0</span>].value, v[<span class="number">1</span>].value))</span><br><span class="line"></span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br><span class="line">æ­¤æ®µä»£ç ä¸ºè½¬è½½ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/koxb/article/details/<span class="number">120088234</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>UNCTF2022å‚èµ›æ€»ç»“</title>
    <url>/2022/11/18/UNCTF2022/</url>
    <content><![CDATA[<ul>
<li>æ€»è¿°</li>
<li>éƒ¨åˆ†é¢˜ç›®WP<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h1 align = "center">æ€»è¿°</h1>

<ul>
<li><p>è¿™åœºæ¯”èµ›ç®—æ˜¯æˆ‘ç¬¬ä¸€åœºé•¿æ—¶é—´å…¨ç¨‹æŠ•å…¥çš„æ¯”èµ›ï¼Œæ¯å¤©ä»æ—©ä¸Šæ‰“åˆ°æ™šä¸Š12ç‚¹ï¼Œä¸å¾—ä¸è¯´ï¼Œè¿˜æŒºäº«å—æ•´ä¸ªè¿‡ç¨‹ã€‚å…¨ç¨‹rankæœ€å¥½çš„æ—¶å€™æ˜¯ç¬¬3ï¼Œå‰æœŸåˆ†æ•°æ‹‰æ»¡ï¼Œä¸­æœŸä¹åŠ›ï¼Œæœ€åä¸¤å¤©ç›´æ¥å†¥æƒ³åç‰¢ï¼Œæ¯”èµ›ç»“æŸå‰åŠå°æ—¶æ‰Aæ‰åŸ¹æ ¹å¯†ç é¢˜ï¼Œå®ˆä½äº†rank19ã€‚å10åçš„åˆ†å·®æ˜¯çœŸçš„å°ï¼Œå†åŠ ä¸Šæœ€åå‚ç›´ä¸Šåˆ†çš„ä½¬ï¼ŒèŠ‚ç›®æ•ˆæœæ‹‰æ»¡ï¼Œåˆºæ¿€ã€‚</p>
</li>
<li><p>èµ›é¢˜æ–¹é¢ï¼Œä»æˆ‘çš„è§’åº¦çœ‹çš„è¯ï¼š</p>
<ul>
<li><p>reverseæ–¹é¢çš„é¢˜å¯èƒ½ä¸æ˜¯å¾ˆå‹å¥½ï¼Œé‡å¤+éƒ¨åˆ†åé—¨ã€‚2ä¸ªupxå£³ã€1ä¸ªæ‰‹åŠ¨å£³ï¼Œ2ä¸ªrusté€†å‘ï¼Œä»¥åŠastæ™®åŠå’Œå°æ”¹xxteaã€‚</p>
</li>
<li><p>cryptoå’Œmiscæ–¹å‘çš„é¢˜ç›®åŸºæœ¬çŸ¥è¯†ç‚¹è¦†ç›–è¿˜æ˜¯æ¯”è¾ƒå…¨é¢çš„ã€‚å¾ˆå¤šä¸œè¥¿ä¹‹å‰éƒ½æ²¡æœ‰è§è¿‡ï¼Œçº¯googleç°åœºå­¦ä¹ ã€‚å°¤å…¶æ˜¯éšå†™æ–‡ç« çœ‹äº†ä¸€å¤§å †ï¼Œè™½ç„¶miscæ²¡å†™å‡ºå‡ é“â€¦â€¦.å¤ªèœäº†</p>
</li>
</ul>
</li>
<li><p>æ•´ä¸ªæ¯”èµ›æ‰“ä¸‹æ¥ç¡®å®å­¦åˆ°ä¸å°‘ä¸œè¥¿ï¼ŒæŒºå¥½</p>
</li>
</ul>
<h1 align = "center">WP</h1>

<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><code>Reverse</code></h2><h3 id="whereisyourkey-å¹¿ä¸œæµ·æ´‹å¤§å­¦"><a href="#whereisyourkey-å¹¿ä¸œæµ·æ´‹å¤§å­¦" class="headerlink" title="whereisyourkey-å¹¿ä¸œæµ·æ´‹å¤§å­¦"></a>whereisyourkey-å¹¿ä¸œæµ·æ´‹å¤§å­¦</h3><ul>
<li>ç›´æ¥æ¨¡æ‹ŸåŠ å¯†è¿‡ç¨‹å°±è¡Œäº†ï¼Œä¸å¤šè¯´</li>
<li>è¿œç¨‹linuxè°ƒè¯•elfæ‰§è¡Œåˆ°åŠ å¯†ç»“æŸæå–æ•°æ®ä¹Ÿè¡Œ</li>
</ul>
<h3 id="halo-ç»å…´å…ƒåŸ¹"><a href="#halo-ç»å…´å…ƒåŸ¹" class="headerlink" title="halo-ç»å…´å…ƒåŸ¹"></a>halo-ç»å…´å…ƒåŸ¹</h3><p><code>è€ƒç‚¹</code>ï¼š<code>upxè„±å£³</code>ï¼Œ<code>é€»è¾‘è¿ç®—</code>ï¼Œ<code>å¼‚æˆ–è§£å¯†</code></p>
<ul>
<li><p>è¿™ä¸ªé¢˜å¤šå°‘æœ‰ç‚¹ç»•</p>
</li>
<li><p>æœ€åç”¨æ¥æ ¡å¯¹çš„é‚£ä¸€å †å¼‚æˆ–å’Œæˆ–ï¼Œåªæœ‰æ¯ä¸ªå¼‚æˆ–ç»“æœä¸º0æ¡ä»¶æ‰ä¸ºçœŸï¼Œä¹Ÿå°±æ˜¯è¯´å•ä¸ªå¼‚æˆ–çš„ç»“æœéƒ½æ˜¯ç›¸ç­‰çš„ï¼Œé€šè¿‡è¿™é‡Œå°±å¯ä»¥å¾—åˆ°æ“ä½œè¿‡åçš„flag</p>
</li>
<li><p>ä¸­é—´çš„åŠ å¯†ï¼Œé€šè¿‡åˆ†æä»£ç å¯ä»¥å‘ç°è§„å¾‹</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">f0 = f0^<span class="number">0</span>  </span><br><span class="line">ff1 = f0^<span class="number">0</span>^f1^<span class="number">1</span></span><br><span class="line">f2 = f2^<span class="number">2</span>^f0^<span class="number">0</span>^f1^<span class="number">1</span></span><br><span class="line"></span><br><span class="line">ç›¸å½“äºï¼Œé¡ºåºåŠ å¯†ï¼šfn = fn-<span class="number">1</span> ^ n</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥åè¿‡æ¥å¼‚æˆ–å›å»å°±å®Œäº†</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ€ä¸Šé¢è¿˜æœ‰ä¸ªarray^0x33ï¼Œå°±æ˜¯arrayæ•°ç»„ç¬¬ä¸€ä½å¼‚æˆ–ï¼Œå¼„ä¸€ä¸‹å°±è¡Œ</p>
</li>
<li><p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="number">102</span>, <span class="number">0xb</span>,<span class="number">0x68</span>,<span class="number">0xc</span>,<span class="number">0x73</span>,<span class="number">0x3e</span>,<span class="number">0xc</span>,<span class="number">0x3a</span>,<span class="number">0x5d</span>,<span class="number">0x1b</span>,<span class="number">0x21</span>,<span class="number">0x75</span>,<span class="number">0x4f</span>,<span class="number">0x20</span>,<span class="number">0x4c</span>,<span class="number">0x71</span>,<span class="number">0x58</span>,<span class="number">0x7b</span>,<span class="number">0x59</span>,<span class="number">0x2c</span>,<span class="number">0x0</span>,<span class="number">0x77</span>,<span class="number">0x58</span>,<span class="number">0x77</span>,<span class="number">0xe</span>,<span class="number">0x72</span>,<span class="number">0x5b</span>,<span class="number">0x26</span>,<span class="number">0xb</span>,<span class="number">0x70</span>,<span class="number">0xa</span>,<span class="number">0x77</span>,<span class="number">0x66</span>,<span class="number">0x77</span>,<span class="number">0x36</span>,<span class="number">0x76</span>,<span class="number">0x37</span>,<span class="number">0x76</span>,<span class="number">0x62</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x27</span>,<span class="number">0x3f</span>,<span class="number">0x77</span>,<span class="number">0x26</span>]</span><br><span class="line">x = <span class="number">44</span></span><br><span class="line"><span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">list</span>[x] = <span class="built_in">list</span>[x]^<span class="built_in">list</span>[x-<span class="number">1</span>]^x</span><br><span class="line">    x -= <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># flag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¯¹äº†ï¼Œè¿˜æœ‰ä¸ªupxè„±å£³ï¼Œç›´æ¥å·¥å…·æä¸€ä¸‹</p>
</li>
</ul>
<h3 id="ezzzzre-å¹¿ä¸œæµ·æ´‹å¤§å­¦"><a href="#ezzzzre-å¹¿ä¸œæµ·æ´‹å¤§å­¦" class="headerlink" title="ezzzzre-å¹¿ä¸œæµ·æ´‹å¤§å­¦"></a>ezzzzre-å¹¿ä¸œæµ·æ´‹å¤§å­¦</h3><ul>
<li><p>æœ‰ä¸ªupxå£³ï¼Œå·¥å…·è„±æ‰</p>
</li>
<li><p>F5ä¸»å‡½æ•°</p>
</li>
<li><p>æ ¸å¿ƒä»£ç å°±è¿™ä¸€è¡Œï¼š </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( Str[i] != <span class="number">2</span> * aHelloctf[i] - <span class="number">69</span> )</span><br></pre></td></tr></table></figure>
</li>
<li><p>æå–Helloctf[i]ç›´æ¥è®¡ç®—å³å¯</p>
</li>
</ul>
<h3 id="Sudoku-é™†å†›å·¥ç¨‹å¤§å­¦"><a href="#Sudoku-é™†å†›å·¥ç¨‹å¤§å­¦" class="headerlink" title="Sudoku-é™†å†›å·¥ç¨‹å¤§å­¦"></a>Sudoku-é™†å†›å·¥ç¨‹å¤§å­¦</h3><p><code>è€ƒç‚¹</code>ï¼š<code>åŠ¨æ€è°ƒè¯•</code>ï¼Œ<code>æ•°æ®æå–</code>ï¼Œ<code>python</code></p>
<ul>
<li><p>IDAåç¼–F5+cmdè¿è¡Œæµ‹è¯•</p>
</li>
<li><p>å¥½åƒæ˜¯ä¸ªæ•°ç‹¬ï¼Œåˆ†æä¸€ä¸‹</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  </span><br><span class="line">  ......  </span><br><span class="line"><span class="comment">//ç”Ÿæˆæ£€æµ‹æ•°ç‹¬</span></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">Prepare</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12) )		  </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !v12[<span class="number">9</span> * i + j] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">            v4[k] = <span class="number">0</span>;									<span class="comment">//ç”Ÿæˆå‡½æ•°</span></span><br><span class="line">          <span class="built_in">line</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i);</span><br><span class="line">          <span class="built_in">row</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, j);</span><br><span class="line">          <span class="built_in">SquireNine</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">          <span class="built_in">FillBlank</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//æç¤ºä¿¡æ¯è¾“å‡º</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This is a game called Sudoku,just enjoy it!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Pls input your answer in the following format:&quot;</span>);</span><br><span class="line">  <span class="built_in">qmemcpy</span>(v14, &amp;unk_4051C0, <span class="number">0x144</span>ui64);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)v14[<span class="number">9</span> * i + j]);		</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//è¾“å…¥æ•°ç‹¬</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Then you will get your flag!&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v11[<span class="number">9</span> * i + j]);			              </span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//æ ¡éªŒ</span></span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt;= <span class="number">8</span>; ++m )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v11[<span class="number">9</span> * k + m] != v12[<span class="number">9</span> * k + m] )			 </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Y0u_Ar3_Wr0ng!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Y0u_Ar3_R1ght!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬ä¸€çœ¼å°±çœ‹åˆ°v11å’Œv12æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æƒ³åŠæ³•æŠŠv12æå‡ºæ¥ï¼Œé¦–å…ˆè·Ÿè¸ªä¸Šé¢çš„ç”Ÿæˆå‡½æ•°ï¼Œå¾ˆå¤æ‚ï¼Œé‚£å°±åŠ¨æ€è°ƒè¯•ï¼Œè®©æœºå™¨ç”Ÿæˆv12æˆ‘ä»¬å»æå–æ•°æ®</p>
</li>
<li><p>v12ç”Ÿæˆå‡½æ•°ç»“æŸåä½ç½®è®¾æ–­ç‚¹ï¼Œè¿è¡Œï¼Œç„¶åf5åç¼–æ‰¾åˆ°v12å¯¹åº”æ ˆä½ç½®ï¼Œå†™è„šæœ¬æå–æ•°æ®</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x000000000062FA10</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>,cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; <span class="number">81</span>*<span class="number">4</span>; i = i+<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%x &quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">	cnt = cnt + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(cnt % <span class="number">9</span> == <span class="number">0</span>)</span><br><span class="line">	   <span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//8 5 2 4 9 1 6 7 3 </span></span><br><span class="line"><span class="comment">//1 9 6 7 3 8 2 5 4 </span></span><br><span class="line"><span class="comment">//4 3 7 5 6 2 9 1 8 </span></span><br><span class="line"><span class="comment">//5 2 8 1 4 6 3 9 7 </span></span><br><span class="line"><span class="comment">//3 7 4 9 2 5 8 6 1 </span></span><br><span class="line"><span class="comment">//9 6 1 3 8 7 4 2 5 </span></span><br><span class="line"><span class="comment">//2 1 9 8 5 4 7 3 6 </span></span><br><span class="line"><span class="comment">//7 4 3 6 1 9 5 8 2 </span></span><br><span class="line"><span class="comment">//6 8 5 2 7 3 1 4 9</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»§ç»­è¿è¡Œï¼Œè¾“å…¥æå–çš„æ•°ç‹¬</p>
</li>
<li><p>è¿è¡Œåˆ°æ˜¾ç¤ºï¼š</p>
<blockquote>
<p>UNCTF{chr(29+vme)chr(15+vme)chr(29+vme)chr(24+vme)chr(39+vme)chr(25+vme)chr(29+vme)chr(20+vme)chr(32+vme)}</p>
</blockquote>
</li>
<li><p>pythonè§£ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;UNCTF&#123;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">15</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">24</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">39</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">25</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">20</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">32</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#125;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;OAOJYKOFR&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezast-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦"><a href="#ezast-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦" class="headerlink" title="ezast-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦"></a>ezast-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦</h3><p><code>è€ƒç‚¹</code>ï¼š<code>astæ ‘</code>ï¼Œ<code>js</code>ï¼Œ<code>ä»£ç è¿˜åŸ</code></p>
<ul>
<li><p>ä¸€å£è€è¡€åå‡ºæ¥</p>
</li>
<li><p>ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§é¢˜ï¼Œç ”ç©¶äº†ä¸€ä¸‹astæ ‘ï¼Œç„¶åå°±å¼€å§‹æ‰‹æ¨æºä»£ç </p>
</li>
<li><p>ä¸€è¾¹æ„å»ºä»£ç çœ‹astä¸€è¾¹è¿˜åŸï¼ˆå¾—äºæœ‰ä¸ªaståœ¨çº¿ç½‘ç«™ï¼‰</p>
</li>
<li><p>è¿˜åŸä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ezdecode</span>(<span class="params">flag,key</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> arr_data = flag.<span class="title function_">split</span>()</span><br><span class="line">  <span class="keyword">return</span> arr_data.<span class="title function_">map</span>(<span class="function"><span class="params">i</span> =&gt;</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(i.<span class="title function_">charCodeAt</span>()^(key += <span class="number">1</span>))).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> $_a = <span class="title function_">test</span>()</span><br><span class="line">$_a -= <span class="number">1145</span>*<span class="number">100</span></span><br><span class="line">$_a += <span class="number">0xb</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">ezdecode</span>(<span class="string">&quot;OTYN\\a[inE+iEl.hcEo)ivo+g&quot;</span>,$_a))</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">114514</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>emmmmï¼Œæ¯æ¬¡åªèƒ½è§£å¯†ä¸€ä¸ªå­—ç¬¦ï¼Œç„¶åæˆ‘å°±ç›´æ¥æ‰‹åˆ äº†åŠå¤©åŠ å¯†ä¸²æŠŠflagæ„é€ å‡ºæ¥äº†</p>
</li>
<li><p>å¯¹äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªç”¨æ¥è½¬ä¹‰çš„\è¦åˆ æ‰</p>
</li>
<li><p>UNCTF{Ast_1s_v4ry_u3slu1}</p>
</li>
</ul>
<h3 id="HelloRust"><a href="#HelloRust" class="headerlink" title="HelloRust"></a>HelloRust</h3><ul>
<li><p>è¿™é¢˜ï¼Œä¸€åˆ‡éƒ½åœ¨åŠ¨è°ƒä¸­</p>
</li>
<li><p>é¦–å…ˆé€šè¿‡å…³é”®è¯æ£€ç´¢è¯†åˆ«ä¸ºrc4åŠ å¯†</p>
</li>
<li><p>ä¿®æ”¹å†…å­˜æ•°æ®ï¼Œå°†unctfç­‰ç­‰ä¸€ç³»åˆ—æ•°æ®å˜ä¸ºå­—ç¬¦ä¸²</p>
</li>
<li><p>åŠ¨è°ƒï¼Œåœ¨keyinitå‡½æ•°å¤„æ‰¾åˆ°å¯†é’¥<code>Unctf2022</code></p>
</li>
<li><p>åœ¨cmpå‡½æ•°ä¸Šæ–¹æ‰¾åˆ°å¯†æ–‡</p>
</li>
<li><p>æå–å¯†æ–‡</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x00005622B1A340A6</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; (<span class="number">0x00005622B1A340C1</span> - addr + <span class="number">1</span>); i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%02x&quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//876927216fc731261b6c3a749a626ea002811d85e0e2d071f4a3090e</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨çº¿ç½‘ç«™è§£å¯†å¾—åˆ°</p>
</li>
<li><p>unctf{Ru5t_Rc4_1s_2_e@zy!!!}</p>
</li>
</ul>
<h3 id="shelled-babyxor-é‡åº†å¤§å­¦"><a href="#shelled-babyxor-é‡åº†å¤§å­¦" class="headerlink" title="shelled_babyxor-é‡åº†å¤§å­¦"></a>shelled_babyxor-é‡åº†å¤§å­¦</h3><p><code>è€ƒç‚¹</code>ï¼š<code>æ‰‹åŠ¨è„±å£³</code>ï¼Œ<code>æ•°æ®å¤„ç†</code>ï¼Œ<code>é€†å†™è§£å¯†</code></p>
<ul>
<li><p>æç¤ºè„±å£³+ç®—æ³•é€†å‘ï¼Œæœ‰ç‚¹ä¸œè¥¿</p>
</li>
<li><p>è„±å£³åªèƒ½æ‰‹åŠ¨ï¼Œæ²¡å‘ç°å¸¸è§„çš„pushadä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½†çŸ¥é“æ˜¯è¿è¡Œè‡ªè§£å¯†</p>
</li>
<li><p>x64dbgè¿è¡Œåˆ°è§£å¯†ä½ç½®ï¼ŒæŠŠç¨‹åºdumpå‡ºæ¥æ‹–è¿›ida64</p>
</li>
<li><p>ctrl+f12æœç´¢unctfï¼Œå‘ç°æœ‰ï¼Œå®šä½è¿‡å»ï¼Œxäº¤å‰å¼•ç”¨ï¼Œå®šä½å…³é”®ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FOOL:0000000000402E30 53                            push    rbx</span><br><span class="line">FOOL:0000000000402E31 48 83 EC 50                   sub     rsp, 50h</span><br><span class="line">FOOL:0000000000402E35 E8 06 EA FF FF                call    sub_401840</span><br><span class="line">FOOL:0000000000402E35</span><br><span class="line">FOOL:0000000000402E3A 48 8B 0D 1F 15 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E41 48 8D 5C 24 20                lea     rbx, [rsp+58h+var_38]</span><br><span class="line">FOOL:0000000000402E46 48 8D 15 B3 11 00 00          lea     rdx, aInputYourAnswe            ; &quot;input your answer\n&quot;</span><br><span class="line">FOOL:0000000000402E4D E8 26 E9 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E4D</span><br><span class="line">FOOL:0000000000402E52 48 8B 0D F7 14 00 00          mov     rcx, cs:off_404350</span><br><span class="line">FOOL:0000000000402E59 48 89 DA                      mov     rdx, rbx</span><br><span class="line">FOOL:0000000000402E5C E8 0F E9 FF FF                call    sub_401770</span><br><span class="line">FOOL:0000000000402E5C</span><br><span class="line">FOOL:0000000000402E61 48 89 D9                      mov     rcx, rbx</span><br><span class="line">FOOL:0000000000402E64 E8 07 E7 FF FF                call    sub_401570</span><br><span class="line">	;æ ¸å¿ƒå‡½æ•°</span><br><span class="line">FOOL:0000000000402E64</span><br><span class="line">FOOL:0000000000402E69 85 C0                         test    eax, eax</span><br><span class="line">FOOL:0000000000402E6B 75 1B                         jnz     short loc_402E88</span><br><span class="line">FOOL:0000000000402E6B</span><br><span class="line">FOOL:0000000000402E6D 48 8B 0D EC 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E74 48 8D 15 B4 11 00 00          lea     rdx, aSorryYouAreWro            ; &quot;sorry you are wrong&quot;</span><br><span class="line">FOOL:0000000000402E7B E8 F8 E8 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E7B</span><br><span class="line">FOOL:0000000000402E80</span><br><span class="line">FOOL:0000000000402E80                               loc_402E80:                             ; CODE XREF: sub_402E30+6Bâ†“j</span><br><span class="line">FOOL:0000000000402E80 31 C0                         xor     eax, eax</span><br><span class="line">FOOL:0000000000402E82 48 83 C4 50                   add     rsp, 50h</span><br><span class="line">FOOL:0000000000402E86 5B                            pop     rbx</span><br><span class="line">FOOL:0000000000402E87 C3                            retn</span><br><span class="line">FOOL:0000000000402E87</span><br><span class="line">FOOL:0000000000402E88                               ; ---------------------------------------------------------------------------</span><br><span class="line">FOOL:0000000000402E88</span><br><span class="line">FOOL:0000000000402E88                               loc_402E88:                             ; CODE XREF: sub_402E30+3Bâ†‘j</span><br><span class="line">FOOL:0000000000402E88 48 8B 0D D1 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E8F 48 8D 15 7D 11 00 00          lea     rdx, aYouAreRightWel            ; &quot;you are right!welcome to re&quot;</span><br><span class="line">FOOL:0000000000402E96 E8 DD E8 FF FF                call    sub_401778</span><br></pre></td></tr></table></figure>
</li>
<li><p>è·Ÿè¿›å‡½æ•°å‘ç°åªæœ‰sub_401570åœ¨å¤§é¢ç§¯æ“ä½œæ•°æ®ï¼ŒF5è·Ÿè¿›</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v2;</span><br><span class="line">    v1 += v3 % <span class="number">22</span>;			<span class="comment">//å–ä½™å¾—åˆ°ä¸€ä¸ªv1</span></span><br><span class="line">    <span class="keyword">if</span> ( v2 == &amp;v7[<span class="number">5</span>] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v3 = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">115</span>; ; i = *&amp;v7[<span class="number">4</span> * v4 + <span class="number">5</span>] )	<span class="comment">//å–æ•°</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (v1 ^ *(a1 + v4)) != i )	<span class="comment">//æ ¡å¯¹</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( ++v4 == <span class="number">41</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»ˆäºæ‰¾åˆ°çœŸæ­£çš„æ ¸å¿ƒäº†ï¼Œç›´æ¥é€†å†™è§£å¯†ï¼Œå…ˆæ±‚v1</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1 = <span class="number">0</span>; </span><br><span class="line">  <span class="type">char</span> v7[] = <span class="string">&quot;unctfs&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">    v1 += (((<span class="type">int</span>)v7[i]) % <span class="number">22</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt;v1 &lt;&lt;endl;			<span class="comment">//38</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç„¶åæ‹¿38è·Ÿè¿™å‡½æ•°ç»™å‡ºçš„ä¸€å †æ•°æ®å¼‚æˆ–äº†ä¸€ä¸‹ï¼Œèƒ½æå‡ºUNCTFï¼Œé‚£å°±æ˜¯ç­”æ¡ˆæ²¡è·‘äº†ï¼Œæ•´ç†æ•°æ®ï¼ˆç—›è‹¦é¢å…·ï¼‰ï¼Œç›´æ¥å†™è§£å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>):</span><br><span class="line">    num.append(<span class="number">4</span>*i+<span class="number">5</span>)</span><br><span class="line">v9 = [<span class="number">0x65</span>,<span class="number">0x72</span>,<span class="number">0x60</span>,<span class="number">0x5D</span>,<span class="number">0x5F</span>,<span class="number">0x49</span>,<span class="number">0x53</span>,<span class="number">0x79</span>,<span class="number">0x4C</span>,<span class="number">0x53</span>,<span class="number">0x55</span>,<span class="number">0x52</span>, <span class="number">0x79</span>,<span class="number">0x53</span>, <span class="number">0x48</span>,<span class="number">0x56</span>,<span class="number">0x47</span>,<span class="number">0x45</span>, <span class="number">0x4D</span>,<span class="number">0x43</span>, <span class="number">0x42</span>,<span class="number">0x79</span>, <span class="number">0x5F</span>,<span class="number">0x49</span>, <span class="number">0x53</span>,<span class="number">0x54</span>, <span class="number">0x79</span>,<span class="number">0x40</span>,<span class="number">0x4F</span>,<span class="number">0x54</span>,<span class="number">0x55</span>,<span class="number">0x52</span>,<span class="number">0x79</span>,<span class="number">0x56</span>, <span class="number">0x54</span>,<span class="number">0x49</span>, <span class="number">0x41</span>,<span class="number">0x54</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(v9))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v9:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">38</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">71</span>^<span class="number">38</span>))</span><br><span class="line"><span class="comment"># CTF&#123;you_just_unpacked_your_first_progra</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç„¶åï¼ŒUNæˆ‘ä¹‹å‰éªŒè¯äº†ï¼Œæ²¡å†™ï¼Œæœ€åprogram}çŒœå¾—å‡ºæ¥ï¼Œå¯„</p>
</li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><code>Crypto</code></h2><h3 id="md5-1-è¥¿å—ç§‘æŠ€å¤§å­¦"><a href="#md5-1-è¥¿å—ç§‘æŠ€å¤§å­¦" class="headerlink" title="md5-1-è¥¿å—ç§‘æŠ€å¤§å­¦"></a>md5-1-è¥¿å—ç§‘æŠ€å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>md5</code></p>
<ul>
<li>åƒæˆ‘è¿™ç§å¤§å†¤ç§ç›´æ¥é€ md5åŠ å¯†å­—å…¸</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># å¾…åŠ å¯†ä¿¡æ¯</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># åˆ›å»ºmd5å¯¹è±¡</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># åˆ›å»ºmd5å¯¹è±¡</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line">li = [<span class="string">&#x27;4c614360da93c0a041b22e537de151eb&#x27;</span>,<span class="string">&#x27;8d9c307cb7f3c4a32822a51922d1ceaa&#x27;</span>,<span class="string">&#x27;0d61f8370cad1d412f80b84d143e1257&#x27;</span>,<span class="string">&#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;</span>,<span class="string">&#x27;800618943025315f869e4e1f09471012&#x27;</span>,<span class="string">&#x27;f95b70fdc3088560732a5ac135644506&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;4a8a08f09d37b73795649038408b5f33&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span> l.get(i):</span><br><span class="line">        <span class="built_in">print</span>(l[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="md5-2-è¥¿å—ç§‘æŠ€å¤§å­¦"><a href="#md5-2-è¥¿å—ç§‘æŠ€å¤§å­¦" class="headerlink" title="md5-2-è¥¿å—ç§‘æŠ€å¤§å­¦"></a>md5-2-è¥¿å—ç§‘æŠ€å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>md5</code>ï¼Œ<code>å¼‚æˆ–</code></p>
<ul>
<li>å¤šäº†ä¸ªå¼‚æˆ–ç½¢äº†ï¼Œæ³¨æ„é•¿åº¦ä¸å¤Ÿè¡¥ä½å°±è¡Œ^_^</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆè¡¨</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># å¾…åŠ å¯†ä¿¡æ¯</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># åˆ›å»ºmd5å¯¹è±¡</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># åˆ›å»ºmd5å¯¹è±¡</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">x = [<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&quot;^&quot;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    str2 = i</span><br><span class="line">    <span class="comment"># åˆ›å»ºmd5å¯¹è±¡</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€éªŒ</span></span><br><span class="line">li = [<span class="number">0x4c614360da93c0a041b22e537de151eb</span>,<span class="number">0xc1fd731c6d60040369908b4a5f309f41</span>,<span class="number">0x80fdc84bbb5ed9e207a21d5436efdcfd</span>,<span class="number">0xb48d19bb99a7e6bb448f63b75bc92384</span>,<span class="number">0x39eaf918a52fcaa5ed9195e546b021c1</span>,<span class="number">0x795d6869f32db43ff5b414de3c235514</span>,<span class="number">0xf59a054403f933c842e9c3235c136367</span>,<span class="number">0xc80b37816048952a3c0fc9780602a2fa</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xcad06891e0c769c7b02c228c8c2c8865</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x4bdea6676e5335f857fa8e47249fa1d8</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xedbb7ab78cde98a07b9b5a2ab284bf0a</span>,<span class="number">0x44b43e07e9af05e3b9b129a287e5a8df</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xabed1f675819a2c0f65c9b7da8cab301</span>,<span class="number">0x738c486923803a1b59ef17329d70bbbd</span>,<span class="number">0x7e209780adf2cd1212e793ae8796ed7c</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0x636a84a33e1373324d64463eeb8e7614</span>,<span class="number">0x6ec65b4ab061843b066cc2a2f16820d5</span>,<span class="number">0xa4a39b59eb036a4a8922f7142f874114</span>,<span class="number">0x8c34745bd5b5d42cb3efe381eeb88e4b</span>,<span class="number">0x5b1ba76b1d36847d632203a75c4f74e2</span>,<span class="number">0xd861570e7b9998dbafb38c4f35ba08bc</span>,<span class="number">0x464b7d495dc6019fa4a709da29fc7952</span>,<span class="number">0x8eb69528cd84b73d858be0947f97b7cc</span>,<span class="number">0xdd6ac4c783a9059d11cb0910fc95d4a</span>,<span class="number">0x4b6b0ee5d5f6b24e6898997d765c487c</span>,<span class="number">0xb0762bc356c466d6b2b8f6396f2e041</span>,<span class="number">0x8547287408e2d2d8f3834fc1b90c3be9</span>,<span class="number">0x82947a7d007b9854fa62efb18c9fd91f</span>,<span class="number">0x8ddafe43b36150de851c83d80bd22b0a</span>,<span class="number">0xc7b36c5f23587e285e528527d1263c8b</span>,<span class="number">0x2a0816e8af86e68825c9df0d63a28381</span>,<span class="number">0x63ce72a42cf62e6d0fdc6c96df4687e3</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] ^= li[cnt - <span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] = <span class="built_in">hex</span>(li[cnt])</span><br><span class="line">    li[cnt] = li[cnt][<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(i) != <span class="number">32</span>):</span><br><span class="line">        i1 = <span class="string">&#x27;0&#x27;</span> + i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i1 = i</span><br><span class="line">    <span class="keyword">if</span> l.get(i1):</span><br><span class="line">        <span class="built_in">print</span>(l[i1],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;false&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="dddd-è¥¿å—ç§‘æŠ€å¤§å­¦"><a href="#dddd-è¥¿å—ç§‘æŠ€å¤§å­¦" class="headerlink" title="dddd-è¥¿å—ç§‘æŠ€å¤§å­¦"></a>dddd-è¥¿å—ç§‘æŠ€å¤§å­¦</h3><p><code>æ‘©æ–¯å¯†ç </code></p>
<ul>
<li>æ‘©æ–¯å¯†ç 01è§£å¯†ï¼Œè¿™ä¸å†™äº†å§</li>
</ul>
<h3 id="caesar-è¥¿å—ç§‘æŠ€å¤§å­¦"><a href="#caesar-è¥¿å—ç§‘æŠ€å¤§å­¦" class="headerlink" title="caesar-è¥¿å—ç§‘æŠ€å¤§å­¦"></a>caesar-è¥¿å—ç§‘æŠ€å¤§å­¦</h3><ul>
<li><p>é¢˜ç›®æç¤ºäº†base64è¡¨</p>
</li>
<li><p>UNCTFæ ¡éªŒå‘ç°æ˜¯+45æ›¿æ¢ï¼Œé€†å†™å³å¯</p>
</li>
<li><p>è„šæœ¬(å‘ç‚¹æ˜¯å¾—å»æ‰æœ«å°¾ç©ºæ ¼)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s=  <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">w = <span class="string">&#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY_&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> w:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span>(s.index(i) &gt;= <span class="number">45</span>):</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i) - <span class="number">45</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i)+<span class="number">45</span>-<span class="number">64</span>-<span class="number">26</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(i,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezxor-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦"><a href="#ezxor-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦" class="headerlink" title="ezxor-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦"></a>ezxor-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>å¤šæ¬¡ä¸€å¯†</code>ï¼Œ<code>æ•°æ®è¿˜åŸ</code></p>
<ul>
<li><p>ä¸€ä¸ªå‡é¢˜ï¼ŒåŠ£è´¨å¤šæ¬¡ä¸€å¯†QAQ</p>
</li>
<li><p>decodeå¯†æ–‡ï¼Œä¼ªé€ flagä¸å¯†æ–‡å¼‚æˆ–å¾—åˆ°æ®‹ç¼ºæ˜æ–‡ï¼Œå¯»æ‰¾è‹±æ–‡å•è¯ç‰¹å¾æ¯”å¯¹æ±‚è§£ï¼Œ1å°æ—¶çš„å¿«ä¹æ²¡äº†</p>
<blockquote>
<p>UNCTF{Y0u_are_very_Clever!!!}</p>
</blockquote>
</li>
</ul>
<h3 id="Single-table-è¥¿å—ç§‘æŠ€å¤§å­¦"><a href="#Single-table-è¥¿å—ç§‘æŠ€å¤§å­¦" class="headerlink" title="Single table-è¥¿å—ç§‘æŠ€å¤§å­¦"></a>Single table-è¥¿å—ç§‘æŠ€å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>playfair</code></p>
<ul>
<li><p>å¾ˆæ˜æ˜¾å˜ç§PlayfairåŠ å¯†</p>
</li>
<li><p>æ ¹æ®å®ä¾‹ä¿®æ”¹è¡¨</p>
</li>
<li><p>B C D E F<br>G H I K M<br>N O Q R S<br>T U V W X<br>Z P L A Y</p>
</li>
<li><p>è¿˜åŸå³å¯</p>
<ul>
<li>ä¸åŒè¡Œä¸åŒåˆ—ä¼˜å…ˆå–åä¸€ä¸ªå­—æ¯å¯¹åº”è¡Œå…ƒç´ </li>
<li>åŒè¡Œå–å·¦</li>
<li>åŒåˆ—å–ä¸Š</li>
</ul>
</li>
<li><p>å¾—åˆ°ï¼ˆæ³¨æ„ä¸‹åˆ’çº¿ä½ç½®è¦æ¢ä¸€ä¸‹ï¼Œå“¦å¯¹è¿˜æœ‰å»æ‰xï¼Œæˆ‘è®°å¾—æœ‰äººæœ‰ç¾¤uåæ§½è¿™ä¸ªä¸‹åˆ’çº¿æ¥ç€ï¼‰</p>
<blockquote>
<p> UNCTF{GOD_YOU_KNOW_PLAYFAIR}</p>
</blockquote>
</li>
</ul>
<h3 id="Multi-table-è¥¿å—ç§‘æŠ€å¤§å­¦"><a href="#Multi-table-è¥¿å—ç§‘æŠ€å¤§å­¦" class="headerlink" title="Multi table-è¥¿å—ç§‘æŠ€å¤§å­¦"></a>Multi table-è¥¿å—ç§‘æŠ€å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>ç»´å‰å°¼äºšå¯†ç ï¼ˆVigenereï¼‰</code></p>
<h4 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><ul>
<li><p>è¿™ä¸ªé¢˜å°±æ˜¯æ„é€ äº†ä¸€ä¸ªå¾ªç¯åºçš„å­—æ¯å­—å…¸table</p>
</li>
<li><p>è¿˜æœ‰ä¸€ä¸ªä¹±åºçš„åŒ¹é…å­—æ¯è¡¨base_table</p>
</li>
<li><p>ç„¶åéšæœºç”ŸæˆæŸ¥è¯¢key</p>
</li>
<li><p>åŠ å¯†flag</p>
<ul>
<li>é¦–å…ˆæŸ¥è¯¢base_tableä¸­å­—æ¯ä½ç½®</li>
<li>æ›¿æ¢ä¸ºå­—å…¸keyé”®å¯¹åº”ä½ç½®çš„å€¼</li>
</ul>
</li>
</ul>
<h4 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><ul>
<li><p>é¦–å…ˆç”¨UNCTè¿˜åŸå‡ºkeyæ˜¯å¤šå°‘ï¼Œå†é€†å†™åŠ å¯†å°±å¯</p>
</li>
<li><p>è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å­—å…¸è¡¨</span></span><br><span class="line">table = &#123;<span class="number">0</span>: <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;BCDEFGHIJKLMNOPQRSTUVWXYZA&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;CDEFGHIJKLMNOPQRSTUVWXYZAB&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;DEFGHIJKLMNOPQRSTUVWXYZABC&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;EFGHIJKLMNOPQRSTUVWXYZABCD&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;FGHIJKLMNOPQRSTUVWXYZABCDE&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;GHIJKLMNOPQRSTUVWXYZABCDEF&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;HIJKLMNOPQRSTUVWXYZABCDEFG&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;IJKLMNOPQRSTUVWXYZABCDEFGH&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;JKLMNOPQRSTUVWXYZABCDEFGHI&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;KLMNOPQRSTUVWXYZABCDEFGHIJ&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;LMNOPQRSTUVWXYZABCDEFGHIJK&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;MNOPQRSTUVWXYZABCDEFGHIJKL&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;NOPQRSTUVWXYZABCDEFGHIJKLM&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;OPQRSTUVWXYZABCDEFGHIJKLMN&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;PQRSTUVWXYZABCDEFGHIJKLMNO&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;QRSTUVWXYZABCDEFGHIJKLMNOP&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;RSTUVWXYZABCDEFGHIJKLMNOPQ&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;STUVWXYZABCDEFGHIJKLMNOPQR&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;TUVWXYZABCDEFGHIJKLMNOPQRS&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;UVWXYZABCDEFGHIJKLMNOPQRST&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;VWXYZABCDEFGHIJKLMNOPQRSTU&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;WXYZABCDEFGHIJKLMNOPQRSTUV&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;XYZABCDEFGHIJKLMNOPQRSTUVW&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;YZABCDEFGHIJKLMNOPQRSTUVWX&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;ZABCDEFGHIJKLMNOPQRSTUVWXY&#x27;</span>&#125;</span><br><span class="line"><span class="comment"># ä¹±åºè¡¨</span></span><br><span class="line">base_table=[<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"><span class="comment"># å¯†æ–‡flag</span></span><br><span class="line">flag = <span class="string">&#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;</span></span><br><span class="line"><span class="comment"># è¿˜åŸkey</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;U&#x27;</span>)) <span class="comment">#0  9</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;N&#x27;</span>)) <span class="comment">#1  14</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;C&#x27;</span>)) <span class="comment">#2  5</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;T&#x27;</span>)) <span class="comment">#3  16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">9</span>] == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key0=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">14</span>] == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key1=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">5</span>] == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key2=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">16</span>] == <span class="string">&#x27;G&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key3=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line"><span class="comment"># è¿˜åŸflag</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">key=[<span class="number">9</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">16</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> flag[i] <span class="keyword">in</span> base_table:</span><br><span class="line">        <span class="built_in">print</span>(base_table[table[key[x%<span class="number">4</span>]].index(flag[i])],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="easy-RSA-ä¸­å›½äººæ°‘å…¬å®‰å¤§å­¦"><a href="#easy-RSA-ä¸­å›½äººæ°‘å…¬å®‰å¤§å­¦" class="headerlink" title="easy_RSA-ä¸­å›½äººæ°‘å…¬å®‰å¤§å­¦"></a>easy_RSA-ä¸­å›½äººæ°‘å…¬å®‰å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>:<code>rsaå·²çŸ¥pé«˜ä½æ”»å‡»</code></p>
<ul>
<li><p>çœ‹åˆ°&gt;&gt;200ï¼Œæ˜¯ä¸ªRSAé«˜ä½æ”»å‡»ï¼Œç›´æ¥å¼€æ</p>
</li>
<li><p>å»ç½‘ç«™<a href="https://sagecell.sagemath.org/">Sage Cell Server (sagemath.org)</a>  å…ˆæŠŠrootsçˆ†å‡ºæ¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n=<span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = 8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857s</span><br><span class="line">p4 = p4 &lt;&lt; <span class="number">200</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>


</li>
<li><p>è§£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">roots = [<span class="number">358950849615278333731635244854025425463656033006805723630685</span>]</span><br><span class="line">n = <span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = <span class="number">13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606623830215547787830024125178567428699965091733811241451081695232</span></span><br><span class="line">p= p2 + roots[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Today-is-Thursday-V-me-50-æµ·å—å¤§å­¦"><a href="#Today-is-Thursday-V-me-50-æµ·å—å¤§å­¦" class="headerlink" title="Today_is_Thursday_V_me_50-æµ·å—å¤§å­¦"></a>Today_is_Thursday_V_me_50-æµ·å—å¤§å­¦</h3><ul>
<li><p>è¿™ä¸ªé¢˜å°±æ˜¯çº¯è€ƒå¯Ÿé€†å‘è§£å¯†èƒ½åŠ›ï¼Œå¤§å–œï¼Œå•Šä¸ï¼Œå¤§æ‚²</p>
</li>
<li><p>å¯¹flagå…ˆåŠ å¯†1ï¼Œå†åŠ å¯†2ï¼Œå¾—åˆ°ç»“æœã€‚é€†å†™ï¼Œè¿˜æ˜¯é€†å†™</p>
</li>
<li><p>è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># é¢˜ç›®ä¿¡æ¯</span></span><br><span class="line">key1 = <span class="string">b&#x27;Today_is_Thursday_V_me_50&#x27;</span></span><br><span class="line">key1_num = <span class="number">530007872419584476649862008487908643412379763189507583587632</span></span><br><span class="line">x = <span class="string">&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br><span class="line"><span class="comment">#ç”Ÿæˆ25ä½éšæœºæ•°åºåˆ—</span></span><br><span class="line">random.seed(key1_num)</span><br><span class="line">ran = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    temp_num = random.randint(<span class="number">1</span>,<span class="number">128</span>)</span><br><span class="line">    ran.append(temp_num)</span><br><span class="line"><span class="comment"># å¼‚æˆ–è§£å¯†ï¼ˆencrypt2ï¼‰</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x)):</span><br><span class="line">    temp = bytes_to_long(<span class="built_in">bytes</span>(x[i], encoding=<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    flag.append(temp^ran[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¿å†™encrypt1ï¼Œå¾—å‡ºæœ€åçš„å¼‚æˆ–ä¸²</span></span><br><span class="line">guess=[(<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    what = guess.pop(<span class="number">50</span>)</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span>.join(j <span class="keyword">for</span> j <span class="keyword">in</span> what)</span><br><span class="line">    mask = strxor(<span class="number">5</span>*name.encode(),key1)</span><br><span class="line"><span class="comment"># è™½ç„¶è®¡ç®—äº†å››è½®ï¼Œä½†æœ€ç»ˆç”¨äºä½¿ç”¨çš„ä¸²åªæœ‰æœ€åä¸€è½®</span></span><br><span class="line"><span class="built_in">print</span>(mask)</span><br><span class="line">n4 = <span class="string">&#x27;7\x1a\x02\x15\x17&lt;\x1c\x15+:\x0b\x00\x14\x07\n\x02\x0c9&quot;1\x0e\x109A^&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag[i] ^= <span class="built_in">ord</span>(n4[i])</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;1_l0ve_Thurs4Ay!!!&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦"><a href="#ezRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦" class="headerlink" title="ezRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦"></a>ezRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>z3æ±‚è§£</code>ï¼Œ<code>rsaåŸºç¡€æµç¨‹</code></p>
<ul>
<li><p>éå¸¸è§„rsaå…¬ç§é’¥åˆ¶ä½œï¼Œåè€Œå˜ç®€å•äº†</p>
</li>
<li><p>ç¬¬ä¸€çœ¼ p^4 &#x3D; nï¼Œz3ç›´æ¥æ±‚è§£</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">p = Real(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(p**<span class="number">4</span> == <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>cdnæ­£å¸¸è§£å¯†å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">c = <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">p = <span class="number">89065756791595323358603857939783936930073695697065732353414009005162022399741</span></span><br><span class="line">phi = p**<span class="number">4</span> - p**<span class="number">3</span></span><br><span class="line">d = libnum.invmod(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="babyRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦"><a href="#babyRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦" class="headerlink" title="babyRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦"></a>babyRSA-å¹¿ä¸œæµ·æ´‹å¤§å­¦</h3><ul>
<li><p>æ˜æ–‡é«˜ä½æ”»å‡»ï¼Œç›´æ¥sageè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">c = <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">high_m = <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">m = high_m + x</span><br><span class="line">M = m((m^<span class="number">6</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç„¶åæŠŠMè½¬ä¸€ä¸‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">x =<span class="number">0x554e4354467b32376130616163372d373663622d343237642d393132392d3134373633363064356431627d</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(x))</span><br><span class="line"><span class="comment"># UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ä»Šæ™šåƒä»€ä¹ˆ-é‡‘é™µç§‘æŠ€å­¦é™¢"><a href="#ä»Šæ™šåƒä»€ä¹ˆ-é‡‘é™µç§‘æŠ€å­¦é™¢" class="headerlink" title="ä»Šæ™šåƒä»€ä¹ˆ-é‡‘é™µç§‘æŠ€å­¦é™¢"></a>ä»Šæ™šåƒä»€ä¹ˆ-é‡‘é™µç§‘æŠ€å­¦é™¢</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>åŸ¹æ ¹å¯†ç </code></p>
<ul>
<li><p>10000å’Œ00000ä¸²ï¼Œ5ä½ï¼Œç»“åˆé¢˜ç›®ä»Šæ™šåƒä»€ä¹ˆï¼Œä¼°è®¡æ˜¯åŸ¹æ ¹å¯†ç </p>
</li>
<li><p>æå–æ¯ä¸ªä¸²çš„é¦–ä½æ„æˆæ–°ä¸²ï¼Œå†™è„šæœ¬æ›¿æ¢ä¸ºåŸ¹æ ¹å¯†ç æ ¼å¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lis = [<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;10000&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;B&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> cnt % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;/&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># AAABA/BAAAA/BABBA/ABBBA/BAAAA/ABBAB/ABAAA/BAAAB/AABAB/BAABB/ABBAA</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>å»ç½‘ç«™è§£å¯†å¾—åˆ°flag</p>
<blockquote>
<p>UNCTF{CRYPROISFUN}</p>
</blockquote>
</li>
</ul>
<h3 id="Fermat"><a href="#Fermat" class="headerlink" title="Fermat"></a>Fermat</h3><ul>
<li><p>è´¹é©¬å°å®šç†ï¼š å¦‚æœpæ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œè€Œæ•´æ•°aä¸æ˜¯pçš„å€æ•°ï¼Œåˆ™æœ‰a<sup>(p-1)</sup>â‰¡1ï¼ˆmod pï¼‰</p>
</li>
<li><p>æ¨å¯¼</p>
<ul>
<li><p>gift+x &#x3D; xp</p>
</li>
<li><p>gift &#x3D; (p-1)*x</p>
</li>
<li><p>2<sup>x*(p-1)</sup> â‰¡ 1(mod p)</p>
</li>
<li><p>2<sup>x*(p-1)</sup> - 1 &#x3D; x * p</p>
</li>
<li><p>2<sup>gift</sup> -1 &#x3D; x*p</p>
</li>
<li><p>ç»“åˆn &#x3D; p*q</p>
</li>
<li><p>p &#x3D; gcd(n, 2<sup>gift</sup> -1)</p>
</li>
<li><p>p &#x3D; gcd(n, powmod(2, gift, n))</p>
</li>
</ul>
</li>
<li><p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n =  <span class="number">19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line">c = <span class="number">388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line">gift = <span class="number">28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br><span class="line"></span><br><span class="line">gift = <span class="built_in">pow</span>(<span class="number">2</span>,gift,n) - <span class="number">1</span></span><br><span class="line">p = libnum.gcd(gift,n)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;DO_y0u_Fermat_1ittle_theOrem&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><code>Misc</code></h2><h3 id="magic-word-è¥¿å—ç§‘æŠ€å¤§å­¦"><a href="#magic-word-è¥¿å—ç§‘æŠ€å¤§å­¦" class="headerlink" title="magic_word-è¥¿å—ç§‘æŠ€å¤§å­¦"></a>magic_word-è¥¿å—ç§‘æŠ€å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>é›¶å®½éšå†™</code></p>
<ul>
<li><p>æç¤ºæ˜æ˜¾ï¼Œé›¶å®½éšå†™ï¼Œæ–‡æ¡£cvåˆ°<a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a></p>
</li>
<li><p>è§£å¯†å°±å®Œäº‹äº†</p>
</li>
</ul>
<blockquote>
<p>unctf{We1come_new_ctfer}</p>
</blockquote>
<ul>
<li>ä¸€å¼€å§‹æ²¡æ”¹å¤§å†™WAäº†ä¸€å‘ï¼Œè¡€äº</li>
</ul>
<h3 id="å·¨é±¼-æ²³å—ç†å·¥å¤§å­¦"><a href="#å·¨é±¼-æ²³å—ç†å·¥å¤§å­¦" class="headerlink" title="å·¨é±¼-æ²³å—ç†å·¥å¤§å­¦"></a>å·¨é±¼-æ²³å—ç†å·¥å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>å›¾ç‰‡å¤§å°éšå†™</code>ï¼Œ<code>zipä¼ªåŠ å¯†</code>ï¼Œ<code>æ–‡ä»¶åˆæˆ</code>ï¼Œ<code>pptéšå†™</code></p>
<ul>
<li><p>æ‹¿åˆ°å›¾ç‰‡å…ˆå¸¸è§„æ£€æŸ¥ï¼Œæ”¹äº†æ”¹å®½é«˜ï¼Œå‘ç°å¤šå‡ºä¸€è¡Œå­—â€œæ— æ‰€è°“æˆ‘ä¼šå‡ºæ‰‹â€ï¼Œå¯èƒ½æœ‰ç”¨</p>
</li>
<li><p>ç„¶åkaliè¯•ç€foremostäº†ä¸€ä¸‹ï¼Œå‘ç°å›¾ç‰‡éšè—äº†zipï¼Œæå–å‡ºæ¥æ‰“å¼€</p>
</li>
<li><p>010æŸ¥çœ‹zipï¼ŒçœŸåŠ å¯†ï¼Œæ‹¿åˆšæ‰æ‰¾å‡ºæ¥çš„å­—è¯•äº†ä¸€ä¸‹ï¼Œå¯†ç æ­£ç¡®</p>
</li>
<li><p>æå–å‡ºæ¥åˆæ˜¯ä¸€å±‚zipï¼Œè¿˜æ˜¯æœ‰åŠ å¯†ï¼Œ010æ‰“å¼€ä¸€çœ¼çœ‹åˆ°æ€»æ ‡å¿—ä½0000ï¼Œä¼ªåŠ å¯†</p>
</li>
<li><p>ç¿»çœ‹æ ‡å¿—ä½unshortdeflagï¼Œä¸º1çš„å…¨æ”¹å›0ï¼Œå»ä¼ªåŠ å¯†</p>
</li>
<li><p>ä¸€ä¸ªflagæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªåŒ–å­¦å¼å’Œä¸€ä¸ªåŠ å¯†çš„pptxï¼Œç½‘ä¸ŠæŸ¥äº†åŒ–å­¦å¼åå­—éƒ½ä¸å¯¹ï¼Œå‘ç°å«å…­å…­ç²‰ï¼Œè¯•äº†666ï¼Œæ­£ç¡®ï¼Œå‡ºé¢˜äººçœŸ6</p>
</li>
<li><p>æ‰“å¼€pptxï¼Œæç¤ºflagnothereï¼Œæœ€åä¸€é¡µpptxæ— å†…å®¹ï¼ŒçŒœæµ‹åŒè‰²éšè—åˆ°èƒŒæ™¯é‡Œäº†ï¼Œå…¨é€‰æ›´æ¢å­—ä½“é¢œè‰²ï¼Œå¾—åˆ°flag</p>
<blockquote>
<p>UNCTF{y0u_F1nd_1t!}</p>
</blockquote>
</li>
<li><p>è¿™é¢˜å¤šå†™å‡ ä¸ªå­—ä»¥è¡¨æ•¬æ„ï¼ˆ</p>
</li>
</ul>
<h3 id="syslog-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦"><a href="#syslog-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦" class="headerlink" title="syslog-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦"></a>syslog-æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦</h3><ul>
<li><p>æç¤ºçœ‹å‹ç¼©åŒ…ï¼Œç»“åˆé¢˜ç›®çš„syslog</p>
</li>
<li><p>ä¸Škaliï¼Œbinwalk -eæ–‡ä»¶ï¼Œæ‰“å¼€æ—¥å¿—æŸ¥çœ‹</p>
</li>
<li><p>æœç´¢passwordå‘ç°base64</p>
</li>
<li><pre><code class="css">cGFzc3dvcmQgaXMgVTZudTJfaTNfYjNTdA==
</code></pre>
</li>
<li><p>è§£å¯†å¾—åˆ°å¯†ç </p>
</li>
<li><p>è¾“å…¥å¾—åˆ°flag</p>
<blockquote>
<p>unctf{N1_sH3_D0n9_L0g_dE!}</p>
</blockquote>
</li>
</ul>
<h3 id="æ‰¾å¾—åˆ°æˆ‘å—-é—½å—å¸ˆèŒƒå¤§å­¦"><a href="#æ‰¾å¾—åˆ°æˆ‘å—-é—½å—å¸ˆèŒƒå¤§å­¦" class="headerlink" title="æ‰¾å¾—åˆ°æˆ‘å—-é—½å—å¸ˆèŒƒå¤§å­¦"></a>æ‰¾å¾—åˆ°æˆ‘å—-é—½å—å¸ˆèŒƒå¤§å­¦</h3><ul>
<li><p>æ‰“å¼€æ–‡æ¡£å…¨é€‰è®¾å®šæ–‡å­—é¢œè‰²ï¼Œå‘ç°3kå­—å¤§ä½œæ–‡ï¼Œä½†æ˜¯å¥½åƒæ²¡ç”¨ï¼ŒåºŸè¯æ–‡å­¦æ˜¯ç©æ˜ç™½äº†</p>
</li>
<li><p>å¸¸è§„æ£€æµ‹ï¼Œbinwalkåˆ†ç¦»è½¬å‡ºxml</p>
</li>
<li><p>ä¸€å¤§å †ä¸œè¥¿æŒ¨ä¸ªçœ‹</p>
</li>
<li><p>document.xmlä¸­æœç´¢flagå¾—åˆ°ç»“æœ</p>
</li>
<li><blockquote>
<p>UNCTF{You_find_me!}</p>
</blockquote>
</li>
</ul>
<h3 id="ç¤¾ä»€ä¹ˆç¤¾-æ¹–å—è­¦å¯Ÿå­¦é™¢"><a href="#ç¤¾ä»€ä¹ˆç¤¾-æ¹–å—è­¦å¯Ÿå­¦é™¢" class="headerlink" title="ç¤¾ä»€ä¹ˆç¤¾-æ¹–å—è­¦å¯Ÿå­¦é™¢"></a>ç¤¾ä»€ä¹ˆç¤¾-æ¹–å—è­¦å¯Ÿå­¦é™¢</h3><ul>
<li><p>å‡¤å‡°å¤åŸä¸é”™ï¼Œä»¥åä¸€å®šå»çœ‹çœ‹</p>
</li>
<li><blockquote>
<p>UNCTF{4F0198127A45F66C07A5B1A2DDA8223C}</p>
</blockquote>
</li>
</ul>
<h3 id="In-the-Morse-Garden-é™†å†›å·¥ç¨‹å¤§å­¦"><a href="#In-the-Morse-Garden-é™†å†›å·¥ç¨‹å¤§å­¦" class="headerlink" title="In_the_Morse_Garden-é™†å†›å·¥ç¨‹å¤§å­¦"></a>In_the_Morse_Garden-é™†å†›å·¥ç¨‹å¤§å­¦</h3><p><code>çŸ¥è¯†ç‚¹</code>ï¼š<code>base64</code>ï¼Œ<code>wordéšå†™</code>ï¼Œ<code>æ‘©æ–¯å¯†ç </code></p>
<ul>
<li><p>pdfæ‰“å¼€ï¼Œctrl+Aå‘ç°å›¾ç‰‡ä¸‹é¢æœ‰ä¸œè¥¿ï¼Œæå–å‡ºæ¥</p>
</li>
<li><p>UNCTF{â€¦.&#x3D;}ï¼Œbase64è§£å¯†</p>
</li>
<li><p>èŠ±å›­å®å®ä¹±å…¥</p>
</li>
<li><p>åªæœ‰ç›å¡å·´å¡å’Œä¾å¤æ¯”å¤ï¼ŒåŠ ä¸Šé¢˜ç›®ï¼Œmorseè§£å¯†ï¼ˆç©ºæ ¼æ˜¯æ‘©æ–¯æ–­ç‚¹ï¼Œå› ä¸ºè¿™ä¸ªå¡äº†åŠå¤©ï¼Œæœäº†ï¼‰</p>
</li>
<li><blockquote>
<p>UNCTF{WAN_AN_MAKA_BAKAAAAA!}</p>
</blockquote>
</li>
</ul>]]></content>
      <categories>
        <category>CTFé¢˜è§£</category>
      </categories>
  </entry>
  <entry>
    <title>ACTFæ–°ç”Ÿèµ›2020 fungame</title>
    <url>/2022/11/11/Solve3/</url>
    <content><![CDATA[<ul>
<li>å°å‹æ ˆæº¢å‡º<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="ACTFæ–°ç”Ÿèµ›2020-fungame"><a href="#ACTFæ–°ç”Ÿèµ›2020-fungame" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]fungame"></a>[ACTFæ–°ç”Ÿèµ›2020]fungame</h2><ul>
<li><p>è¿™ä¸ªé¢˜è™½ç„¶ä¸éš¾ï¼Œä½†æ€è·¯æ¸…å¥‡ï¼Œå†™ä¸ªé¢˜è§£</p>
</li>
<li><p>æŸ¥å£³ï¼Œ32ä½æ— å£³ï¼Œè¿›IDA</p>
</li>
<li><p>F5mainå‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+1Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v4 = <span class="built_in">malloc</span>(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(x, <span class="number">0</span>, <span class="number">0x18</span>u);</span><br><span class="line">  <span class="built_in">sub_401340</span>(v4);</span><br><span class="line">  <span class="built_in">sub_4013BA</span>((<span class="type">char</span> *)v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŒ¨ä¸ªçœ‹ï¼Œç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œæœ‰æ„æ€ï¼Œç®€å•å¼‚æˆ–ï¼Œæå–y2ï¼Œy1ï¼Œè§£å¯†ä¸€ä¸‹</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">sub_401340</span><span class="params">(<span class="type">int</span> flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> i; <span class="comment">// [esp+1Fh] [ebp-9h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, flag);           <span class="comment">//è¾“å…¥ç¬¬ä¸€æ®µflag</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//å¼‚æˆ–åŠ å¯†</span></span><br><span class="line">    <span class="keyword">if</span> ( (*(_BYTE *)(i + flag) ^ *((_BYTE *)y1 + i)) != y2[i] )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æå–y1ï¼Œy2è§£å¯†flagï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Re_1s_So0_funny!</span></span><br></pre></td></tr></table></figure>

<p>æäº¤äº†ï¼Œå‡flagï¼Œå†æ¢ï¼Œä¸‹ä¸€ä½å‡½æ•°</p>
</li>
<li><p>è¿™ä¸ªå°±æœ‰æ„æ€äº†ï¼Œ16ä½flagå­˜è¿›äº†12ä½çš„æ•°ç»„ï¼Œææº¢å‡ºå“‡</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">sub_4013BA</span><span class="params">(<span class="type">char</span> *flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//12ä½ï¼Œæº¢å‡º</span></span><br><span class="line">  <span class="type">char</span> Destination[<span class="number">12</span>]; <span class="comment">// [esp+1Ch] [ebp-Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(Destination, flag);	<span class="comment">//ä¼ ç»™desï¼Œæº¢å‡ºéƒ¨åˆ†ä½œä¸ºå‚æ•°ä¼ é€’</span></span><br><span class="line">  <span class="built_in">strcpy</span>(x, flag);				<span class="comment">//åˆå¤åˆ¶ä¸€ä»½ç»™xï¼Œæœ‰é—®é¢˜</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>äº¤å‰å¼•ç”¨æŸ¥x</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __noreturn <span class="title">sub_40233D</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> Str2[<span class="number">13</span>]; </span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">16</span>]; </span><br><span class="line">  <span class="type">char</span> Str[<span class="number">12</span>]; </span><br><span class="line">  <span class="type">size_t</span> v3; </span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input again:&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(Str2, <span class="string">&quot;YTFzMF9wV24=&quot;</span>);	  <span class="comment">//base64åŠ å¯†ç»“æœ</span></span><br><span class="line">  <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="built_in">sizeof</span>(Str));</span><br><span class="line">  <span class="built_in">memset</span>(Str1, <span class="number">0</span>, <span class="built_in">sizeof</span>(Str1));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str);				   <span class="comment">//ç¬¬äºŒæ®µè¾“å…¥</span></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  <span class="built_in">sub_402421</span>(Str, v3, Str1);	   <span class="comment">//base64</span></span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(Str1, Str2) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s%s&quot;</span>, x, Str);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>sub_40233Då°±æ˜¯å¯¹æ–°çš„è¾“å…¥è¿›è¡Œä¸€ä¸ªbase64åŠ å¯†</p>
</li>
<li><p>ä½†æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯æ€ä¹ˆè¢«æ‰§è¡Œçš„ï¼Œç­”æ¡ˆå°±æ˜¯ä¸Šé¢çš„æº¢å‡ºï¼Œé€šè¿‡æº¢å‡ºè°ƒç”¨äº†è¿™ä¸ªå‡½æ•°40233D</p>
</li>
<li><p>æ‰€ä»¥çœŸæ­£çš„flagå°±æ˜¯ï¼š</p>
<blockquote>
<p>x + æº¢å‡º(æ³¨æ„å¤§å°ç«¯åºé—®é¢˜) + str</p>
</blockquote>
</li>
<li><p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¼‚æˆ–è§£å¯†</span></span><br><span class="line"><span class="built_in">list</span>=[<span class="number">0x23</span>,<span class="number">0x61</span>,<span class="number">0x3e</span>,<span class="number">0x69</span>,<span class="number">0x54</span>,<span class="number">0x41</span>,<span class="number">0x18</span>,<span class="number">0x4d</span>,<span class="number">0x6e</span>,<span class="number">0x3b</span>,<span class="number">0x65</span>,<span class="number">0x53</span>,<span class="number">0x30</span>,<span class="number">0x79</span>,<span class="number">0x45</span>,<span class="number">0x5b</span>]</span><br><span class="line">list1=[<span class="number">0x71</span>,<span class="number">0x4</span>,<span class="number">0x61</span>,<span class="number">0x58</span>,<span class="number">0x27</span>,<span class="number">0x1e</span>,<span class="number">0x4b</span>,<span class="number">0x22</span>,<span class="number">0x5e</span>,<span class="number">0x64</span>,<span class="number">0x3</span>,<span class="number">0x26</span>,<span class="number">0x5e</span>,<span class="number">0x17</span>,<span class="number">0x3c</span>,<span class="number">0x7a</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    <span class="built_in">list</span>[i] = <span class="built_in">chr</span>(<span class="built_in">list</span>[i]^list1[i])</span><br><span class="line"><span class="built_in">list</span> = <span class="built_in">list</span>[:<span class="number">12</span>]</span><br><span class="line"><span class="comment">#æº¢å‡º</span></span><br><span class="line">yichu = [<span class="number">0x3d</span>,<span class="number">0x23</span>,<span class="number">0x40</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> yichu:</span><br><span class="line">    <span class="built_in">list</span>.append(<span class="built_in">chr</span>(i))</span><br><span class="line"><span class="built_in">list</span> = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>)</span><br><span class="line"><span class="comment">#base64</span></span><br><span class="line">s=<span class="string">&quot;YTFzMF9wV24=&quot;</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s = <span class="built_in">str</span>(base64.b64decode(s),encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + <span class="built_in">list</span> + s + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>]]></content>
      <categories>
        <category>CTFé¢˜è§£</category>
      </categories>
  </entry>
  <entry>
    <title>buuctf Miscç®€å•é¢˜è®°å½•</title>
    <url>/2022/11/10/Misc/</url>
    <content><![CDATA[<ul>
<li>é—²æ¥æ— äº‹å†™buuctf-Miscçš„é¢˜ç›®æ±‡æ€»<!-- less -->
<HR width="100%"  color="#FF7F00"></li>
</ul>
<h2 id="é‡‘ä¸‰èƒ–"><a href="#é‡‘ä¸‰èƒ–" class="headerlink" title="é‡‘ä¸‰èƒ–"></a>é‡‘ä¸‰èƒ–</h2><ul>
<li>gifframeæ•æ‰å¸§</li>
</ul>
<h2 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h2><ul>
<li>binwalkæ£€æµ‹å‡ºéšè—zip</li>
<li>foremoståˆ†ç¦»zip</li>
<li>azprç ´è§£zipå¯†ç å¾—åˆ°flag</li>
</ul>
<h2 id="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"><a href="#ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°" class="headerlink" title="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"></a>ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°</h2><ul>
<li>winhexæŸ¥çœ‹ï¼Œæœ«å°¾å­˜flag</li>
</ul>
<h2 id="ä¹Œé•‡å³°ä¼šç§å›¾"><a href="#ä¹Œé•‡å³°ä¼šç§å›¾" class="headerlink" title="ä¹Œé•‡å³°ä¼šç§å›¾"></a>ä¹Œé•‡å³°ä¼šç§å›¾</h2><ul>
<li>åŒä¸Š</li>
</ul>
<h2 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h2><ul>
<li>å›¾ç‰‡é«˜åº¦éšè—ï¼Œwinhexä¿®æ”¹å›¾ç‰‡é«˜åº¦å³å¯</li>
</ul>
<h2 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h2><ul>
<li><p>å‡çš„exeæ–‡ä»¶ï¼Œ010æ‰“å¼€å‘ç°æ˜¯ä¸ªbase64ï¼Œç½‘ç«™åœ¨çº¿è§£ç è¾“å‡ºä¸ºpngï¼Œæ˜¯ä¸ªäºŒç»´ç ï¼Œæ‰«ç å¾—flag</p>
</li>
<li><p>ç›´æ¥å°†åŸå­—ç¬¦ä½œä¸ºurlè·å¾—äºŒç»´ç </p>
</li>
<li><pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;png&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;img src=&quot;data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len+9bs+PIndt5ywT3dp71mfOTXafku6f/2uD09i9y0n7NNd2nvWZ06Ntt+S7l+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/6cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/31rectP0Wu2/5Lun+9bs+PMnu/XZvfctJ22+x+5bvku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+5l3+tK935vApyd+8y5/29c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/3VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+5RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+2tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/9tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+5M1G+1o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+0xppM32HpfWTIxPbMzeNtJmS3Zyw/7RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+5SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/8Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
</ul>
<h2 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h2><ul>
<li>azprç ´è§£zipå¯†ç </li>
</ul>
<h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><ul>
<li><p>wiresharkæ•è·postè¯·æ±‚å³å¯</p>
<blockquote>
<p>http.request.method&#x3D;&#x3D;POST</p>
</blockquote>
</li>
</ul>
<h2 id="æ–‡ä»¶ä¸­çš„ç§˜å¯†"><a href="#æ–‡ä»¶ä¸­çš„ç§˜å¯†" class="headerlink" title="æ–‡ä»¶ä¸­çš„ç§˜å¯†"></a>æ–‡ä»¶ä¸­çš„ç§˜å¯†</h2><ul>
<li>å³é”®å±æ€§å³å¯</li>
</ul>
<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><ul>
<li>Stegsolveå‘ç°æœ€ä¸Šæ–¹éšå†™</li>
<li>è¾“å‡ºä¸ºpngäºŒç»´ç </li>
</ul>]]></content>
      <categories>
        <category>CTFé¢˜è§£</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoå¸¸è§ç¼–ç ç‰¹å¾è¯†åˆ«</title>
    <url>/2022/11/10/Crypto/</url>
    <content><![CDATA[<ul>
<li>ç§¯ç´¯è¯¡å¼‚ç¼–ç ä»¥åŠå¸¸ç”¨ç½‘ç«™<blockquote>
<p>è¯¥æ–‡ç« ä»…ç”¨äºç ”ç©¶å­¦ä¹ ï¼Œç½‘ç«™ä¾µåˆ </p>
</blockquote>
<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">
## Baseå®¶æ—

<h4 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h4><ul>
<li>16è¿›åˆ¶ï¼ŒåªåŒ…å«ï¼ˆ[0-9], [A-F]ï¼‰</li>
</ul>
<h4 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h4><ul>
<li>ï¼ˆ[A-Z],[2-7]ï¼‰,ä¸€èˆ¬æ¥è®²å¯†æ–‡å­—æ¯å¤šäºæ•°å­—ï¼Œè€Œä¸”æœ«å°¾æœ‰å¤šä¸ªç­‰å·</li>
</ul>
<h4 id="base58"><a href="#base58" class="headerlink" title="base58"></a>base58</h4><ul>
<li>ç»“å°¾æ— ç­‰å·</li>
</ul>
<h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><ul>
<li><p>ï¼ˆ[A-Z],[a-z],[0-9]ï¼‰ï¼Œæœ«å°¾æœ‰1åˆ°2ä¸ªç­‰å·</p>
</li>
<li><p>8ä½å˜6ä½é‡ç»„</p>
</li>
</ul>
<h4 id="base85"><a href="#base85" class="headerlink" title="base85"></a>base85</h4><ul>
<li>ç­‰å·å¯èƒ½å‡ºç°åœ¨å¯†æ–‡ä¸­é—´</li>
</ul>
<h4 id="base91"><a href="#base91" class="headerlink" title="base91"></a>base91</h4><ul>
<li>ï¼ˆ[0-9]ï¼Œ[a-z]ï¼Œ[A-Z],[!#$%&amp;()*+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}~â€]ï¼‰</li>
</ul>
<h4 id="base100"><a href="#base100" class="headerlink" title="base100"></a>base100</h4><ul>
<li>å¯†æ–‡ä¸ºemjio</li>
</ul>
<h2 id="å¹‚æ•°åŠ å¯†"><a href="#å¹‚æ•°åŠ å¯†" class="headerlink" title="å¹‚æ•°åŠ å¯†"></a>å¹‚æ•°åŠ å¯†</h2><h3 id="åŠ å¯†æ–¹æ³•"><a href="#åŠ å¯†æ–¹æ³•" class="headerlink" title="åŠ å¯†æ–¹æ³•"></a>åŠ å¯†æ–¹æ³•</h3><ul>
<li>ç”±äºæ¯ä¸€ä¸ªæ•°éƒ½å¯ä»¥å˜æˆå½¢å¼ä¸ºâ€2<sup>a</sup>+2<sup>b</sup>+2<sup>c</sup>â€¦.â€çš„è¡¨è¾¾å¼<br>æ‰€ä»¥æˆ‘ä»¬ç”¨å¯¹åº”â€abcâ€¦â€æ•°å­—ä¸²æ¥ä»£è¡¨è¿™ä¸ªæ•°</li>
<li>ä¾‹å¦‚<br>5 &#x3D; 2<sup>0</sup>+2<sup>2</sup>ï¼Œå³å¯è¡¨ç¤ºä¸º02<br>19 &#x3D; 2<sup>0</sup>+2<sup>1</sup>+2<sup>4</sup>ï¼Œå³014</li>
</ul>
<h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>8842101220480224404014224202480122</p>
</blockquote>
<ul>
<li>æ˜¯8ä½å¤§å†™å­—æ¯</li>
<li>é‡‡ç”¨å¹‚æ•°åŠ å¯†</li>
</ul>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><ul>
<li><p>è”æƒ³8ä½å­—æ¯å’Œ8ä¸ª0çš„å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹<font color="#f18583">ä»¥0ä¸ºåˆ†éš”ç¬¦</font><br>æ‹†åˆ†åå¯ä»¥å¾—åˆ°ï¼š</p>
<blockquote>
<p>88421 122 48 2244 4 142242 248 122</p>
</blockquote>
</li>
<li><p>è§‚å¯Ÿå‘ç°æ¯ä¸ªæ•°å­—éƒ½æ˜¯2çš„å€æ•°ï¼Œæ¨æ–­å•ä¸ªæ•°å­—è¡¨ç¤ºçš„å°±æ˜¯â€2<sup>a</sup>â€œï¼Œæ‰€ä»¥å°†æ¯ä¸€æ®µæ•°å­—ç›´æ¥æ±‚å’Œ</p>
</li>
<li><p>ä¸Šè„šæœ¬ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">	string s = <span class="string">&quot;88421 122 48 2244 4 142242 248 122 &quot;</span>; </span><br><span class="line">	int <span class="built_in">sum</span> = 0;</span><br><span class="line">	<span class="keyword">for</span>(int i = 0; i &lt; s.length(); i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i] == <span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">			cout &lt;&lt;<span class="string">char(sum+&#x27;A&#x27;-1);</span></span><br><span class="line"><span class="string">			sum = 0;</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		else&#123;</span></span><br><span class="line"><span class="string">			sum += (s[i]-&#x27;0&#x27;);</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	return 0;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

</li>
<li><p>å¾—åˆ°flagï¼š</p>
<blockquote>
<p>cyberpace{WELLDONE}</p>
</blockquote>
</li>
</ul>
<h2 id="çŒªåœˆå¯†ç "><a href="#çŒªåœˆå¯†ç " class="headerlink" title="çŒªåœˆå¯†ç "></a>çŒªåœˆå¯†ç </h2><ul>
<li><p>ç‰¹å¾ï¼š</p>
<p><img src="https://s2.loli.net/2022/11/10/NcQI8HopdEwVzy9.jpg" alt="Crypto_Pig.jpg"></p>
</li>
<li><p>è§£å¯†ç½‘ç«™ï¼š</p>
<ul>
<li><a href="https://xiao84.com/tools/103177.html">çŒªåœˆå¯†ç -åœ¨çº¿è§£å¯†åŠ å¯†å·¥å…· (xiao84.com)</a></li>
</ul>
</li>
</ul>
<h2 id="emjio-AES"><a href="#emjio-AES" class="headerlink" title="emjio-AES"></a>emjio-AES</h2><ul>
<li>åŠ å¯†è¿‡ç¨‹å°±æ˜¯å°†ä¸€æ®µå­—ç¬¦ä¸²ç”¨keyå’Œrotationè¿›è¡ŒAESåŠ å¯†ï¼Œç„¶åå°†è¾“å‡ºçš„base64ç ç”¨è¡¨æƒ…åŒ…æ›¿æ¢ï¼Œç‰¹å¾åªèƒ½é çŒœå’Œhintäº†</li>
<li>è§£å¯†ç½‘ç«™ï¼š<ul>
<li><a href="https://aghorler.github.io/emoji-aes/">emoji-aes (aghorler.github.io)</a></li>
</ul>
</li>
<li>æ¶‰åŠé¢˜ç›®<ul>
<li>ISCTF2022 å¯çˆ±çš„emjio</li>
</ul>
</li>
</ul>
<h2 id="ä½›æ›°åŠ å¯†"><a href="#ä½›æ›°åŠ å¯†" class="headerlink" title="ä½›æ›°åŠ å¯†"></a>ä½›æ›°åŠ å¯†</h2><ul>
<li>ç‰¹å¾ï¼šâ€œè«¸éš¸æ¯˜åƒ§é™æ¯˜å½è«¸é™€æ¯˜æ‘©æ¯˜éš¸åƒ§æ¯˜ç¼½è–©æ¯˜é¡˜å¿ƒæ¯˜å©†æ¯˜åš´å½Œæ¯˜å¿µæ¯˜å¦‚æ¯˜å›‘æ¯˜â€  ä¸€å †å¤æ€ªæ–‡å­—</li>
<li>è§£å¯†ç½‘ç«™ï¼š<ul>
<li><a href="http://hi.pcmoe.net/Buddha.html">æ–°çº¦ä½›è®ºç¦…&#x2F;ä½›æ›°åŠ å¯† - PcMoe!</a></li>
</ul>
</li>
</ul>
<h2 id="å¤©å¹²åœ°æ”¯åŠ å¯†"><a href="#å¤©å¹²åœ°æ”¯åŠ å¯†" class="headerlink" title="å¤©å¹²åœ°æ”¯åŠ å¯†"></a>å¤©å¹²åœ°æ”¯åŠ å¯†</h2><ul>
<li>ç‰¹å¾ï¼šåˆ©ç”¨çºªå¹´æ³•å¯¹åº”åŠ å¯†æ•°å­—</li>
<li>è§£å¯†ï¼šæŸ¥è¡¨</li>
<li>æ¶‰åŠé¢˜ç›®ï¼š<ul>
<li>[MRCTF]å¤©å¹²åœ°æ”¯+ç”²å­</li>
</ul>
</li>
</ul>
<h2 id="ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†"><a href="#ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†" class="headerlink" title="ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†"></a>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†</h2><ul>
<li>ç‰¹å¾ï¼šé¡¾åæ€ä¹‰</li>
<li>è§£å¯†ç½‘ç«™ï¼š<ul>
<li><a href="http://www.atoolbox.net/Tool.php?Id=850">ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†&#x2F;è§£å¯† - ä¸€ä¸ªå·¥å…·ç®± - å¥½ç”¨çš„åœ¨çº¿å·¥å…·éƒ½åœ¨è¿™é‡Œï¼ (atoolbox.net)</a></li>
</ul>
</li>
</ul>
<h2 id="jsfuckç¼–ç "><a href="#jsfuckç¼–ç " class="headerlink" title="jsfuckç¼–ç "></a>jsfuckç¼–ç </h2><ul>
<li><p>ç‰¹å¾ï¼šç”±()+ []! å…­ä¸ªå­—ç¬¦ç»„æˆç¼–ç </p>
</li>
<li><p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="literal">false</span>	==&gt;	![]</span><br><span class="line"><span class="literal">true</span>	=&gt;	!![]</span><br><span class="line">undefined	=&gt;	[][[]]</span><br><span class="line">NaN	=&gt;	+[![]]</span><br><span class="line">0	=&gt;	+[]</span><br><span class="line">1	=&gt;	+!+[]</span><br><span class="line">2	=&gt;	!+[]+!+[]</span><br><span class="line">10	=&gt;	[+!+[]]+[+[]]</span><br><span class="line">Array	=&gt;	[]</span><br><span class="line">Number	=&gt;	+[]</span><br><span class="line">String	=&gt;	[]+[]</span><br><span class="line">Boolean	=&gt;	![]</span><br><span class="line">Function	=&gt;	[][<span class="string">&quot;filter&quot;</span>]</span><br><span class="line"><span class="built_in">eval</span>	=&gt;	[][<span class="string">&quot;filter&quot;</span>][<span class="string">&quot;constructor&quot;</span>]( CODE )()</span><br><span class="line">window	=&gt;	[][<span class="string">&quot;filter&quot;</span>][<span class="string">&quot;constructor&quot;</span>](<span class="string">&quot;return this&quot;</span>)()</span><br></pre></td></tr></table></figure>

</li>
<li><p>è§£å¯†ç½‘ç«™ï¼š</p>
<ul>
<li><a href="https://www.bugku.com/tools/jsfuck">https://www.bugku.com/tools/jsfuck</a></li>
<li><a href="https://www.dejs.vip/encry_decry/jsfuck.html">jsfuckåŠ å¯†&#x2F;è§£å¯† - dejs.vip</a></li>
</ul>
</li>
<li><p>æ¶‰åŠé¢˜ç›®ï¼š</p>
<ul>
<li>buuctf - è¿™æ˜¯ä»€ä¹ˆ</li>
</ul>
</li>
</ul>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>RoarCTF2019 polyre</title>
    <url>/2022/11/08/Solve2/</url>
    <content><![CDATA[<ul>
<li>å»å¹³å¦åŒ–é—®é¢˜<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="è§£é¢˜æµç¨‹"><a href="#è§£é¢˜æµç¨‹" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h2><ol>
<li>æŸ¥å£³IDA</li>
<li>è„šæœ¬å»å¹³å¦åŒ–</li>
<li>IDAè„šæœ¬å»æ··æ·†</li>
<li>CRC32è¯†åˆ«</li>
<li>è§£å¯†è„šæœ¬</li>
</ol>
<h2 id="è„šæœ¬é›†"><a href="#è„šæœ¬é›†" class="headerlink" title="è„šæœ¬é›†"></a>è„šæœ¬é›†</h2><ul>
<li><p>å»å¹³å¦åŒ–è„šæœ¬</p>
<ul>
<li><p>å‘½ä»¤ï¼š</p>
<blockquote>
<p>python deflat.py attachment 0x400620</p>
</blockquote>
</li>
<li><p>deflat</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> pyvex</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&#x27;C:\\Users\\du\\Desktop\\CTFTools\\Flat\\am_graph&#x27;</span>)  <span class="comment">## am_graphè·¯å¾„</span></span><br><span class="line"><span class="keyword">import</span> am_graph</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.getLogger(<span class="string">&#x27;angr.state_plugins.symbolic_memory&#x27;</span>).setLevel(logging.ERROR)</span><br><span class="line"><span class="comment"># logging.getLogger(&#x27;angr.sim_manager&#x27;).setLevel(logging.DEBUG)</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_relevant_nop_nodes</span>(<span class="params">supergraph</span>):</span><br><span class="line">    <span class="keyword">global</span> pre_dispatcher_node, prologue_node, retn_node</span><br><span class="line">    <span class="comment"># relevant_nodes = list(supergraph.predecessors(pre_dispatcher_node))</span></span><br><span class="line">    relevant_nodes = []</span><br><span class="line">    nop_nodes = []</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="keyword">if</span> supergraph.has_edge(node, pre_dispatcher_node) <span class="keyword">and</span> node.size &gt; <span class="number">8</span>:</span><br><span class="line">            <span class="comment"># <span class="doctag">XXX:</span> use node.size is faster than to create a block </span></span><br><span class="line">            relevant_nodes.append(node)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> node.addr <span class="keyword">in</span> ( prologue_node.addr, retn_node.addr, pre_dispatcher_node.addr):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        nop_nodes.append(node)</span><br><span class="line">    <span class="keyword">return</span> relevant_nodes, nop_nodes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">symbolic_execution</span>(<span class="params">start_addr, hook_addr=<span class="literal">None</span>, modify=<span class="literal">None</span>, inspect=<span class="literal">False</span></span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">retn_procedure</span>(<span class="params">state</span>):</span><br><span class="line">        <span class="keyword">global</span> project</span><br><span class="line">        ip = state.se.<span class="built_in">eval</span>(state.regs.ip)</span><br><span class="line">        project.unhook(ip)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">statement_inspect</span>(<span class="params">state</span>):</span><br><span class="line">        <span class="keyword">global</span> modify_value</span><br><span class="line">        expressions = <span class="built_in">list</span>(state.scratch.irsb.statements[state.inspect.statement].expressions)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(expressions) != <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">isinstance</span>(expressions[<span class="number">0</span>], pyvex.expr.ITE):</span><br><span class="line">            state.scratch.temps[expressions[<span class="number">0</span>].cond.tmp] = modify_value</span><br><span class="line">            state.inspect._breakpoints[<span class="string">&#x27;statement&#x27;</span>] = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> project, relevant_block_addrs, modify_value</span><br><span class="line">    <span class="keyword">if</span> hook_addr != <span class="literal">None</span>:</span><br><span class="line">        project.hook(hook_addr, retn_procedure, length=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">if</span> modify != <span class="literal">None</span>:</span><br><span class="line">        modify_value = modify</span><br><span class="line">    state = project.factory.blank_state(addr=start_addr, remove_options=&#123;angr.sim_options.LAZY_SOLVES&#125;)</span><br><span class="line">    <span class="keyword">if</span> inspect:</span><br><span class="line">        state.inspect.b(<span class="string">&#x27;statement&#x27;</span>, when=angr.state_plugins.inspect.BP_BEFORE, action=statement_inspect)</span><br><span class="line">    sm = project.factory.simulation_manager(state)</span><br><span class="line">    sm.step()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(sm.active) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> active_state <span class="keyword">in</span> sm.active:</span><br><span class="line">            <span class="keyword">if</span> active_state.addr <span class="keyword">in</span> relevant_block_addrs:</span><br><span class="line">                <span class="keyword">return</span> active_state.addr</span><br><span class="line">        sm.step()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill_nop</span>(<span class="params">data, start_addr, length</span>):</span><br><span class="line">    <span class="keyword">global</span> opcode</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length):</span><br><span class="line">        data[start_addr + i] = <span class="built_in">ord</span>(opcode[<span class="string">&#x27;nop&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill_jmp_offset</span>(<span class="params">data, start, offset</span>):</span><br><span class="line">    jmp_offset = struct.pack(<span class="string">&#x27;&lt;i&#x27;</span>, offset)  <span class="comment"># bytes</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        data[start + i] = jmp_offset[i]</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">patch_byte</span>(<span class="params">data, offset, value</span>):</span><br><span class="line">    <span class="comment"># operate on bytearray, not str</span></span><br><span class="line">    data[offset] = <span class="built_in">ord</span>(value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Usage: python deflat.py filename function_address(hex)&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    opcode = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;\x87&#x27;</span>, <span class="string">&#x27;ae&#x27;</span>: <span class="string">&#x27;\x83&#x27;</span>, <span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;be&#x27;</span>:<span class="string">&#x27;\x86&#x27;</span>, <span class="string">&#x27;c&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;e&#x27;</span>:<span class="string">&#x27;\x84&#x27;</span>, <span class="string">&#x27;z&#x27;</span>:<span class="string">&#x27;\x84&#x27;</span>, <span class="string">&#x27;g&#x27;</span>:<span class="string">&#x27;\x8F&#x27;</span>, </span><br><span class="line">              <span class="string">&#x27;ge&#x27;</span>:<span class="string">&#x27;\x8D&#x27;</span>, <span class="string">&#x27;l&#x27;</span>:<span class="string">&#x27;\x8C&#x27;</span>, <span class="string">&#x27;le&#x27;</span>:<span class="string">&#x27;\x8E&#x27;</span>, <span class="string">&#x27;na&#x27;</span>:<span class="string">&#x27;\x86&#x27;</span>, <span class="string">&#x27;nae&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;nb&#x27;</span>:<span class="string">&#x27;\x83&#x27;</span>, <span class="string">&#x27;nbe&#x27;</span>:<span class="string">&#x27;\x87&#x27;</span>, <span class="string">&#x27;nc&#x27;</span>:<span class="string">&#x27;\x83&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;ne&#x27;</span>:<span class="string">&#x27;\x85&#x27;</span>, <span class="string">&#x27;ng&#x27;</span>:<span class="string">&#x27;\x8E&#x27;</span>, <span class="string">&#x27;nge&#x27;</span>:<span class="string">&#x27;\x8C&#x27;</span>, <span class="string">&#x27;nl&#x27;</span>:<span class="string">&#x27;\x8D&#x27;</span>, <span class="string">&#x27;nle&#x27;</span>:<span class="string">&#x27;\x8F&#x27;</span>, <span class="string">&#x27;no&#x27;</span>:<span class="string">&#x27;\x81&#x27;</span>, <span class="string">&#x27;np&#x27;</span>:<span class="string">&#x27;\x8B&#x27;</span>, <span class="string">&#x27;ns&#x27;</span>:<span class="string">&#x27;\x89&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;nz&#x27;</span>:<span class="string">&#x27;\x85&#x27;</span>, <span class="string">&#x27;o&#x27;</span>:<span class="string">&#x27;\x80&#x27;</span>, <span class="string">&#x27;p&#x27;</span>:<span class="string">&#x27;\x8A&#x27;</span>, <span class="string">&#x27;pe&#x27;</span>:<span class="string">&#x27;\x8A&#x27;</span>, <span class="string">&#x27;po&#x27;</span>:<span class="string">&#x27;\x8B&#x27;</span>, <span class="string">&#x27;s&#x27;</span>:<span class="string">&#x27;\x88&#x27;</span>, <span class="string">&#x27;nop&#x27;</span>:<span class="string">&#x27;\x90&#x27;</span>, <span class="string">&#x27;jmp&#x27;</span>:<span class="string">&#x27;\xE9&#x27;</span>, <span class="string">&#x27;j&#x27;</span>:<span class="string">&#x27;\x0F&#x27;</span>&#125;</span><br><span class="line">    </span><br><span class="line">    filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">    start = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    project = angr.Project(filename, load_options=&#123;<span class="string">&#x27;auto_load_libs&#x27;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">    cfg = project.analyses.CFGFast(normalize=<span class="literal">True</span>)  <span class="comment"># do normalize to avoid overlapping blocks</span></span><br><span class="line">    target_function = cfg.functions.get(start)</span><br><span class="line">    <span class="comment"># A super transition graph is a graph that looks like IDA Pro&#x27;s CFG</span></span><br><span class="line">    supergraph = am_graph.to_supergraph(target_function.transition_graph)</span><br><span class="line"></span><br><span class="line">    base_addr = project.loader.main_object.mapped_base &gt;&gt; <span class="number">12</span> &lt;&lt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get prologue_node and retn_node</span></span><br><span class="line">    prologue_node = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="keyword">if</span> supergraph.in_degree(node) == <span class="number">0</span>:</span><br><span class="line">            prologue_node = node</span><br><span class="line">        <span class="keyword">if</span> supergraph.out_degree(node) == <span class="number">0</span>:</span><br><span class="line">            retn_node = node</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> prologue_node <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> prologue_node.addr != start:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Something must be wrong...&quot;</span>)</span><br><span class="line">        sys.exit(-<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    main_dispatcher_node = <span class="built_in">list</span>(supergraph.successors(prologue_node))[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.predecessors(main_dispatcher_node):</span><br><span class="line">        <span class="keyword">if</span> node.addr != prologue_node.addr:</span><br><span class="line">            pre_dispatcher_node = node</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    relevant_nodes, nop_nodes = get_relevant_nop_nodes(supergraph)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************relevant blocks************************&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;prologue: %#x&#x27;</span> % start)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;main_dispatcher: %#x&#x27;</span> % main_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;pre_dispatcher: %#x&#x27;</span> % pre_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;retn: %#x&#x27;</span> % retn_node.addr)</span><br><span class="line">    relevant_block_addrs = [node.addr <span class="keyword">for</span> node <span class="keyword">in</span> relevant_nodes]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;relevant_blocks:&#x27;</span>, [<span class="built_in">hex</span>(addr) <span class="keyword">for</span> addr <span class="keyword">in</span> relevant_block_addrs])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************symbolic execution*********************&#x27;</span>)</span><br><span class="line">    relevants = relevant_nodes</span><br><span class="line">    relevants.append(prologue_node)</span><br><span class="line">    relevants_without_retn = <span class="built_in">list</span>(relevants)</span><br><span class="line">    relevants.append(retn_node)</span><br><span class="line">    relevant_block_addrs.extend([prologue_node.addr, retn_node.addr])</span><br><span class="line"></span><br><span class="line">    flow = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    modify_value = <span class="literal">None</span></span><br><span class="line">    patch_instrs = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> relevant <span class="keyword">in</span> relevants_without_retn:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;-------------------dse %#x---------------------&#x27;</span> % relevant.addr)</span><br><span class="line">        block = project.factory.block(relevant.addr, size=relevant.size)</span><br><span class="line">        has_branches = <span class="literal">False</span></span><br><span class="line">        hook_addr = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> ins <span class="keyword">in</span> block.capstone.insns:</span><br><span class="line">            <span class="keyword">if</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;cmov&#x27;</span>):</span><br><span class="line">                patch_instrs[relevant] = ins</span><br><span class="line">                has_branches = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;call&#x27;</span>):</span><br><span class="line">                hook_addr = ins.insn.address</span><br><span class="line">        <span class="keyword">if</span> has_branches:</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr, claripy.BVV(<span class="number">1</span>, <span class="number">1</span>), <span class="literal">True</span>))</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr, claripy.BVV(<span class="number">0</span>, <span class="number">1</span>), <span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr))</span><br><span class="line">            </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************flow******************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % k.addr, [<span class="built_in">hex</span>(child) <span class="keyword">for</span> child <span class="keyword">in</span> v])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># print retn_node flow. Actually, it&#x27;s [].</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % retn_node.addr, [])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************patch*****************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> origin:</span><br><span class="line">        <span class="comment"># Attention: can&#x27;t transform to str by calling decode() directly. so use bytearray instead.</span></span><br><span class="line">        origin_data = <span class="built_in">bytearray</span>(origin.read())</span><br><span class="line">        origin_data_len = <span class="built_in">len</span>(origin_data)</span><br><span class="line"></span><br><span class="line">    recovery_file = filename + <span class="string">&#x27;_recovered&#x27;</span></span><br><span class="line">    recovery = <span class="built_in">open</span>(recovery_file, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># patch irrelevant blocks</span></span><br><span class="line">    <span class="keyword">for</span> nop_node <span class="keyword">in</span> nop_nodes:</span><br><span class="line">        fill_nop(origin_data, nop_node.addr - base_addr, nop_node.size)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># remove unnecessary control flows</span></span><br><span class="line">    <span class="keyword">for</span> parent, childs <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(childs) == <span class="number">1</span>:</span><br><span class="line">            parent_block = project.factory.block(parent.addr, size=parent.size)</span><br><span class="line">            last_instr = parent_block.capstone.insns[-<span class="number">1</span>]</span><br><span class="line">            file_offset = last_instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch the last jmp instruction</span></span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;jmp&#x27;</span>])</span><br><span class="line">            file_offset += <span class="number">1</span></span><br><span class="line">            fill_nop(origin_data, file_offset, last_instr.size - <span class="number">1</span>)</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset, childs[<span class="number">0</span>] - last_instr.address - <span class="number">5</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            instr = patch_instrs[parent]</span><br><span class="line">            file_offset = instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch instructions starting from `cmovx` to the end of block</span></span><br><span class="line">            fill_nop(origin_data, file_offset, parent.addr + parent.size - base_addr - file_offset)</span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;j&#x27;</span>])</span><br><span class="line">            patch_byte(origin_data, file_offset + <span class="number">1</span>, opcode[instr.mnemonic[<span class="number">4</span>:]])</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset + <span class="number">2</span>, childs[<span class="number">0</span>] - instr.address - <span class="number">6</span>)</span><br><span class="line">            file_offset += <span class="number">6</span></span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;jmp&#x27;</span>])</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset + <span class="number">1</span>, childs[<span class="number">1</span>] - (instr.address + <span class="number">6</span>) - <span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(origin_data) == origin_data_len, <span class="string">&quot;Error: size of data changed!!!&quot;</span></span><br><span class="line">    recovery.write(origin_data)</span><br><span class="line">    recovery.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Successful! The recovered file: %s&#x27;</span> % recovery_file)</span><br></pre></td></tr></table></figure>
</li>
<li><p>am_graph</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> networkx</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> angr.knowledge_plugins <span class="keyword">import</span> Function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">grouper</span>(<span class="params">iterable, n, fillvalue=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;Collect data into fixed-length chunks or blocks&quot;</span></span><br><span class="line">    args = [<span class="built_in">iter</span>(iterable)] * n</span><br><span class="line">    <span class="keyword">return</span> itertools.izip_longest(*args, fillvalue=fillvalue)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_supergraph</span>(<span class="params">transition_graph</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Convert transition graph of a function to a super transition graph. A super transition graph is a graph that looks</span></span><br><span class="line"><span class="string">    like IDA Pro&#x27;s CFG, where calls to returning functions do not terminate basic blocks.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param networkx.DiGraph transition_graph: The transition graph.</span></span><br><span class="line"><span class="string">    :return: A converted super transition graph</span></span><br><span class="line"><span class="string">    :rtype networkx.DiGraph</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># make a copy of the graph</span></span><br><span class="line">    transition_graph = networkx.DiGraph(transition_graph)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># remove all edges that transitions to outside</span></span><br><span class="line">    <span class="keyword">for</span> src, dst, data <span class="keyword">in</span> <span class="built_in">list</span>(transition_graph.edges(data=<span class="literal">True</span>)):</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>) <span class="keyword">and</span> data.get(<span class="string">&#x27;outside&#x27;</span>, <span class="literal">False</span>) <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">            transition_graph.remove_edge(src, dst)</span><br><span class="line">        <span class="keyword">if</span> transition_graph.in_degree(dst) == <span class="number">0</span>:</span><br><span class="line">            transition_graph.remove_node(dst)</span><br><span class="line"></span><br><span class="line">    edges_to_shrink = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Find all edges to remove in the super graph</span></span><br><span class="line">    <span class="keyword">for</span> src <span class="keyword">in</span> transition_graph.nodes():</span><br><span class="line">        edges = transition_graph[src]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># there are two types of edges we want to remove:</span></span><br><span class="line">        <span class="comment"># - call or fakerets, since we do not want blocks to break at calls</span></span><br><span class="line">        <span class="comment"># - boring jumps that directly transfer the control to the block immediately after the current block. this is</span></span><br><span class="line">        <span class="comment">#   usually caused by how VEX breaks down basic blocks, which happens very often in MIPS</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(edges) == <span class="number">1</span> <span class="keyword">and</span> src.addr + src.size == <span class="built_in">next</span>(<span class="built_in">iter</span>(edges.keys())).addr:</span><br><span class="line">            dst = <span class="built_in">next</span>(<span class="built_in">iter</span>(edges.keys()))</span><br><span class="line">            dst_in_edges = transition_graph.in_edges(dst)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(dst_in_edges) == <span class="number">1</span>:</span><br><span class="line">                edges_to_shrink.add((src, dst))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(<span class="built_in">iter</span>(<span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">&#x27;fake_return&#x27;</span>, <span class="string">&#x27;call&#x27;</span>) <span class="keyword">for</span> data <span class="keyword">in</span> edges.values())):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dst, data <span class="keyword">in</span> edges.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(dst, Function):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;fake_return&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">all</span>(<span class="built_in">iter</span>(<span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;fake_return&#x27;</span>, <span class="string">&#x27;return_from_call&#x27;</span>)</span><br><span class="line">                            <span class="keyword">for</span> _, _, data <span class="keyword">in</span> transition_graph.in_edges(dst, data=<span class="literal">True</span>))):</span><br><span class="line">                    edges_to_shrink.add((src, dst))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create the super graph</span></span><br><span class="line">    super_graph = networkx.DiGraph()</span><br><span class="line"></span><br><span class="line">    supernodes_map = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    function_nodes = <span class="built_in">set</span>()  <span class="comment"># it will be traversed after all other nodes are added into the supergraph</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> transition_graph.nodes():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(node, Function):</span><br><span class="line">            function_nodes.add(node)</span><br><span class="line">            <span class="comment"># don&#x27;t put functions into the supergraph</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        dests_and_data = transition_graph[node]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># make a super node</span></span><br><span class="line">        <span class="keyword">if</span> node <span class="keyword">in</span> supernodes_map:</span><br><span class="line">            src_supernode = supernodes_map[node]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            src_supernode = SuperCFGNode.from_cfgnode(node)</span><br><span class="line">            supernodes_map[node] = src_supernode</span><br><span class="line">            <span class="comment"># insert it into the graph</span></span><br><span class="line">            super_graph.add_node(src_supernode)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> dests_and_data:</span><br><span class="line">            <span class="comment"># might be an isolated node</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Take src_supernode off the graph since we might modify it</span></span><br><span class="line">        <span class="keyword">if</span> src_supernode <span class="keyword">in</span> super_graph:</span><br><span class="line">            existing_in_edges = <span class="built_in">list</span>(super_graph.in_edges(src_supernode, data=<span class="literal">True</span>))</span><br><span class="line">            existing_out_edges = <span class="built_in">list</span>(super_graph.out_edges(src_supernode, data=<span class="literal">True</span>))</span><br><span class="line">            super_graph.remove_node(src_supernode)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            existing_in_edges = [ ]</span><br><span class="line">            existing_out_edges = [ ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dst, data <span class="keyword">in</span> dests_and_data.items():</span><br><span class="line"></span><br><span class="line">            edge = (node, dst)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> edge <span class="keyword">in</span> edges_to_shrink:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> dst <span class="keyword">in</span> supernodes_map:</span><br><span class="line">                    dst_supernode = supernodes_map[dst]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dst_supernode = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">                src_supernode.insert_cfgnode(dst)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># update supernodes map</span></span><br><span class="line">                supernodes_map[dst] = src_supernode</span><br><span class="line"></span><br><span class="line">                <span class="comment"># merge the other supernode</span></span><br><span class="line">                <span class="keyword">if</span> dst_supernode <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    src_supernode.merge(dst_supernode)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> src <span class="keyword">in</span> dst_supernode.cfg_nodes:</span><br><span class="line">                        supernodes_map[src] = src_supernode</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># link all out edges of dst_supernode to src_supernode</span></span><br><span class="line">                    <span class="keyword">for</span> dst_, data_ <span class="keyword">in</span> super_graph[dst_supernode].items():</span><br><span class="line">                        super_graph.add_edge(src_supernode, dst_, **data_)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># link all in edges of dst_supernode to src_supernode</span></span><br><span class="line">                    <span class="keyword">for</span> src_, _, data_ <span class="keyword">in</span> super_graph.in_edges(dst_supernode, data=<span class="literal">True</span>):</span><br><span class="line">                        super_graph.add_edge(src_, src_supernode, **data_)</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data_ <span class="keyword">and</span> data_[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>):</span><br><span class="line">                            <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data_ <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data_):</span><br><span class="line">                                <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                                <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                                <span class="keyword">continue</span></span><br><span class="line">                            src_supernode.register_out_branch(data_[<span class="string">&#x27;ins_addr&#x27;</span>], data_[<span class="string">&#x27;stmt_idx&#x27;</span>], data_[<span class="string">&#x27;type&#x27;</span>],</span><br><span class="line">                                                              dst_supernode.addr</span><br><span class="line">                                                              )</span><br><span class="line"></span><br><span class="line">                    super_graph.remove_node(dst_supernode)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(dst, Function):</span><br><span class="line">                    <span class="comment"># skip all functions</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># make a super node</span></span><br><span class="line">                <span class="keyword">if</span> dst <span class="keyword">in</span> supernodes_map:</span><br><span class="line">                    dst_supernode = supernodes_map[dst]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dst_supernode = SuperCFGNode.from_cfgnode(dst)</span><br><span class="line">                    supernodes_map[dst] = dst_supernode</span><br><span class="line"></span><br><span class="line">                super_graph.add_edge(src_supernode, dst_supernode, **data)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>):</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data):</span><br><span class="line">                        <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                        <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    src_supernode.register_out_branch(data[<span class="string">&#x27;ins_addr&#x27;</span>], data[<span class="string">&#x27;stmt_idx&#x27;</span>], data[<span class="string">&#x27;type&#x27;</span>],</span><br><span class="line">                                                      dst_supernode.addr</span><br><span class="line">                                                      )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># add back the node (in case there are no edges)</span></span><br><span class="line">        super_graph.add_node(src_supernode)</span><br><span class="line">        <span class="comment"># add back the old edges</span></span><br><span class="line">        <span class="keyword">for</span> src, _, data <span class="keyword">in</span> existing_in_edges:</span><br><span class="line">            super_graph.add_edge(src, src_supernode, **data)</span><br><span class="line">        <span class="keyword">for</span> _, dst, data <span class="keyword">in</span> existing_out_edges:</span><br><span class="line">            super_graph.add_edge(src_supernode, dst, **data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> function_nodes:</span><br><span class="line">        in_edges = transition_graph.in_edges(node, data=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> src, _, data <span class="keyword">in</span> in_edges:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data):</span><br><span class="line">                <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            supernode = supernodes_map[src]</span><br><span class="line">            supernode.register_out_branch(data[<span class="string">&#x27;ins_addr&#x27;</span>], data[<span class="string">&#x27;stmt_idx&#x27;</span>], data[<span class="string">&#x27;type&#x27;</span>], node.addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> super_graph</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OutBranch</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, ins_addr, stmt_idx, branch_type</span>):</span><br><span class="line">        self.ins_addr = ins_addr</span><br><span class="line">        self.stmt_idx = stmt_idx</span><br><span class="line">        self.<span class="built_in">type</span> = branch_type</span><br><span class="line"></span><br><span class="line">        self.targets = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.ins_addr <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;OutBranch at None, type %s&gt;&quot;</span> % self.<span class="built_in">type</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;OutBranch at %#x, type %s&gt;&quot;</span> % (self.ins_addr, self.<span class="built_in">type</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_target</span>(<span class="params">self, addr</span>):</span><br><span class="line">        self.targets.add(addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Merge with the other OutBranch descriptor.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param OutBranch other: The other item to merge with.</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> self.ins_addr == other.ins_addr</span><br><span class="line">        <span class="keyword">assert</span> self.<span class="built_in">type</span> == other.<span class="built_in">type</span></span><br><span class="line"></span><br><span class="line">        o = self.copy()</span><br><span class="line">        o.targets |= other.targets</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">copy</span>(<span class="params">self</span>):</span><br><span class="line">        o = OutBranch(self.ins_addr, self.stmt_idx, self.<span class="built_in">type</span>)</span><br><span class="line">        o.targets = self.targets.copy()</span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(other, OutBranch):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.ins_addr == other.ins_addr <span class="keyword">and</span> \</span><br><span class="line">               self.stmt_idx == other.stmt_idx <span class="keyword">and</span> \</span><br><span class="line">               self.<span class="built_in">type</span> == other.<span class="built_in">type</span> <span class="keyword">and</span> \</span><br><span class="line">               self.targets == other.targets</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>((self.ins_addr, self.stmt_idx, self.<span class="built_in">type</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SuperCFGNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, addr</span>):</span><br><span class="line">        self.addr = addr</span><br><span class="line"></span><br><span class="line">        self.cfg_nodes = [ ]</span><br><span class="line"></span><br><span class="line">        self.out_branches = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">size</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(node.size <span class="keyword">for</span> node <span class="keyword">in</span> self.cfg_nodes)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">from_cfgnode</span>(<span class="params">cls, cfg_node</span>):</span><br><span class="line">        s = cls(cfg_node.addr)</span><br><span class="line"></span><br><span class="line">        s.cfg_nodes.append(cfg_node)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert_cfgnode</span>(<span class="params">self, cfg_node</span>):</span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span> Make it binary search/insertion</span></span><br><span class="line">        <span class="keyword">for</span> i, n <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.cfg_nodes):</span><br><span class="line">            <span class="keyword">if</span> cfg_node.addr &lt; n.addr:</span><br><span class="line">                <span class="comment"># insert before n</span></span><br><span class="line">                self.cfg_nodes.insert(i, cfg_node)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> cfg_node.addr == n.addr:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cfg_nodes.append(cfg_node)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># update addr</span></span><br><span class="line">        self.addr = self.cfg_nodes[<span class="number">0</span>].addr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">register_out_branch</span>(<span class="params">self, ins_addr, stmt_idx, branch_type, target_addr</span>):</span><br><span class="line">        <span class="keyword">if</span> ins_addr <span class="keyword">not</span> <span class="keyword">in</span> self.out_branches <span class="keyword">or</span> stmt_idx <span class="keyword">not</span> <span class="keyword">in</span> self.out_branches[ins_addr]:</span><br><span class="line">            self.out_branches[ins_addr][stmt_idx] = OutBranch(ins_addr, stmt_idx, branch_type)</span><br><span class="line"></span><br><span class="line">        self.out_branches[ins_addr][stmt_idx].add_target(target_addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Merge another supernode into the current one.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param SuperCFGNode other: The supernode to merge with.</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> other.cfg_nodes:</span><br><span class="line">            self.insert_cfgnode(n)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ins_addr, outs <span class="keyword">in</span> other.out_branches.items():</span><br><span class="line">            <span class="keyword">if</span> ins_addr <span class="keyword">in</span> self.out_branches:</span><br><span class="line">                <span class="keyword">for</span> stmt_idx, item <span class="keyword">in</span> outs.items():</span><br><span class="line">                    <span class="keyword">if</span> stmt_idx <span class="keyword">in</span> self.out_branches[ins_addr]:</span><br><span class="line">                        self.out_branches[ins_addr][stmt_idx].merge(item)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        self.out_branches[ins_addr][stmt_idx] = item</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = <span class="built_in">next</span>(<span class="built_in">iter</span>(outs.values()))</span><br><span class="line">                self.out_branches[ins_addr][item.stmt_idx] = item</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;SuperCFGNode %#08x, %d blocks, %d out branches&gt;&quot;</span> % (self.addr, <span class="built_in">len</span>(self.cfg_nodes),</span><br><span class="line">                                                                     <span class="built_in">len</span>(self.out_branches)</span><br><span class="line">                                                                     )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>((<span class="string">&#x27;supercfgnode&#x27;</span>, self.addr))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(other, SuperCFGNode):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.addr == other.addr</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å»æ··æ·†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">st = <span class="number">0x0000000000400620</span> </span><br><span class="line">end = <span class="number">0x0000000000402144</span> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_instr</span>(<span class="params">addr</span>):</span><br><span class="line">    <span class="keyword">return</span> addr+idc.get_item_size(addr)		<span class="comment">#è·å–æŒ‡ä»¤æˆ–æ•°æ®é•¿åº¦ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯å»å¾€ä¸‹ä¸€æ¡æŒ‡ä»¤</span></span><br><span class="line">    </span><br><span class="line">addr = st</span><br><span class="line"><span class="keyword">while</span>(addr&lt;end):</span><br><span class="line">    <span class="built_in">next</span> = next_instr(addr)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ds:dword_603054&quot;</span> <span class="keyword">in</span> GetDisasm(addr):	<span class="comment">#GetDisasm(addr)å¾—åˆ°addrçš„åæ±‡ç¼–è¯­å¥</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">            addr = <span class="built_in">next</span></span><br><span class="line">            <span class="built_in">next</span> = next_instr(addr)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;jnz&quot;</span> <span class="keyword">in</span> GetDisasm(addr):</span><br><span class="line">                dest = idc.get_operand_value(addr, <span class="number">0</span>)		<span class="comment">#å¾—åˆ°æ“ä½œæ•°ï¼Œå°±æ˜¯æŒ‡ä»¤åçš„æ•°</span></span><br><span class="line">                ida_bytes.patch_byte(addr, <span class="number">0xe9</span>)     <span class="comment">#0xe9 jmpåé¢çš„å››ä¸ªå­—èŠ‚æ˜¯åç§»</span></span><br><span class="line">                ida_bytes.patch_byte(addr+<span class="number">5</span>, <span class="number">0x90</span>)   <span class="comment">#nopç¬¬äº”ä¸ªå­—èŠ‚</span></span><br><span class="line">                offset = dest - (addr + <span class="number">5</span>)  <span class="comment">#è°ƒæ•´ä¸ºæ­£ç¡®çš„åç§»åœ°å€ ä¹Ÿå°±æ˜¯ç›¸å¯¹åç§»åœ°å€ - å½“å‰æŒ‡ä»¤åçš„åœ°å€</span></span><br><span class="line">                ida_bytes.patch_dword(addr + <span class="number">1</span>, offset) <span class="comment">#æŠŠåœ°å€èµ‹å€¼ç»™jmpå</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;patch bcf: 0x%x&quot;</span>%addr)</span><br><span class="line">                addr = <span class="built_in">next</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        addr = <span class="built_in">next</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">secret = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>,</span><br><span class="line">          <span class="number">0x342B90AFD853F450</span>, <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>]</span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># äº§ç”ŸCRC32æŸ¥è¡¨æ³•æ‰€ç”¨çš„è¡¨</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> secret:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        sign = s &amp; <span class="number">1</span>                   <span class="comment">#åˆ¤æ–­é¦–ä½æ­£è´Ÿ</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s ^= key</span><br><span class="line">        s //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s |= <span class="number">0x8000000000000000</span>    <span class="comment"># é˜²æ­¢è´Ÿå€¼é™¤2ï¼Œæº¢å‡ºä¸ºæ­£å€¼</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(s))                      <span class="comment"># è¾“å‡ºè¡¨</span></span><br><span class="line">    <span class="comment"># è®¡ç®—CRC64</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(s&amp;<span class="number">0xFF</span>)</span><br><span class="line">        s &gt;&gt;= <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></li>
</ul>]]></content>
      <categories>
        <category>CTFé¢˜è§£</category>
      </categories>
  </entry>
  <entry>
    <title>ã€Šc++åæ±‡ç¼–ä¸é€†å‘åˆ†ææŠ€æœ¯æ­ç§˜ã€‹é€Ÿè®°1</title>
    <url>/2022/11/05/fast_sum1/</url>
    <content><![CDATA[<ul>
<li>æ•°æ®ç±»å‹<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="åŸºæœ¬ç±»å‹è¡¨ç¤º"><a href="#åŸºæœ¬ç±»å‹è¡¨ç¤º" class="headerlink" title="åŸºæœ¬ç±»å‹è¡¨ç¤º"></a>åŸºæœ¬ç±»å‹è¡¨ç¤º</h2><ul>
<li><p>æ— ç¬¦å·æ•´æ•°ï¼šå…¨éƒ¨å­—èŠ‚è¡¨ç¤ºæ•°å­—ï¼Œåªæœ‰æ­£æ•°</p>
</li>
<li><p>æœ‰ç¬¦å·æ•´æ•°ï¼šæœ€é«˜ä½è¡¨ç¤ºæ­£è´Ÿ</p>
</li>
<li><p>è´Ÿæ•°è¡¨ç¤º</p>
<ul>
<li><p>è¡¥ç ï¼ˆ0å‡å»è¯¥æ•°çš„ç»å¯¹å€¼ï¼‰å­˜æ”¾ï¼Œè¡¥ç  &#x3D; åç  + 1ï¼Œè¿›ä½ä¸¢å¤±</p>
</li>
<li><p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">--&gt; -<span class="number">3</span></span><br><span class="line">--&gt; <span class="number">0</span>å‡å»è¯¥æ•°çš„ç»å¯¹å€¼</span><br><span class="line">----&gt; <span class="number">0xFFFFFFFD</span> + <span class="number">3</span> = <span class="number">0</span>ï¼Œæœ€é«˜ä½æº¢å‡º &gt;&gt; <span class="number">0xFFFFFFFD</span>è¡¨ç¤º-<span class="number">3</span></span><br><span class="line">--&gt; è¡¥ç  = åç  + <span class="number">1</span></span><br><span class="line">----&gt; <span class="built_in">bin</span>(<span class="number">3</span>):<span class="number">11</span></span><br><span class="line">----&gt; <span class="built_in">bin</span>(<span class="number">3</span>)åç :<span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1111</span> <span class="number">1100</span></span><br><span class="line">----&gt; <span class="built_in">hex</span>(åç +<span class="number">1</span>):<span class="number">0xFFFFFFFD</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>æµ®ç‚¹æ•°</p>
<ul>
<li>å®šç‚¹å®æ•°å­˜å‚¨ï¼šæå‰çº¦å®šæ•´æ•°å’Œå°æ•°é•¿åº¦ï¼Œè¿›è¡Œå­˜æ”¾</li>
<li>æµ®ç‚¹å®æ•°å­˜å‚¨ï¼šå¼€è¾Ÿä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†å­˜æŒ‡æ•°åŸŸï¼ˆå°æ•°ç‚¹ä½ç½®ï¼‰ï¼Œä¸€éƒ¨åˆ†å­˜æ•°å€¼å¤§å°ï¼ˆæ— å°æ•°ç‚¹çš„æ•´æ•°ï¼‰</li>
<li>ç¼–ç æ–¹å¼ï¼ˆç¬¦å·ä½-æŒ‡æ•°åŸŸ-å°¾æ•°åŸŸï¼‰<ul>
<li>floatï¼ˆsize4ï¼Œ32ä½ï¼‰ï¼š1-8-23</li>
<li>doubleï¼ˆsize8ï¼Œ64ä½ï¼‰ï¼š1-11-52</li>
<li>å› ä¸ºæŒ‡æ•°åŸŸå¯èƒ½ä¸ºè´Ÿæ•°ï¼Œæ‰€ä»¥åœ¨æŒ‡æ•°å­˜æ”¾æ—¶ + 0xfï¼ˆ 127ï¼Œ1023ï¼‰ï¼Œåˆ¤åˆ«æ­£è´Ÿ</li>
</ul>
</li>
</ul>
</li>
<li><p>å­—ç¬¦ä¸²</p>
<ul>
<li>ç¼–ç æ–¹å¼ï¼šunicodeï¼ŒASCIIÂ·Â·Â·</li>
<li>å­˜å‚¨<ul>
<li>çº¿æ€§å­˜å‚¨ï¼Œéœ€è¦ç¡®å®šé¦–å°¾åœ°å€</li>
<li>å°¾åœ°å€ç¡®å®šï¼š<ol>
<li>å¼€è¾Ÿä¸€éƒ¨åˆ†ç©ºé—´å­˜æ”¾é•¿åº¦lenï¼Œé¦–åœ°å€+lenç¡®å®š</li>
<li>åˆ©ç”¨ç»“æŸç¬¦ç›´æ¥ç¡®å®š</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="mainå‡½æ•°ï¼ˆè¯­æ³•è§„å®šç”¨æˆ·å…¥å£ï¼‰ç‰¹ç‚¹"><a href="#mainå‡½æ•°ï¼ˆè¯­æ³•è§„å®šç”¨æˆ·å…¥å£ï¼‰ç‰¹ç‚¹" class="headerlink" title="mainå‡½æ•°ï¼ˆè¯­æ³•è§„å®šç”¨æˆ·å…¥å£ï¼‰ç‰¹ç‚¹"></a>mainå‡½æ•°ï¼ˆè¯­æ³•è§„å®šç”¨æˆ·å…¥å£ï¼‰ç‰¹ç‚¹</h2><blockquote>
<p>int __cdecl main(int argc, const char **argv, const char **envp)</p>
</blockquote>
<ul>
<li>mainå‡½æ•°å¯åŠ¨å‡½æ•°ä¸­å”¯ä¸€ä¸€ä¸ª3å‚æ•°å‡½æ•°ï¼šå‘½ä»¤è¡Œå‚æ•°ä¸ªæ•°ã€å‘½ä»¤è¡Œå‚æ•°ä¿¡æ¯ã€ç¯å¢ƒå˜é‡ä¿¡æ¯ã€‚</li>
<li>WinMainæ˜¯å”¯ä¸€ä¸€ä¸ª4å‚æ•°å‡½æ•°</li>
<li>è¿”å›è¦è°ƒç”¨exit()å‡½æ•°</li>
</ul>
<h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:0000000000401387           loc_401387:          </span><br><span class="line">.text:0000000000401387           mov     qword ptr [rax], 0</span><br><span class="line">.text:000000000040138E           mov     cs:argv, rbp</span><br><span class="line">.text:0000000000401395           call    __main</span><br><span class="line">.text:0000000000401395</span><br><span class="line">.text:000000000040139A           mov     rax, cs:_refptr___imp___initenv</span><br><span class="line">.text:00000000004013A1           mov     rdx, cs:envp</span><br><span class="line">.text:00000000004013A8           mov     ecx, cs:argc           ; argc</span><br><span class="line">.text:00000000004013AE           mov     rax, [rax]</span><br><span class="line">.text:00000000004013B1           mov     [rax], rdx</span><br><span class="line">.text:00000000004013B4           mov     r8, cs:envp            ; envp</span><br><span class="line">.text:00000000004013BB           mov     rdx, cs:argv           ; argv</span><br><span class="line">.text:00000000004013C2           call    main</span><br><span class="line">.text:00000000004013C2</span><br><span class="line">.text:00000000004013C7           mov     ecx, cs:managedapp</span><br><span class="line">.text:00000000004013CD           mov     cs:mainret, eax</span><br><span class="line">.text:00000000004013D3           test    ecx, ecx</span><br><span class="line">.text:00000000004013D5           jz      loc_40149E</span><br><span class="line">.text:00000000004013D5</span><br><span class="line">.text:00000000004013DB           mov     edx, cs:has_cctor</span><br><span class="line">.text:00000000004013E1           test    edx, edx</span><br><span class="line">.text:00000000004013E3           jnz     short loc_4013F0</span><br><span class="line">.text:00000000004013E3</span><br><span class="line">.text:00000000004013E5           call    _cexit                ;è¿”å›è°ƒç”¨exit()å‡½æ•°</span><br></pre></td></tr></table></figure>

<h2 id="è¡¨è¾¾å¼æ±‚å€¼"><a href="#è¡¨è¾¾å¼æ±‚å€¼" class="headerlink" title="è¡¨è¾¾å¼æ±‚å€¼"></a>è¡¨è¾¾å¼æ±‚å€¼</h2><ul>
<li>æ— æ•ˆè¯­å¥ï¼Œä¾‹å¦‚2+3ï¼›ç¼–è¯‘æ—¶è‡ªåŠ¨å‰”é™¤ï¼Œä¸è¿›è¡Œå¤„ç†</li>
</ul>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>è§£é¢˜1</title>
    <url>/2022/10/16/Solve1/</url>
    <content><![CDATA[<ul>
<li>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker</li>
<li>[SWPU2019]EasiestRe </li>
<li>[WMCTF2020]easy_re <code>prelå¤„ç†</code></li>
<li>[BJDCTF2020]hamburger competition   <code>unityé€†å‘</code><!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="2022-x2F-11-x2F-09æ›´æ–°"><a href="#2022-x2F-11-x2F-09æ›´æ–°" class="headerlink" title="2022&#x2F;11&#x2F;09æ›´æ–°"></a>2022&#x2F;11&#x2F;09æ›´æ–°</h2><p>å†™ä¸€ä¸‹ä¸€äº›å¥‡è‘©é¢˜ä¸»ä½“æ€è·¯ï¼Œä¸é…å›¾ï¼Œä¸é€‚åˆæ–°æ‰‹è§‚çœ‹</p>
<h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-jocker"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-jocker" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker</h2><ol>
<li>exeæ–‡ä»¶ï¼Œ32ä½æ— å£³ï¼Œæ‹–å…¥IDA32</li>
<li>ctrl+f12å®šä½ä¸»ä½“å‡½æ•°ï¼Œä¿®æ”¹å˜é‡åæé«˜å¯è¯»æ€§</li>
<li>F5åæ±‡ç¼–å‘ç°æç¤ºæ ˆé”™è¯¯ï¼Œoptionè°ƒå‡ºæ ˆæŒ‡é’ˆï¼Œä¿®æ”¹æ ˆæŒ‡é’ˆä¸º0ï¼Œé‡æ–°F5</li>
<li>æŸ¥çœ‹è¾“å…¥ï¼Œ24ä½å­—ç¬¦ä¸²ï¼Œä¸»ä½“ï¼šå¤åˆ¶-&gt;åŠ å¯†-&gt;æ ¡å¯¹-&gt;encyptå‡½æ•°-&gt;finalå‡½æ•°</li>
<li>å‘ç°wrongå‡½æ•°åŠ å¯†ï¼Œomgå‡½æ•°æ ¡å¯¹ï¼Œç®€å•å¼‚æˆ–è§£å¯†ï¼Œæäº¤é”™è¯¯ï¼Œä¸ºéšœçœ¼æ³•ï¼ˆä½†æ˜¯å¾—åˆ°äº†æ­£ç¡®çš„è¾“å…¥å­—ç¬¦ä¸²ï¼‰</li>
<li>wrongå‡½æ•°ä¸Šæ–¹å¯¹è¾“å…¥çš„flagè¿›è¡Œäº†å¤åˆ¶ï¼ŒçœŸæ­£å¤„ç†çš„æ˜¯å¤åˆ¶åçš„flag</li>
<li>æ‰¾åˆ°ç›¸åº”çš„åŠ å¯†å‡½æ•°encyptï¼Œç»“æœæ˜¯åŠ¨æ€åŠ å¯†å‡½æ•°ï¼Œæ— æ³•ç›´æ¥F5</li>
<li>exeæ‹–å…¥ODï¼Œæ‰¾åˆ°è°ƒç”¨åŠ å¯†å‡½æ•°åœ°å€ï¼Œä¸‹æ–­ç‚¹ï¼Œè¾“å…¥æ­£ç¡®å­—ç¬¦ä¸²è¿è¡Œ</li>
<li>F7å•æ­¥è¿›å…¥åŠ å¯†å‡½æ•°ï¼ŒODdumpè„±å£³ï¼Œç”Ÿæˆæ–°æ–‡ä»¶</li>
<li>æ–°æ–‡ä»¶æ‹–å…¥IDAï¼ŒæŸ¥çœ‹encyptå‡½æ•°ï¼Œå¼‚æˆ–è§£å¯†å¾—åˆ°å‰19ä½flag</li>
<li>è¿˜å‰©æœ€å5ä½ï¼Œåªå‰©finalå‡½æ•°ï¼ŒæœªçŸ¥åŠ å¯†ï¼Œæç¤ºæ˜¯éšè—ï¼Œæ¨æ–­å’Œä¹‹å‰åŠ å¯†æ–¹å¼ç›¸åŒï¼Œä¸ºå¼‚æˆ–åŠ å¯†</li>
<li>åˆ©ç”¨æœ€åä¸€ä½â€}â€æ¨æ–­å‡ºå¼‚æˆ–keyï¼Œè¿›è¡Œè§£å¯†å¾—åˆ°æ­£ç¡®flag</li>
</ol>
<blockquote>
<p>æ ¸å¿ƒï¼šä¿®æ”¹ç”±äºåç»­åŠ¨æ€åŠ å¯†é€ æˆçš„æ ˆæŒ‡é’ˆé”™ä½ï¼Œè§£å¯†æ­£ç¡®è¾“å…¥ï¼ŒODåŠ¨æ€åŠ å¯†è„±å£³</p>
</blockquote>
<h2 id="SWPU2019-EasiestRe"><a href="#SWPU2019-EasiestRe" class="headerlink" title="[SWPU2019]EasiestRe"></a>[SWPU2019]EasiestRe</h2><ol>
<li>æ‹–å…¥exeinfopeï¼Œ32ä½æ— å£³ï¼Œè¿›IDA</li>
<li>ctrl+fæ‰¾åˆ°mainå‡½æ•°å‘ç°GetThreadContextã€SetThreadContextç­‰ç­‰å‡½æ•°ï¼Œå¤šçº¿ç¨‹æ²¡è·‘äº†ï¼Œå…ˆæ”¾ä¸€è¾¹</li>
<li>ctrl+f12å­—ç¬¦ä¸²æŸ¥æ‰¾flagæ‰¾åˆ°ä¸»ä½“å‡½æ•°(äº¤å‰å¼•ç”¨)ï¼Œä¿®æ”¹å˜é‡åæé«˜å¯è¯»æ€§</li>
<li>F5åç¼–å‘ç°__debugbreak()ï¼Œint3æ–­ç‚¹ï¼Œå¯ä»¥å‡†å¤‡æ”¹äºŒè¿›åˆ¶äº†ï¼Œç»§ç»­æŸ¥çœ‹è¿˜ä¸æ­¢ä¸€ä¸ª</li>
<li>é‡æ–°çœ‹çº¿ç¨‹ï¼Œæ˜¯ä¸ªçˆ¶å­çº¿ç¨‹ä¿æŠ¤ï¼Œå­çº¿ç¨‹åŠ å¯†ï¼ŒæŸ¥çœ‹å‡½æ•°æ•è·é‡è¦é•¿æ•°ç»„v16ã€v15</li>
<li>æ‰€ä»¥åˆæ˜¯åŠ¨æ€åŠ å¯†ï¼Œè¿”å›__debugbreak()å¤„tabçœ‹æ±‡ç¼–ï¼Œint3+nopçš„é•¿åº¦å’Œv16å¯¹çš„ä¸Šï¼Œé‚£å°±æŠŠv16æ¬è¿‡å»ï¼Œæ”¹äºŒè¿›åˆ¶ï¼Œé‡æ–°åç¼–</li>
<li>è§‚å¯Ÿä¸»ä½“å‡½æ•°ï¼šè¾“å…¥-&gt;åŠ å¯†-&gt;check-&gt;è¾“å‡º</li>
<li>è¿›å…¥åŠ å¯†ï¼Œåˆæœ‰__debugbreak()ï¼Œå’Œä¸Šé¢ä¸€æ ·çš„æ–¹å¼ï¼Œç”¨v15æ”¹äºŒè¿›åˆ¶ç ï¼Œåç¼–</li>
<li>è¿›å…¥checkå‡½æ•°ï¼ŒtabæŸ¥çœ‹æ±‡ç¼–ï¼Œ408638åœ°å€å¤„å‘ç°â€œcmp [ebp+var_20], 18hâ€æ ¡å¯¹æŒ‡ä»¤</li>
<li>æŸ¥çœ‹å¯¹åº”åœ°å€ï¼Œæ‰¾åˆ°æ ¡å¯¹å­—ç¬¦ä¸²ï¼ˆå³åŠ å¯†ç»“æœï¼‰</li>
<li>è¿”å›åŠ å¯†å‡½æ•°ï¼Œåˆ†æï¼Œä¸‰æ¬¡åŠ å¯†(å¼‚æˆ–â€“&gt;åˆ†æ®µâ€“&gt;ç§»ä½)</li>
<li>é€†å†™è§£å¯†</li>
</ol>
<p>æ ¸å¿ƒï¼šåŒçº¿ç¨‹ä¿æŠ¤ç³»ç»Ÿï¼Œint3æ–­ç‚¹(0xcc)ï¼ŒäºŒè¿›åˆ¶ä¿®æ”¹</p>
<h2 id="WMCTF2020-easy-re"><a href="#WMCTF2020-easy-re" class="headerlink" title="[WMCTF2020]easy_re"></a>[WMCTF2020]easy_re</h2><ul>
<li>perlå¤„ç†ï¼šä¸€ç§è§£é‡Šè¯­è¨€ï¼Œè¿è¡Œæ—¶è§£å‹ï¼ŒåŠ¨è°ƒå¤„ç†<ul>
<li>æœç´¢scriptå…³é”®è¯ï¼Œæ‰¾åˆ°perlè„šæœ¬è°ƒç”¨å¤„</li>
<li>å†å…³é”®ç‚¹ä¸‹é¢è®¾æ–­ç‚¹ï¼ŒF8è¿è¡Œåˆ°è„šæœ¬æ‰§è¡Œå®Œæ¯•</li>
<li>ä¸‹ä¸€ä¸ªeaxä¸­å¯è§åŸæ–‡</li>
</ul>
</li>
</ul>
<h2 id="BJDCTF2020-hamburger-competition"><a href="#BJDCTF2020-hamburger-competition" class="headerlink" title="[BJDCTF2020]hamburger competition"></a>[BJDCTF2020]hamburger competition</h2><ul>
<li><p>ä¸€ä¸ªunityæ¸¸æˆé€†å‘é—®é¢˜</p>
</li>
<li><p>å·¥å…·ï¼šdnspy</p>
</li>
<li><p>æ ¸å¿ƒä»£ç ä¸€èˆ¬è·¯å¾„ï¼š</p>
<blockquote>
<p>\TPH\TPH_Data\Managed\Assembly-CSharp.dll</p>
</blockquote>
</li>
</ul>]]></content>
      <categories>
        <category>CTFé¢˜è§£</category>
      </categories>
  </entry>
  <entry>
    <title>ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹æ€»ç»“3</title>
    <url>/2022/10/08/Summary3/</url>
    <content><![CDATA[<ul>
<li>DLLæ–‡ä»¶</li>
<li>èŠ‚åŒºåˆ é™¤<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="DLLæ–‡ä»¶"><a href="#DLLæ–‡ä»¶" class="headerlink" title="DLLæ–‡ä»¶"></a>DLLæ–‡ä»¶</h2><ul>
<li>ï¼ˆDynamic Link Libraryï¼‰åŠ¨æ€é“¾æ¥åº“</li>
<li>ç›®çš„ï¼šè§£å†³åœ¨å¤šè¿›ç¨‹æ—¶ä¸€ä¸ªç³»ç»ŸAPIå¯èƒ½ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œå¤šæ¬¡åŠ è½½åˆ°å†…å­˜é€ æˆç©ºé—´æµªè´¹çš„é—®é¢˜</li>
<li>æè¿°ï¼š<ul>
<li>åº“å°è£…ï¼Œå•ç‹¬ç»„æˆDLLæ–‡ä»¶</li>
<li>å†…å­˜æ˜ å°„æŠ€æœ¯ï¼Œå®ç°å¤šè¿›ç¨‹å…±äº«åŒä¸€ä¸ªæ–‡ä»¶</li>
<li>æ›´æ–°åº“æ—¶æ›¿æ¢å¯¹åº”DLLæ–‡ä»¶</li>
</ul>
</li>
<li>åŠ è½½æ–¹å¼ï¼š<ul>
<li>æ˜¾å¼é“¾æ¥ï¼šä½¿ç”¨æ—¶åŠ è½½ï¼Œç”¨å®Œåé‡Šæ”¾å†…å­˜</li>
<li>éšå¼é“¾æ¥ï¼šåŠ è½½ç¨‹åºæ—¶å°†DLLå…¨éƒ¨åŠ è½½ï¼Œç¨‹åºç»ˆæ­¢åé‡Šæ”¾å†…å­˜</li>
</ul>
</li>
</ul>
<h2 id="èŠ‚åŒºåˆ é™¤"><a href="#èŠ‚åŒºåˆ é™¤" class="headerlink" title="èŠ‚åŒºåˆ é™¤"></a>èŠ‚åŒºåˆ é™¤</h2><ol>
<li>åˆ é™¤èŠ‚åŒºå¤´ï¼ŒPEviewä¸­æŸ¥çœ‹èŠ‚åŒºå¤´èµ·å§‹åœ°å€åŠé•¿åº¦ï¼Œåœ¨hexç¼–è¾‘å™¨ä¸­å°†è¯¥åŒºåŸŸç”¨0è¦†ç›–</li>
<li>åˆ é™¤èŠ‚åŒºï¼ŒæŸ¥çœ‹èŠ‚åŒºèµ·å§‹åç§»åŠé•¿åº¦ï¼Œhexç¼–è¾‘å™¨ä¸­åˆ é™¤</li>
<li>ä¿®æ”¹IMAGE_FILE_HEADER[Number Of Sections -&#x3D; 1]</li>
<li>ä¿®æ”¹IMAGE_OPTIONAL_HEADER[Size Of Imageå‡å°‘å¯¹åº”é•¿åº¦]</li>
</ol>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹æ€»ç»“2</title>
    <url>/2022/10/06/Summary2/</url>
    <content><![CDATA[<ul>
<li>PEæ–‡ä»¶æ ¼å¼<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h1 id="PEæ–‡ä»¶æ ¼å¼"><a href="#PEæ–‡ä»¶æ ¼å¼" class="headerlink" title="PEæ–‡ä»¶æ ¼å¼"></a>PEæ–‡ä»¶æ ¼å¼</h1><h2 id="ç§ç±»"><a href="#ç§ç±»" class="headerlink" title="ç§ç±»"></a>ç§ç±»</h2><table>
<thead>
<tr>
<th>ç§ç±»</th>
<th>ä¸»æ‰©å±•å</th>
</tr>
</thead>
<tbody><tr>
<td>å¯æ‰§è¡Œç³»åˆ—</td>
<td>EXEï¼ŒSCR</td>
</tr>
<tr>
<td>åº“ç³»åˆ—</td>
<td>DLLï¼ŒOCXï¼ŒCPLï¼ŒDRV</td>
</tr>
<tr>
<td>é©±åŠ¨ç¨‹åºç³»åˆ—</td>
<td>SYSï¼ŒVXD</td>
</tr>
<tr>
<td>å¯¹è±¡æ–‡ä»¶ç³»åˆ—</td>
<td>OBJ</td>
</tr>
</tbody></table>
<h2 id="é›¶ç¢ç‚¹"><a href="#é›¶ç¢ç‚¹" class="headerlink" title="é›¶ç¢ç‚¹"></a>é›¶ç¢ç‚¹</h2><ol>
<li>PEæ–‡ä»¶åˆ†PEå¤´ä¸PEä½“</li>
<li>PEå¤´ç”±å„ç§ç»“æ„ä½“æ„æˆï¼Œè¯´æ˜äº†æ–‡ä»¶å¤§å°ã€æ‰§è¡Œåœ°å€ç­‰ç­‰ä¿¡æ¯ï¼ŒPEä½“åˆ†å¤šä¸ªèŠ‚åŒºï¼Œå¦‚ä»£ç æ®µã€æ•°æ®æ®µã€èµ„æºæ®µç­‰ã€‚</li>
<li>PEæ–‡ä»¶åœ¨å†…å­˜ä¸­å’Œåœ¨ç£ç›˜ä¸­å¤§å°ä¸åŒ</li>
<li>RVA(ç›¸å¯¹è™šæ‹Ÿåœ°å€)  VA(è™šæ‹Ÿå†…å­˜ç»å¯¹åœ°å€)  RAW(æ–‡ä»¶åç§»)</li>
</ol>
<h2 id="PEå¤´åˆ†è§£"><a href="#PEå¤´åˆ†è§£" class="headerlink" title="PEå¤´åˆ†è§£"></a>PEå¤´åˆ†è§£</h2><h3 id="DOSå¤´"><a href="#DOSå¤´" class="headerlink" title="DOSå¤´"></a>DOSå¤´</h3><p>æ ¸å¿ƒå‚æ•°ï¼š</p>
<ul>
<li>e_magic:DOSç­¾åï¼Œâ€œMZâ€ï¼ˆDOSå¯æ‰§è¡Œæ–‡ä»¶è®¾è®¡è€…ï¼‰</li>
<li>e_lfanew:æŒ‡ç¤ºNTå¤´çš„åç§»</li>
</ul>
<h3 id="DOSå­˜æ ¹"><a href="#DOSå­˜æ ¹" class="headerlink" title="DOSå­˜æ ¹"></a>DOSå­˜æ ¹</h3><p>ä¸€ä¸ªå¯å¿½ç•¥é¡¹ï¼Œå¯ç†è§£ä¸ºDOSä¸‹æ‰§è¡Œçš„æ•°æ®</p>
<blockquote>
<p>ä¾‹å¦‚notepad.exeä¸­çš„æç¤ºè¯­:This program cannot be run in DOS mode</p>
</blockquote>
<h3 id="NTå¤´"><a href="#NTå¤´" class="headerlink" title="NTå¤´"></a>NTå¤´</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_NT_HEADERS &#123;</span><br><span class="line">    DWORD Signature;                             //ç­¾åâ€œPEâ€</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;                //æ–‡ä»¶å¤´</span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;      //å¯é€‰å¤´</span><br><span class="line">&#125; IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure>
<h4 id="æ–‡ä»¶å¤´"><a href="#æ–‡ä»¶å¤´" class="headerlink" title="æ–‡ä»¶å¤´"></a>æ–‡ä»¶å¤´</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_FILE_HEADER &#123;</span><br><span class="line">    WORD    Machine;                  //æœºå™¨ç ï¼ˆæ¯ç§CPUéƒ½æœ‰å„è‡ªçš„å›ºå®šå€¼ï¼Œå¦‚intel x86çš„14Cï¼‰</span><br><span class="line">    WORD    NumberOfSections;         //èŠ‚åŒºæ•°é‡</span><br><span class="line">    DWORD   TimeDateStamp;</span><br><span class="line">    DWORD   PointerToSymbolTable;</span><br><span class="line">    DWORD   NumberOfSymbols;</span><br><span class="line">    WORD    SizeOfOptionalHeader;     //æŒ‡ç¤ºå¯é€‰å¤´çš„å¤§å°</span><br><span class="line">    WORD    Characteristics;          //æ ‡è¯†æ–‡ä»¶å±æ€§ï¼ˆæ˜¯å¦ä¸ºDLLç­‰ç­‰ï¼‰</span><br><span class="line">&#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER</span><br></pre></td></tr></table></figure>
<h4 id="å¯é€‰å¤´-ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†"><a href="#å¯é€‰å¤´-ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†" class="headerlink" title="å¯é€‰å¤´(ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†)"></a>å¯é€‰å¤´(ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†)</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_OPTIONAL_HEADER64 &#123;</span><br><span class="line">    WORD        Magic;                       //32-10Bï¼Œ 64-20B</span><br><span class="line">    BYTE        MajorLinkerVersion;          </span><br><span class="line">    BYTE        MinorLinkerVersion;</span><br><span class="line">    DWORD       SizeOfCode;</span><br><span class="line">    DWORD       SizeOfInitializedData;</span><br><span class="line">    DWORD       SizeOfUninitializedData;</span><br><span class="line">    DWORD       AddressOfEntryPoint;         //PEçš„RVAå€¼ï¼ŒæŒ‡å‡ºä»£ç èµ·å§‹ä½ç½®</span><br><span class="line">    DWORD       BaseOfCode;</span><br><span class="line">    ULONGLONG   ImageBase;                   //åŸºå‡†ï¼ŒVA = RVA + ImageBase</span><br><span class="line">    DWORD       SectionAlignment;            //èŠ‚åŒºå†…å­˜æœ€å°å•ä½</span><br><span class="line">    DWORD       FileAlignment;               //èŠ‚åŒºç£ç›˜æœ€å°å•ä½</span><br><span class="line">    WORD        MajorOperatingSystemVersion;</span><br><span class="line">    WORD        MinorOperatingSystemVersion;</span><br><span class="line">    WORD        MajorImageVersion;</span><br><span class="line">    WORD        MinorImageVersion;</span><br><span class="line">    WORD        MajorSubsystemVersion;</span><br><span class="line">    WORD        MinorSubsystemVersion;</span><br><span class="line">    DWORD       Win32VersionValue;</span><br><span class="line">    DWORD       SizeOfImage;                 //æŒ‡å®šåœ¨è™šæ‹Ÿå†…å­˜ä¸­æ‰€å ç©ºé—´å¤§å°</span><br><span class="line">    DWORD       SizeOfHeaders;               //PEå¤´å¤§å°ï¼ˆç¬¬ä¸€èŠ‚åŒºæ‰€åœ¨ä½ç½®ä¸è¯¥å€¼è·æ–‡ä»¶å¼€å§‹åç§»é‡ç›¸åŒï¼‰</span><br><span class="line">    DWORD       CheckSum;</span><br><span class="line">    WORD        Subsystem;                   //åŒºåˆ†æ–‡ä»¶</span><br><span class="line">                                              1 Driveræ–‡ä»¶ï¼ˆç³»ç»Ÿé©±åŠ¨ï¼‰</span><br><span class="line">                                              2 GUIæ–‡ä»¶ï¼ˆçª—å£åº”ç”¨ç¨‹åºï¼‰</span><br><span class="line">                                              3 CUIæ–‡ä»¶ï¼ˆæ§åˆ¶å°åº”ç”¨ç¨‹åºï¼‰</span><br><span class="line">    WORD        DllCharacteristics;</span><br><span class="line">    ULONGLONG   SizeOfStackReserve;</span><br><span class="line">    ULONGLONG   SizeOfStackCommit;</span><br><span class="line">    ULONGLONG   SizeOfHeapReserve;</span><br><span class="line">    ULONGLONG   SizeOfHeapCommit;</span><br><span class="line">    DWORD       LoaderFlags;</span><br><span class="line">    DWORD       NumberOfRvaAndSizes;         //</span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;</span><br></pre></td></tr></table></figure>
<h3 id="èŠ‚åŒºå¤´"><a href="#èŠ‚åŒºå¤´" class="headerlink" title="èŠ‚åŒºå¤´"></a>èŠ‚åŒºå¤´</h3><h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><table>
<thead>
<tr>
<th>ç±»åˆ«</th>
<th>è®¿é—®æƒé™</th>
</tr>
</thead>
<tbody><tr>
<td>code</td>
<td>æ‰§è¡Œï¼Œè¯»å–æƒé™</td>
</tr>
<tr>
<td>data</td>
<td>éæ‰§è¡Œï¼Œè¯»å†™æƒé™</td>
</tr>
<tr>
<td>resource</td>
<td>éæ‰§è¡Œï¼Œè¯»å–æƒé™</td>
</tr>
</tbody></table>
<h4 id="å†…å®¹"><a href="#å†…å®¹" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#define IMAGE_SIZEOF_SHORT_NAME              8</span></span><br><span class="line"></span><br><span class="line">typedef struct _IMAGE_SECTION_HEADER &#123;</span><br><span class="line">    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">    union &#123;</span><br><span class="line">            DWORD   PhysicalAddress;</span><br><span class="line">            DWORD   VirtualSize;            //å†…å­˜ä¸­èŠ‚åŒºå¤§å°</span><br><span class="line">    &#125; Misc;</span><br><span class="line">    DWORD   VirtualAddress;                 //å†…å­˜ä¸­èŠ‚åŒºèµ·å§‹åœ°å€ï¼ˆRVAï¼‰</span><br><span class="line">    DWORD   SizeOfRawData;                  //ç£ç›˜ä¸­èŠ‚åŒºå¤§å°</span><br><span class="line">    DWORD   PointerToRawData;               //ç£ç›˜ä¸­èŠ‚åŒºèµ·å§‹åœ°å€</span><br><span class="line">    DWORD   PointerToRelocations;</span><br><span class="line">    DWORD   PointerToLinenumbers;</span><br><span class="line">    WORD    NumberOfRelocations;</span><br><span class="line">    WORD    NumberOfLinenumbers;</span><br><span class="line">    DWORD   Characteristics;                //èŠ‚åŒºå±æ€§</span><br><span class="line">&#125; IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure>
<h2 id="è®¡ç®—"><a href="#è®¡ç®—" class="headerlink" title="è®¡ç®—"></a>è®¡ç®—</h2><ul>
<li>RAW &#x3D; RVA - (VA)VirtualAddress + PointerToRawData</li>
</ul>
<h1 id="é™„è¡¨ï¼š"><a href="#é™„è¡¨ï¼š" class="headerlink" title="é™„è¡¨ï¼š"></a>é™„è¡¨ï¼š</h1><h2 id="DataDirectoryç»“æ„ä½“æ•°ç»„-64-01239ä¸ºé‡ç‚¹"><a href="#DataDirectoryç»“æ„ä½“æ•°ç»„-64-01239ä¸ºé‡ç‚¹" class="headerlink" title="DataDirectoryç»“æ„ä½“æ•°ç»„(64)[01239ä¸ºé‡ç‚¹]"></a>DataDirectoryç»“æ„ä½“æ•°ç»„(64)[01239ä¸ºé‡ç‚¹]</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_EXPORT          0   // Export Directory</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_IMPORT          1   // Import Directory</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_RESOURCE        2   // Resource Directory</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   // Exception Directory</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_SECURITY        4   // Security Directory</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_BASERELOC       5   // Base Relocation Table</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_DEBUG           6   // Debug Directory</span></span><br><span class="line">        IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   // (X86 usage)</span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    7   // Architecture Specific Data</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_GLOBALPTR       8   // RVA of GP</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_TLS             9   // TLS Directory</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    10   // Load Configuration Directory</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   11   // Bound Import Directory in headers</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_IAT            12   // Import Address Table</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   13   // Delay Load Import Descriptors</span></span><br><span class="line"><span class="comment">#define IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 14   // COM Runtime descriptor</span></span><br></pre></td></tr></table></figure>
<h2 id="Machineå€¼"><a href="#Machineå€¼" class="headerlink" title="Machineå€¼"></a>Machineå€¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_UNKNOWN           0</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_I386              0x014c  // Intel 386.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_R3000             0x0162  // MIPS little-endian, 0x160 big-endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_R4000             0x0166  // MIPS little-endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_R10000            0x0168  // MIPS little-endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_WCEMIPSV2         0x0169  // MIPS little-endian WCE v2</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_ALPHA             0x0184  // Alpha_AXP</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_SH3               0x01a2  // SH3 little-endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_SH3DSP            0x01a3</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_SH3E              0x01a4  // SH3E little-endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_SH4               0x01a6  // SH4 little-endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_SH5               0x01a8  // SH5</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_ARM               0x01c0  // ARM Little-Endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_THUMB             0x01c2</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_AM33              0x01d3</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_POWERPC           0x01F0  // IBM PowerPC Little-Endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_POWERPCFP         0x01f1</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_IA64              0x0200  // Intel 64</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_MIPS16            0x0266  // MIPS</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_ALPHA64           0x0284  // ALPHA64</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_MIPSFPU           0x0366  // MIPS</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_MIPSFPU16         0x0466  // MIPS</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_AXP64             IMAGE_FILE_MACHINE_ALPHA64</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_TRICORE           0x0520  // Infineon</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_CEF               0x0CEF</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_EBC               0x0EBC  // EFI Byte Code</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_AMD64             0x8664  // AMD64 (K8)</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_M32R              0x9041  // M32R little-endian</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_MACHINE_CEE               0xC0EE</span></span><br></pre></td></tr></table></figure>
<h2 id="Characteristicså€¼"><a href="#Characteristicså€¼" class="headerlink" title="Characteristicså€¼"></a>Characteristicså€¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#define IMAGE_FILE_RELOCS_STRIPPED           0x0001  // Relocation info stripped from file.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_EXECUTABLE_IMAGE          0x0002  // File is executable  (i.e. no unresolved externel references).</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_LINE_NUMS_STRIPPED        0x0004  // Line nunbers stripped from file.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_LOCAL_SYMS_STRIPPED       0x0008  // Local symbols stripped from file.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_AGGRESIVE_WS_TRIM         0x0010  // Agressively trim working set</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_LARGE_ADDRESS_AWARE       0x0020  // App can handle &gt;2gb addresses</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_BYTES_REVERSED_LO         0x0080  // Bytes of machine word are reversed.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_32BIT_MACHINE             0x0100  // 32 bit word machine.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_DEBUG_STRIPPED            0x0200  // Debugging info stripped from file in .DBG file</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP   0x0400  // If Image is on removable media, copy and run from the swap file.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_NET_RUN_FROM_SWAP         0x0800  // If Image is on Net, copy and run from the swap file.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_SYSTEM                    0x1000  // System File.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_DLL                       0x2000  // File is a DLL.</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_UP_SYSTEM_ONLY            0x4000  // File should only be run on a UP machine</span></span><br><span class="line"><span class="comment">#define IMAGE_FILE_BYTES_REVERSED_HI         0x8000  // Bytes of machine word are reversed.</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹æ€»ç»“1</title>
    <url>/2022/10/05/Summary1/</url>
    <content><![CDATA[<ul>
<li>å¸¸è§å¯„å­˜å™¨</li>
<li>æ ˆå¸§</li>
<li>å‡½æ•°è°ƒç”¨çº¦å®š<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">


<h2 id="å¸¸è§å¯„å­˜å™¨"><a href="#å¸¸è§å¯„å­˜å™¨" class="headerlink" title="å¸¸è§å¯„å­˜å™¨"></a>å¸¸è§å¯„å­˜å™¨</h2><ul>
<li>é€šç”¨å¯„å­˜å™¨<ul>
<li>EAXï¼šï¼ˆé’ˆå¯¹æ“ä½œæ•°å’Œç»“æœæ•°æ®çš„ï¼‰ç´¯åŠ å™¨</li>
<li>EBXï¼šï¼ˆDSæ®µçš„æ•°æ®æŒ‡é’ˆï¼‰åŸºå€å¯„å­˜å™¨</li>
<li>ECXï¼šï¼ˆå­—ç¬¦ä¸²å’Œå¾ªç¯æ“ä½œçš„ï¼‰è®¡æ•°å™¨</li>
<li>EDXï¼šï¼ˆI&#x2F;OæŒ‡é’ˆï¼‰æ•°æ®å¯„å­˜å™¨</li>
<li>ESIï¼šï¼ˆå­—ç¬¦ä¸²æ“ä½œæºæŒ‡é’ˆï¼‰æºå˜å€å¯„å­˜å™¨</li>
<li>EDIï¼šï¼ˆå­—ç¬¦ä¸²æ“ä½œç›®æ ‡æŒ‡é’ˆï¼‰ç›®çš„å˜å€å¯„å­˜å™¨</li>
<li>EBPï¼šï¼ˆSSæ®µä¸­æ ˆå†…æ•°æ®æŒ‡é’ˆï¼‰æ‰©å±•åŸºå€æŒ‡é’ˆå¯„å­˜å™¨[æ ˆå¸§å¯„å­˜å™¨][æ ˆåº•æŒ‡é’ˆå¯„å­˜å™¨]</li>
<li>ESPï¼šï¼ˆSSæ®µä¸­æ ˆæŒ‡é’ˆï¼‰æ ˆæŒ‡é’ˆå¯„å­˜å™¨[æŒ‡å‘æ ˆé¡¶]</li>
</ul>
</li>
<li>æ®µå¯„å­˜å™¨<ul>
<li>CSï¼šä»£ç æ®µå¯„å­˜å™¨</li>
<li>SSï¼šæ ˆæ®µå¯„å­˜å™¨</li>
<li>DSï¼šæ•°æ®æ®µå¯„å­˜å™¨</li>
<li>FSï¼šæ•°æ®æ®µå¯„å­˜å™¨</li>
<li>ESï¼šé™„åŠ æ•°æ®å¯„å­˜å™¨</li>
<li>GSï¼šæ•°æ®æ®µå¯„å­˜å™¨</li>
</ul>
</li>
<li>ç¨‹åºçŠ¶æ€ä¸æ§åˆ¶å¯„å­˜å™¨<ul>
<li>EFLAGSï¼šæ ‡å¿—å¯„å­˜å™¨ï¼Œ32ä¸ªä½å…ƒçš„01æ§åˆ¶<ul>
<li>ZF(é›¶æ ‡å¿—å™¨ï¼Œè¿ç®—ç»“æœä¸º0æ—¶ç½®1)  </li>
<li>CF(è¿›ä½æ ‡å¿—ï¼Œè¿ç®—ç»“æœå‘æœ€é«˜ä½ä»¥ä¸Šè¿›ä½æ—¶ç½®1)  </li>
<li>OF(æº¢å‡ºæ ‡å¿—) </li>
<li>AF(è¾…åŠ©è¿›ä½æ ‡å¿—ï¼Œè¿ç®—ç»“æœåœ¨ç¬¬3ä½çš„æ—¶å€™ç½®1)</li>
<li>SF(ç¬¦å·æ ‡å¿—ï¼Œæœ‰ç¬¦å·æ•´å‹çš„ç¬¦å·ä½ä¸º1æ—¶ç½®1)</li>
</ul>
</li>
</ul>
</li>
<li>æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨<ul>
<li>EIPï¼šä¿å­˜CPUè¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€</li>
</ul>
</li>
</ul>
<h2 id="æ ˆå¸§"><a href="#æ ˆå¸§" class="headerlink" title="æ ˆå¸§"></a>æ ˆå¸§</h2><ul>
<li>æ ˆç‰¹ç‚¹ï¼šFILOï¼ˆfirst in last outï¼‰</li>
<li>åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™éœ€è¦å°†å‚æ•°å‹å…¥æ ˆä¸­ï¼Œæ ˆé¡¶åœ°å€å‘ç”Ÿæ”¹å˜ï¼Œè€Œä½¿ç”¨ç»“æŸåˆéœ€è¦å°†å‚æ•°å¼¹å‡ºï¼Œå°†æ ˆæ¢å¤åˆ°è¢«è°ƒç”¨å‰çš„çŠ¶æ€ï¼Œä¸ºäº†ä¾¿äºç®¡ç†ï¼Œäºæ˜¯å‡ºç°äº†æ ˆå¸§ã€‚<ul>
<li>å®˜æ–¹è§£é‡Šï¼šåˆ©ç”¨EBPå¯„å­˜å™¨è®¿é—®æ ˆå†…å±€éƒ¨å˜é‡ã€å‚æ•°ã€å‡½æ•°è¿”å›åœ°å€çš„æ‰‹æ®µã€‚</li>
<li>å…·ä½“æ“ä½œï¼šåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œå°†ESPä¸­çš„æ ˆé¡¶åœ°å€å­˜å…¥EBPä¸­ï¼Œå°†è¯¥åœ°å€ä½œä¸ºåŸºå‡†ç‚¹ã€‚ç„¶åè°ƒç”¨å‡½æ•°ï¼ŒESPå¯„å­˜å™¨æ­£å¸¸è¿›è¡Œï¼Œå…¶é—´å¯é€šè¿‡EBPå»æ§åˆ¶è®¿é—®å˜é‡å‚æ•°ç­‰ç­‰ï¼Œåœ¨è°ƒç”¨ç»“æŸåï¼Œå†å°†EBPä¸­çš„åŸºå‡†ç‚¹åœ°å€ç»™åˆ°ESPï¼Œå°†æ ˆçš„çŠ¶æ€æ¢å¤åˆ°å‡½æ•°è°ƒç”¨å‰</li>
<li>ä»£ç æµç¨‹ï¼š<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PUSH EBP          ;å‡½æ•°å¼€å§‹</span><br><span class="line">MOV  EBP,ESP      ;å°†æ ˆé¡¶åœ°å€å­˜å…¥EBPä¸­</span><br><span class="line"></span><br><span class="line">....              ;å‡½æ•°æ‰§è¡Œï¼ŒæœŸé—´EBPåœ°å€ä¸å˜</span><br><span class="line"></span><br><span class="line">MOV  ESP,EBP      ;åŸºå‡†ç‚¹åœ°å€ç»™åˆ°ESP</span><br><span class="line">POP EBP           ;æ ˆçŠ¶æ€æ¢å¤ï¼Œå¼¹å‡ºEBP</span><br><span class="line">RETN              ;å‡½æ•°ç»“æŸ</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="å‡½æ•°è°ƒç”¨çº¦å®š"><a href="#å‡½æ•°è°ƒç”¨çº¦å®š" class="headerlink" title="å‡½æ•°è°ƒç”¨çº¦å®š"></a>å‡½æ•°è°ƒç”¨çº¦å®š</h2><p>(Calling Convention)</p>
<ul>
<li>ä¸‰ç§æ–¹å¼(cdcel, stdcall, fastcall)<ul>
<li>cdcel<br>ä¸»è¦è¿ç”¨äºcè¯­è¨€ï¼Œç”±è°ƒç”¨è€…è´Ÿè´£æ¸…ç†æ ˆ<blockquote>
<p>å‡½æ•°è°ƒç”¨ç»“æŸåé€šè¿‡ç§»åŠ¨ESPï¼Œæ¢å¤åˆ°è°ƒç”¨å‰çš„æ ˆçŠ¶æ€</p>
</blockquote>
</li>
<li>stdcall<br>ä¸»è¦è¿ç”¨äºWin32 APIï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†æ ˆ<blockquote>
<p>åœ¨è¢«è°ƒç”¨å‡½æ•°çš„ç»“å°¾é€šè¿‡RETNè¯­å¥ç§»åŠ¨ESPåˆ°åŸä½ç½®</p>
</blockquote>
</li>
<li>fastcall<blockquote>
<p>ä½¿ç”¨å¯„å­˜å™¨å»ä¼ é€’å‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼Œå®ç°å¿«é€Ÿè°ƒç”¨</p>
</blockquote>
</li>
</ul>
</li>
</ul>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
  </entry>
  <entry>
    <title>è§£æ–¹ç¨‹ç”¨çš„ç‰›é©¬z3</title>
    <url>/2022/09/14/z3/</url>
    <content><![CDATA[<ul>
<li>é‰´äºæŸäº›æ–¹ç¨‹ä¸æ˜¯äººè§£çš„ï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹å·¥å…·z3â€¦.<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><blockquote>
<p>ç›´æ¥æåˆ°ç½‘ç›˜ä¸Šç”¨é“¾æ¥å§ï¼š<br>é“¾æ¥ï¼š(<a href="https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234">https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234</a>)<br>æå–ç ï¼š1234</p>
</blockquote>
<ol>
<li>ä¸‹è½½è§£å‹</li>
<li>å°†æ–‡ä»¶ä¸­binç›®å½•é…ç½®åˆ°ç³»ç»Ÿå˜é‡pathä¸­</li>
<li>æ–°å»ºPYTHONPATHç³»ç»Ÿå˜é‡ï¼Œè·¯å¾„ä¸ºbin&#x2F;pythonç›®å½•</li>
</ol>
<h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><ol>
<li>æ‰“å¼€é»‘æ¡†æ¡†</li>
</ol>
<blockquote>
<p>cmdåˆ°bin&#x2F;pythonçš„ç›®å½•</p>
</blockquote>
<p>or</p>
<blockquote>
<p>åœ¨bin&#x2F;pythonç›®å½•ä¸‹shiftå³é”®powershell</p>
</blockquote>
<ol start="2">
<li><p>è¾“å…¥python</p>
</li>
<li><p>æŠŠä»£ç è¾“è¿›å»å›è½¦å°±å®Œäº†</p>
</li>
</ol>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><ul>
<li><p>å…ˆçœ‹å®˜æ–¹ç¤ºä¾‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">x = Real(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y = Real(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(x + y &gt; 5, x &gt; 1, y &gt; 1)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç®€å•è¯´ä¸€ä¸‹</p>
</li>
</ul>
<ol>
<li>å¯¼åŒ…z3</li>
<li>a &#x3D; Real(b), aä¸ºæ–¹ç¨‹ä¸­çš„æœªçŸ¥æ•°ï¼Œbä¸ºè¾“å‡ºæ—¶å€™ç”¨æ¥è¡¨ç¤ºaçš„å˜é‡</li>
<li>Solver()ï¼Œç®€è¨€ä¹‹ï¼šè§£å†³å‡½æ•°ï¼Œæ–¹ç¨‹æ¥æ”¶å™¨</li>
<li>add()ï¼Œæ‹¬å·é‡Œå¡æ–¹ç¨‹å°±è¡Œï¼Œç”¨â€œ,â€éš”å¼€ï¼Œæˆ–è€…ä½ å¤šç”¨å‡ ä¸ªadd()ä¹Ÿè¡Œ</li>
<li>åé¢ä¿©ä¸ç”¨åŠ¨äº†ï¼Œå°±é‚£æ ·</li>
<li>å›è½¦å‡ºç»“æœ</li>
</ol>]]></content>
      <categories>
        <category>CTFâ€”â€”å·¥å…·</category>
      </categories>
  </entry>
  <entry>
    <title>IDAå¿«æ·æ“ä½œ</title>
    <url>/2022/09/08/IDA/</url>
    <content><![CDATA[<ul>
<li>å¿«æ·æ“ä½œ<!-- less -->
<HR width="100%"  color="#FF7F00"></li>
</ul>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>F5</td>
<td>åæ±‡ç¼–</td>
</tr>
<tr>
<td>å‡½æ•°åˆ—è¡¨Ctrl+F</td>
<td>æœç´¢å‡½æ•°</td>
</tr>
<tr>
<td>X</td>
<td>äº¤å‰å¼•ç”¨</td>
</tr>
<tr>
<td>G</td>
<td>è·³è½¬åˆ°æŒ‡å®šåœ°å€</td>
</tr>
<tr>
<td>Shift+F12</td>
<td>å­—ç¬¦ä¸²åˆ—è¡¨</td>
</tr>
<tr>
<td>Alt+T</td>
<td>æŒ‰æŒ‡ä»¤æŸ¥æ‰¾</td>
</tr>
<tr>
<td>N</td>
<td>é‡å‘½å(å‡½æ•°åç­‰)</td>
</tr>
<tr>
<td>Ctrl+Z</td>
<td>æ“ä½œæ’¤é”€</td>
</tr>
<tr>
<td>D</td>
<td>å°†å­—ç¬¦ä¸²ç­‰å…ƒç´ è½¬ä¸ºæ•°æ®</td>
</tr>
<tr>
<td>A</td>
<td>å°†æ•°æ®è½¬å˜ä¸ºå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>C</td>
<td>å°†æ•°æ®è½¬å˜ä¸ºæ±‡ç¼–ä»£ç </td>
</tr>
<tr>
<td>U</td>
<td>å°†å­—ç¬¦ä¸²è½¬å˜ä¸ºåŸå§‹æ•°æ®</td>
</tr>
<tr>
<td>Shift+E</td>
<td>å¯¼å‡ºæ•°æ®</td>
</tr>
<tr>
<td>Shift+F2</td>
<td>è„šæœ¬åµŒå…¥</td>
</tr>
<tr>
<td>;</td>
<td>æ·»åŠ æ³¨é‡Š(æ‰€æœ‰äº¤å‰å‚è€ƒå¤„å‡æ˜¾ç¤º)</td>
</tr>
<tr>
<td>:</td>
<td>æ·»åŠ æ³¨é‡Š(ä»…åœ¨æ­¤å¤„æ˜¾ç¤º)</td>
</tr>
<tr>
<td>Esc</td>
<td>åé€€ä¸€æ­¥</td>
</tr>
<tr>
<td>Ctrl+Enter</td>
<td>å‰è¿›ä¸€æ­¥</td>
</tr>
<tr>
<td>Alt+M</td>
<td>æ ‡è®°å½“å‰ä½ç½®</td>
</tr>
<tr>
<td>Ctrl+M</td>
<td>è·³è½¬åˆ°æ ‡è®°ä½ç½®</td>
</tr>
<tr>
<td>P</td>
<td>åˆ›å»ºå‡½æ•°</td>
</tr>
</tbody></table>]]></content>
      <categories>
        <category>CTFâ€”â€”å·¥å…·</category>
      </categories>
      <tags>
        <tag>åæ±‡ç¼–</tag>
        <tag>é€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>pycæ–‡ä»¶åç¼–</title>
    <url>/2022/09/07/Re_pyc/</url>
    <content><![CDATA[<ul>
<li>pyc-exeè¿”py<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="2022-x2F-10-x2F-25-é‡å†™"><a href="#2022-x2F-10-x2F-25-é‡å†™" class="headerlink" title="2022&#x2F;10&#x2F;25 é‡å†™"></a>2022&#x2F;10&#x2F;25 é‡å†™</h2><ul>
<li><p>åŠ ä¸€ä¸ªå†…å®¹ï¼šexeåˆ°pycçš„è½¬åŒ–</p>
<ul>
<li>å¯æ“ä½œexeçš„è¯†åˆ«ï¼ˆç”¨pythonç¼–è¯‘ç”Ÿæˆçš„exeæ–‡ä»¶ä¸€èˆ¬æ¥è®²ä¼šæ¯”è¾ƒå¤§ï¼‰</li>
<li>å…·ä½“å¤„ç†ï¼ˆåˆ©ç”¨è„šæœ¬å®Œæˆï¼‰</li>
</ul>
</li>
<li><p>pyè„šæœ¬ï¼ˆpyinstxtractorï¼‰</p>
<p>ï¼ˆ<a href="https://gitcode.net/mirrors/extremecoders-re/pyinstxtractor?utm_source=csdn_github_accelerator">mirrors &#x2F; extremecoders-re &#x2F; pyinstxtractor Â· GitCode</a>ï¼‰</p>
</li>
<li><p>ä½¿ç”¨</p>
<ul>
<li><p>å»ºè®®å®˜æ–¹æ–‡æ¡£readme.md</p>
</li>
<li><p>æ¯”è¾ƒå¸¸è§çš„æ“ä½œå°±æ˜¯å°†è¦è½¬åŒ–çš„exeç¨‹åºå¤åˆ¶åˆ°è„šæœ¬æ–‡ä»¶ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤</p>
<blockquote>
<p>python pyinstxtractor.py test.exe</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="pycæ–‡ä»¶åç¼–"><a href="#pycæ–‡ä»¶åç¼–" class="headerlink" title="pycæ–‡ä»¶åç¼–"></a>pycæ–‡ä»¶åç¼–</h3><p>pyç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶</p>
<blockquote>
<p>å…ˆçœç•¥æ— æ•°å­—ï¼Œéœ€è¦æ·±å…¥äº†è§£åº•å±‚å†è¯´</p>
</blockquote>
<h3 id="å¤„ç†"><a href="#å¤„ç†" class="headerlink" title="å¤„ç†"></a>å¤„ç†</h3><ul>
<li><p>å€Ÿç”¨å¤–éƒ¨èµ„æºï¼Œå®‰è£…uncompyle6</p>
<blockquote>
<p>pip install uncompyle</p>
</blockquote>
</li>
<li><p>ä½¿ç”¨</p>
<blockquote>
<p>uncompyle6 name.pyc &gt; name.py</p>
</blockquote>
</li>
<li><p>æˆ–è€…ç›´æ¥ç”¨ç½‘ä¸Šçš„åœ¨çº¿åç¼–è¯‘ï¼š<br>(<a href="https://tool.lu/pyc/">https://tool.lu/pyc/</a>)</p>
</li>
</ul>
<blockquote>
<p>å› ä¸ºæ¯”è¾ƒbugçš„ä¸€ä»¶äº‹æƒ…æ˜¯ï¼š<br>æˆ‘é‡åˆ°äº†æŸpycæ–‡ä»¶ç”¨uncompyle6æ— æ³•åç¼–çš„æƒ…å†µï¼Œç›®å‰æ¨æµ‹åº”è¯¥æ˜¯ç‰ˆæœ¬ä¸å¯¹çš„é—®é¢˜<br>åç»­å†ç ”ç©¶ç ”ç©¶</p>
</blockquote>]]></content>
      <categories>
        <category>CTFâ€”â€”å·¥å…·</category>
      </categories>
      <tags>
        <tag>reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Base64ç¼–ç </title>
    <url>/2022/09/06/Base64/</url>
    <content><![CDATA[<ul>
<li>ç»†çç¼–ç è¿‡ç¨‹<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h3 id="ç¼–ç è¿‡ç¨‹"><a href="#ç¼–ç è¿‡ç¨‹" class="headerlink" title="ç¼–ç è¿‡ç¨‹"></a>ç¼–ç è¿‡ç¨‹</h3><ol>
<li><p>å°†ç›®æ ‡å­—ç¬¦ä¾ç…§ASCIIç è¡¨å˜ä¸ºçº¯äºŒè¿›åˆ¶</p>
</li>
<li><p>æŒ‰æ¯6ä½ä¸€ä¸ªå•å…ƒè¿›è¡Œé‡æ–°åˆ‡å‰²ï¼Œï¼ˆä¸å¤Ÿ6ä½çš„åœ°æ–¹è¡¥0ï¼‰</p>
</li>
<li><p>å¯¹ç…§base64ç¼–ç è¡¨ï¼Œç¼–ç å‡ºæ¯ä¸ªå•å…ƒæ‰€ä»£è¡¨çš„å­—ç¬¦</p>
</li>
</ol>
<h3 id="base64ç¼–ç è¡¨"><a href="#base64ç¼–ç è¡¨" class="headerlink" title="base64ç¼–ç è¡¨"></a>base64ç¼–ç è¡¨</h3><p><img src="https://s2.loli.net/2022/09/06/QiUuEKzCvZIFNDV.jpg" alt="v2-ff0ffbecbd68704bf1ddf8f7d53095b8_r.jpg"></p>
<h3 id="egï¼š"><a href="#egï¼š" class="headerlink" title="egï¼š"></a>egï¼š</h3><ul>
<li><p>ç›®æ ‡å­—ç¬¦ï¼šdlw</p>
</li>
<li><p>ç¬¬ä¸€æ­¥ï¼šè½¬å˜ä¸ºäºŒè¿›åˆ¶ä¸²</p>
</li>
</ul>
<blockquote>
<p>01100100(d) 01101100(l) 01110111(w)</p>
</blockquote>
<ul>
<li>ç¬¬äºŒæ­¥ï¼š6ä½åˆ‡å‰²</li>
</ul>
<blockquote>
<p>011001 | 000110 | 110001 | 110111</p>
</blockquote>
<ul>
<li>ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾æ¯ä¸€å•å…ƒå¯¹åº”çš„å­—ç¬¦ï¼Œé‡æ–°ç¼–ç </li>
</ul>
<blockquote>
<p>011001(Z) | 000110(G) | 110001(x) | 110111(3)</p>
</blockquote>
<ul>
<li>å¾—åˆ°ç»“æœï¼šZGx3</li>
</ul>
<h3 id="pythonç¼–ç "><a href="#pythonç¼–ç " class="headerlink" title="pythonç¼–ç "></a>pythonç¼–ç </h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import <span class="built_in">base64</span></span><br><span class="line">s = input()</span><br><span class="line">t = base64.b64encode(s.encode())</span><br><span class="line"><span class="built_in">print</span>(t.decode())</span><br></pre></td></tr></table></figure>

<h3 id="pythonè§£ç "><a href="#pythonè§£ç " class="headerlink" title="pythonè§£ç "></a>pythonè§£ç </h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import <span class="built_in">base64</span></span><br><span class="line">s = input()</span><br><span class="line">t = base64.b64decode(s.encode())</span><br><span class="line"><span class="built_in">print</span>(t.decode())</span><br></pre></td></tr></table></figure>

<h3 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h3><ol>
<li><p>base64çš„ç‰¹å¾ä¹‹ä¸€ï¼šç»“æœä¸²é•¿åº¦ä¸€å®šä¸º4çš„å€æ•°</p>
</li>
<li><p>ä¸ºäº†è¡¥é½4å€çš„å•å…ƒï¼Œç¼–ç æ—¶å¯èƒ½ä¼šå‡ºç°æœ«å°¾nä¸ªå•å…ƒå…¨éƒ¨ä¸ºç©ºçš„æƒ…å†µï¼Œè¿™æ—¶å€™å°±ç”¨â€œ&#x3D;â€è¡¥é½ï¼Œè¿™ä¹Ÿæ˜¯è¯†åˆ«base64ç¼–ç çš„ä¸€ç§æ–¹å¼</p>
</li>
</ol>
<h4 id="æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€"><a href="#æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€" class="headerlink" title="æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€"></a>æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€</h4><ul>
<li><p>äºŒè¿›åˆ¶ï¼š01100100(d) 01101100(l)</p>
</li>
<li><p>åˆ‡å‰²ï¼š011001(Z)) | 000110(G) | 1100ï¼ˆè¡¥ä¸¤ä¸ª0ï¼‰(w) | ï¼ˆç©ºå•å…ƒï¼‰(&#x3D;)</p>
</li>
<li><p>ç»“æœï¼šZGw&#x3D;</p>
</li>
</ul>
<h3 id="æ¶‰åŠé¢˜ç›®"><a href="#æ¶‰åŠé¢˜ç›®" class="headerlink" title="æ¶‰åŠé¢˜ç›®"></a>æ¶‰åŠé¢˜ç›®</h3><ul>
<li>python-trade</li>
</ul>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>å¯†ç å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»¿å°„å¯†ç (å•è¡¨åŠ å¯†)</title>
    <url>/2022/09/06/Affine/</url>
    <content><![CDATA[<ul>
<li>ç»†çä»¿å°„</li>
<li>ä¾‹é¢˜<!-- less --></li>
</ul>
<HR width="100%"  color="#FF7F00">

<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><h3 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h3><ul>
<li>ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨åŠ å¯†å‡½æ•°å°†ä¸€ä¸ªå­—æ¯æ˜ å°„ä¸ºå¦ä¸€ä¸ªå­—æ¯</li>
</ul>
<h3 id="åŠ å¯†å‡½æ•°"><a href="#åŠ å¯†å‡½æ•°" class="headerlink" title="åŠ å¯†å‡½æ•°"></a>åŠ å¯†å‡½æ•°</h3><h4 id="E-x-x3D-ax-b-n-å…¶ä¸­"><a href="#E-x-x3D-ax-b-n-å…¶ä¸­" class="headerlink" title="E(x) &#x3D; (ax+b)%n,å…¶ä¸­"></a>E(x) &#x3D; (ax+b)%n,å…¶ä¸­</h4><ul>
<li>nä¸ºæ‰€è®¾ç½®çš„å­—æ¯ç¼–ç è¡¨çš„å¤§å°</li>
<li>a,bä¸ºè‡ªé€‰æ•°ï¼Œåªè¦æ»¡è¶³aä¸näº’è´¨å³å¯</li>
<li>xä¸ºæ˜æ–‡ç¼–ç åçš„æ•°å­—</li>
</ul>
<h3 id="è§£å¯†å‡½æ•°"><a href="#è§£å¯†å‡½æ•°" class="headerlink" title="è§£å¯†å‡½æ•°"></a>è§£å¯†å‡½æ•°</h3><h4 id="D-x-x3D-a-1-x-b-n"><a href="#D-x-x3D-a-1-x-b-n" class="headerlink" title="D(x) &#x3D; a-1(x-b)%n"></a>D(x) &#x3D; a<sup>-1</sup>(x-b)%n</h4><ul>
<li>a<sup>-1</sup>æ˜¯aåœ¨Z<sub>n</sub>ç¾¤çš„ä¹˜æ³•é€†å…ƒ</li>
</ul>
<blockquote>
<p>ä¹˜æ³•é€†å…ƒè¿™ä¸ªä¸œè¥¿ç­‰åç»­å®Œå…¨ææ‡‚äº†å†è§£é‡Šï¼Œä¸»è¦çš„ä¸€ç‚¹æ˜¯æ»¡è¶³a<sup>-1</sup>*a%n&#x3D;1</p>
</blockquote>
<h2 id="ä¾‹é¢˜-BITSCTF2017-fanfie"><a href="#ä¾‹é¢˜-BITSCTF2017-fanfie" class="headerlink" title="ä¾‹é¢˜ [BITSCTF2017]fanfie"></a>ä¾‹é¢˜ [BITSCTF2017]fanfie</h2><blockquote>
<p>Brute and get the base 32 format of flag.<br>encrypted.txt: MZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI</p>
</blockquote>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¢˜ç›®æ˜¯ä¸€å¦‚æ—¢å¾€çš„ç®€æ´<br>é¦–å…ˆé¢˜ç›®å‘Šè¯‰æˆ‘ä»¬æœ‰<font color="#f18583">base32ç¼–ç </font><br>åŒæ—¶ç”±é¢˜ç›®æ¥æºå¯çŸ¥flagæ ¼å¼ä¸º<font color="#f18583">BITSCTF{}</font></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ç„å­¦çŒœæƒ³:<br>ç¼–ç åå˜é•¿äº†ï¼Œæˆ–è®¸åˆšå¥½å’Œé¢˜ç›®ç»™çš„å¯†æ–‡ç­‰é•¿å§ï¼Œè€ƒè™‘å•è¡¨åŠ å¯†<br>Iå˜Mï¼ŒJå˜Zï¼ŒEå˜Yï¼Œå¾ˆæ˜æ˜¾æ²¡ç›´æ¥çš„æ˜ å°„è§„å¾‹ï¼Œè€ƒè™‘<a href="http://woodenmandu.cn/2022/09/06/Affine/">ä»¿å°„å¯†ç </a></p>
<p>ä¸‹ä¸€æ­¥è®¡ç®—aï¼Œb</p>
<blockquote>
<p>åˆ«å¿˜è®°è¿™æ˜¯base32ï¼ŒåŠ å¯†å‡½æ•°ä¸ºE(x) &#x3D; (ax+b)%32</p>
</blockquote>
<ul>
<li>å°ç®—ä¸€ä¸‹ï¼Œæ‹¿ä¸¤ç»„æ•°æ®ï¼š<blockquote>
<p>8(I)â€“&gt;12(M)<br>9(J)â€“&gt;25(Z)</p>
</blockquote>
</li>
<li>å‡½æ•°å·®å€¼æä¸€ä¸‹ï¼š25-12&#x3D;(9-1)a<br>a&#x3D;13ï¼Œbé¡ºç†æˆç« ç­‰äº4</li>
<li>ç„¶ågoogleæ‰¾ä¸ªæ±‚é€†å…ƒçš„ç½‘ç«™å¾—åˆ°é€†å…ƒç­‰äº5<br>å¾—åˆ°è§£å¯†å‡½æ•°D(x) &#x3D; 5(x-4)%32</li>
</ul>
<p>é€šè¿‡è§£å¯†å¾—åˆ°</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">å¯†æ–‡ï¼šMZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI</span><br><span class="line">æ˜æ–‡ï¼šIJEVIU2DKRDHWUZSKZ4VSMTUN5RDEWTNPU</span><br></pre></td></tr></table></figure>

<p>æœ€åbase32è§£ç å°±èƒ½å¾—åˆ°flag:</p>
<blockquote>
<p>BITSCTF{S2VyY2tob2Zm}</p>
</blockquote>]]></content>
      <categories>
        <category>CTFâ€”â€”â€”çŸ¥è¯†ç‚¹</category>
      </categories>
      <tags>
        <tag>å¯†ç å­¦</tag>
      </tags>
  </entry>
</search>
